import{d as H,aj as O,r as b,p as k,v as n,g as d,b as o,u as e,$ as Q,w as i,e as r,a2 as L,s as l,E as W,ac as X,t as m,J as u,af as U,ak as Z,Y as M,F as C,x as B,al as q,P as x,j as ee}from"./vendor-DTOvI-mL.js";import{i as T,_ as se,f as te,s as oe}from"./AppLayout.vue_vue_type_script_setup_true_lang-YhCYOJnL.js";import{_ as h}from"./index-D22QrCMB.js";import{_ as c}from"./Input.vue_vue_type_script_setup_true_lang-sYWCYV49.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-Bkvht4jR.js";import{_ as D,a as K}from"./CardContent.vue_vue_type_script_setup_true_lang-Bj2sOBs1.js";import{_ as N}from"./CardDescription.vue_vue_type_script_setup_true_lang-Dh4Au0Nv.js";import{_ as E}from"./CardHeader.vue_vue_type_script_setup_true_lang-Dnz_aDai.js";import{_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-DNuWsNXR.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-BMNk4ekC.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Dl-lb8Nw.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DuRk8pxL.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DLa7QEbp.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DpA8K8_j.js";const re={class:"rounded-xl p-4 space-y-6 py-6"},ae={class:"flex items-center justify-between"},ie={class:"grid gap-4 md:grid-cols-2"},le={class:"space-y-2"},ne={key:0,class:"text-sm text-destructive"},de={class:"space-y-2"},ue={key:0,class:"text-sm text-destructive"},pe={class:"space-y-2"},me={key:0,class:"text-sm text-destructive"},fe={class:"space-y-2"},_e={key:0,class:"text-sm text-destructive"},ce={class:"space-y-2"},ge={key:0,class:"text-sm text-destructive"},ve={class:"space-y-2"},xe={class:"space-y-2"},ye={class:"grid gap-4 md:grid-cols-2"},we={class:"space-y-2"},be={class:"relative"},ke={class:"flex gap-2"},he={class:"relative flex-1"},Ve={key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border bg-popover p-1 shadow-md"},Pe=["onClick"],Ue={class:"font-medium"},Ce={class:"text-xs text-muted-foreground"},Se={key:0,class:"mt-2 rounded-md border bg-muted p-3"},$e={class:"text-sm font-medium"},Le={class:"text-xs text-muted-foreground"},Me={key:1,class:"text-sm text-destructive"},Be={class:"space-y-2"},qe={class:"relative"},Te={class:"relative"},De={key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border bg-popover p-1 shadow-md"},Ke=["onClick"],Ne={class:"font-medium"},Ee={class:"text-xs text-muted-foreground"},Fe={key:0,class:"mt-2 rounded-md border bg-muted p-3"},je={class:"text-sm font-medium"},ze={class:"text-xs text-muted-foreground"},Ge={key:1,class:"text-sm text-destructive"},Je={class:"space-y-2"},Re={class:"flex gap-4"},Ae={class:"flex items-center space-x-2"},Ie={class:"flex items-center space-x-2"},Ye={key:0,class:"text-sm text-destructive"},He={key:0,class:"rounded-lg border-2 border-dashed border-primary/20 bg-primary/5 p-4"},Oe={class:"flex justify-end gap-4"},ps=H({__name:"Create",props:{customers:{},suggestedPosition:{}},setup(j){const _=j,t=O({name:"",email:"",phone:"",password:"",password_confirmation:"",sponsor_id:_.suggestedPosition?.sponsor_id||null,upline_id:_.suggestedPosition?.upline_id||null,preferred_position:_.suggestedPosition?.position||"left",registration_amount:1e5,description:""}),g=b(""),v=b(""),y=b(!1),w=b(!1),V=k(()=>_.customers.find(p=>p.id===t.sponsor_id)),P=k(()=>_.customers.find(p=>p.id===t.upline_id)),S=k(()=>{if(!g.value)return _.customers;const p=g.value.toLowerCase();return _.customers.filter(s=>s.name.toLowerCase().includes(p)||s.ewallet_id.toLowerCase().includes(p))}),$=k(()=>{if(!v.value)return _.customers;const p=v.value.toLowerCase();return _.customers.filter(s=>s.name.toLowerCase().includes(p)||s.ewallet_id.toLowerCase().includes(p))}),z=p=>{t.sponsor_id=p.id,y.value=!1,g.value=""},G=p=>{t.upline_id=p.id,w.value=!1,v.value=""},J=()=>{typeof window<"u"&&window.setTimeout(()=>{y.value=!1},200)},R=()=>{typeof window<"u"&&window.setTimeout(()=>{w.value=!1},200)},A=()=>{if(!t.sponsor_id){x.error("Pilih sponsor terlebih dahulu");return}ee.get(te.url(),{sponsor_id:t.sponsor_id},{preserveState:!0,onSuccess:p=>{const s=p.props.suggestedPosition;s&&(t.upline_id=s.upline_id,t.preferred_position=s.position,x.success("Posisi disarankan berhasil dimuat"))},onError:()=>{x.error("Gagal mendapatkan saran posisi")}})},I=()=>{t.post(oe.url(),{preserveScroll:!0,onSuccess:()=>{x.success("Pelanggan berhasil didaftarkan")},onError:()=>{x.error("Gagal mendaftarkan pelanggan")}})};return(p,s)=>(d(),n(C,null,[o(e(Q),{title:"Tambah Pelanggan"}),o(se,null,{default:i(()=>[r("div",re,[r("div",ae,[s[14]||(s[14]=r("div",null,[r("h1",{class:"text-3xl font-bold"},"Tambah Pelanggan"),r("p",{class:"mt-2 text-muted-foreground"}," Daftarkan pelanggan baru ke dalam sistem MLM ")],-1)),o(e(L),{href:e(T).url()},{default:i(()=>[o(e(h),{variant:"outline"},{default:i(()=>[o(e(W),{class:"mr-2 h-4 w-4"}),s[13]||(s[13]=l(" Kembali ",-1))]),_:1})]),_:1},8,["href"])]),r("form",{onSubmit:X(I,["prevent"]),class:"space-y-6"},[o(e(D),null,{default:i(()=>[o(e(E),null,{default:i(()=>[o(e(F),null,{default:i(()=>[...s[15]||(s[15]=[l("Informasi Pribadi",-1)])]),_:1}),o(e(N),null,{default:i(()=>[...s[16]||(s[16]=[l(" Data pribadi pelanggan yang akan didaftarkan ",-1)])]),_:1})]),_:1}),o(e(K),{class:"space-y-4"},{default:i(()=>[r("div",ie,[r("div",le,[o(e(f),{for:"name"},{default:i(()=>[...s[17]||(s[17]=[l("Nama Lengkap *",-1)])]),_:1}),o(e(c),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":s[0]||(s[0]=a=>e(t).name=a),placeholder:"Masukkan nama lengkap",required:""},null,8,["modelValue"]),e(t).errors.name?(d(),n("p",ne,u(e(t).errors.name),1)):m("",!0)]),r("div",de,[o(e(f),{for:"email"},{default:i(()=>[...s[18]||(s[18]=[l("Email *",-1)])]),_:1}),o(e(c),{id:"email",modelValue:e(t).email,"onUpdate:modelValue":s[1]||(s[1]=a=>e(t).email=a),type:"email",placeholder:"nama@email.com",required:""},null,8,["modelValue"]),e(t).errors.email?(d(),n("p",ue,u(e(t).errors.email),1)):m("",!0)]),r("div",pe,[o(e(f),{for:"phone"},{default:i(()=>[...s[19]||(s[19]=[l("No. Telepon",-1)])]),_:1}),o(e(c),{id:"phone",modelValue:e(t).phone,"onUpdate:modelValue":s[2]||(s[2]=a=>e(t).phone=a),placeholder:"08xxxxxxxxxx"},null,8,["modelValue"]),e(t).errors.phone?(d(),n("p",me,u(e(t).errors.phone),1)):m("",!0)]),r("div",fe,[o(e(f),{for:"registration_amount"},{default:i(()=>[...s[20]||(s[20]=[l("Biaya Registrasi *",-1)])]),_:1}),o(e(c),{id:"registration_amount",modelValue:e(t).registration_amount,"onUpdate:modelValue":s[3]||(s[3]=a=>e(t).registration_amount=a),modelModifiers:{number:!0},type:"number",min:"0",step:"1000",required:""},null,8,["modelValue"]),e(t).errors.registration_amount?(d(),n("p",_e,u(e(t).errors.registration_amount),1)):m("",!0)]),r("div",ce,[o(e(f),{for:"password"},{default:i(()=>[...s[21]||(s[21]=[l("Password *",-1)])]),_:1}),o(e(c),{id:"password",modelValue:e(t).password,"onUpdate:modelValue":s[4]||(s[4]=a=>e(t).password=a),type:"password",placeholder:"Minimal 8 karakter",required:""},null,8,["modelValue"]),e(t).errors.password?(d(),n("p",ge,u(e(t).errors.password),1)):m("",!0)]),r("div",ve,[o(e(f),{for:"password_confirmation"},{default:i(()=>[...s[22]||(s[22]=[l("Konfirmasi Password *",-1)])]),_:1}),o(e(c),{id:"password_confirmation",modelValue:e(t).password_confirmation,"onUpdate:modelValue":s[5]||(s[5]=a=>e(t).password_confirmation=a),type:"password",placeholder:"Ulangi password",required:""},null,8,["modelValue"])])]),r("div",xe,[o(e(f),{for:"description"},{default:i(()=>[...s[23]||(s[23]=[l("Keterangan",-1)])]),_:1}),U(r("textarea",{id:"description","onUpdate:modelValue":s[6]||(s[6]=a=>e(t).description=a),placeholder:"Keterangan tambahan (opsional)",rows:"3",class:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm"},null,512),[[Z,e(t).description]])])]),_:1})]),_:1}),o(e(D),null,{default:i(()=>[o(e(E),null,{default:i(()=>[o(e(F),null,{default:i(()=>[...s[24]||(s[24]=[l("Struktur Jaringan MLM",-1)])]),_:1}),o(e(N),null,{default:i(()=>[...s[25]||(s[25]=[l(" Pilih sponsor dan posisi dalam binary tree ",-1)])]),_:1})]),_:1}),o(e(K),{class:"space-y-4"},{default:i(()=>[r("div",ye,[r("div",we,[o(e(f),{for:"sponsor"},{default:i(()=>[...s[26]||(s[26]=[l("Sponsor *",-1)])]),_:1}),r("div",be,[r("div",ke,[r("div",he,[o(e(c),{modelValue:g.value,"onUpdate:modelValue":s[7]||(s[7]=a=>g.value=a),onFocus:s[8]||(s[8]=a=>y.value=!0),onBlur:J,placeholder:"Cari sponsor..."},null,8,["modelValue"]),o(e(M),{class:"absolute right-3 top-3 h-4 w-4 text-muted-foreground"})]),o(e(h),{type:"button",variant:"outline",onClick:A,disabled:!e(t).sponsor_id},{default:i(()=>[...s[27]||(s[27]=[l(" Sarankan Posisi ",-1)])]),_:1},8,["disabled"])]),y.value&&S.value.length>0?(d(),n("div",Ve,[(d(!0),n(C,null,B(S.value,a=>(d(),n("button",{key:a.id,type:"button",onClick:Y=>z(a),class:"w-full rounded px-3 py-2 text-left text-sm hover:bg-accent"},[r("div",Ue,u(a.name),1),r("div",Ce,u(a.ewallet_id),1)],8,Pe))),128))])):m("",!0)]),V.value?(d(),n("div",Se,[r("p",$e,u(V.value.name),1),r("p",Le,u(V.value.ewallet_id),1)])):m("",!0),e(t).errors.sponsor_id?(d(),n("p",Me,u(e(t).errors.sponsor_id),1)):m("",!0)]),r("div",Be,[o(e(f),{for:"upline"},{default:i(()=>[...s[28]||(s[28]=[l("Upline *",-1)])]),_:1}),r("div",qe,[r("div",Te,[o(e(c),{modelValue:v.value,"onUpdate:modelValue":s[9]||(s[9]=a=>v.value=a),onFocus:s[10]||(s[10]=a=>w.value=!0),onBlur:R,placeholder:"Cari upline..."},null,8,["modelValue"]),o(e(M),{class:"absolute right-3 top-3 h-4 w-4 text-muted-foreground"})]),w.value&&$.value.length>0?(d(),n("div",De,[(d(!0),n(C,null,B($.value,a=>(d(),n("button",{key:a.id,type:"button",onClick:Y=>G(a),class:"w-full rounded px-3 py-2 text-left text-sm hover:bg-accent"},[r("div",Ne,u(a.name),1),r("div",Ee,u(a.ewallet_id),1)],8,Ke))),128))])):m("",!0)]),P.value?(d(),n("div",Fe,[r("p",je,u(P.value.name),1),r("p",ze,u(P.value.ewallet_id),1)])):m("",!0),e(t).errors.upline_id?(d(),n("p",Ge,u(e(t).errors.upline_id),1)):m("",!0)])]),r("div",Je,[o(e(f),null,{default:i(()=>[...s[29]||(s[29]=[l("Posisi Pilihan *",-1)])]),_:1}),r("div",Re,[r("div",Ae,[U(r("input",{type:"radio",value:"left",id:"left","onUpdate:modelValue":s[11]||(s[11]=a=>e(t).preferred_position=a),class:"h-4 w-4 border-gray-300 text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2"},null,512),[[q,e(t).preferred_position]]),o(e(f),{for:"left",class:"cursor-pointer font-normal"},{default:i(()=>[...s[30]||(s[30]=[l(" Kiri ",-1)])]),_:1})]),r("div",Ie,[U(r("input",{type:"radio",value:"right",id:"right","onUpdate:modelValue":s[12]||(s[12]=a=>e(t).preferred_position=a),class:"h-4 w-4 border-gray-300 text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2"},null,512),[[q,e(t).preferred_position]]),o(e(f),{for:"right",class:"cursor-pointer font-normal"},{default:i(()=>[...s[31]||(s[31]=[l(" Kanan ",-1)])]),_:1})])]),e(t).errors.preferred_position?(d(),n("p",Ye,u(e(t).errors.preferred_position),1)):m("",!0)]),_.suggestedPosition?(d(),n("div",He,[...s[32]||(s[32]=[r("p",{class:"text-sm font-medium text-primary"}," ðŸ’¡ Posisi yang disarankan telah dimuat ",-1),r("p",{class:"mt-1 text-xs text-muted-foreground"}," Upline dan posisi telah diatur sesuai ketersediaan dalam binary tree ",-1)])])):m("",!0)]),_:1})]),_:1}),r("div",Oe,[o(e(L),{href:e(T).url()},{default:i(()=>[o(e(h),{type:"button",variant:"outline"},{default:i(()=>[...s[33]||(s[33]=[l(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),o(e(h),{type:"submit",disabled:e(t).processing},{default:i(()=>[l(u(e(t).processing?"Menyimpan...":"Simpan Pelanggan"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{ps as default};
