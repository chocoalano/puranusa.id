import{n as C,_ as Q,p as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-BLQAiOgB.js";import{_ as X}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-Cr5U6fdB.js";import{_ as Y}from"./Pagination.vue_vue_type_script_setup_true_lang-BEOQ6vqn.js";import{a as S,_ as R}from"./CardContent.vue_vue_type_script_setup_true_lang-DMT_NDq0.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-CGqIWGeD.js";import{_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-DLaLEZPb.js";import{d as H,v as b,g as o,b as t,w as a,u as e,s as f,cx as ee,e as u,K as k,cy as L,at as te,r as y,q as se,E as T,j as N,c as g,a0 as ae,t as q,Z as re,a9 as le,F as w,x as $,y as z,n as i,D as ne,an as oe,aF as ue,A as de,B as ie}from"./vendor-BgSYH69o.js";import{_ as ce}from"./index-N1u60vhI.js";import{_ as M,v as P}from"./index-C6h2rSEx.js";import{_ as fe,a as me,b as pe}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-C9WGGbb6.js";import{_ as ge}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-RzxLYeQt.js";import{_ as _e}from"./Input.vue_vue_type_script_setup_true_lang-CucwjuSa.js";import{_ as ve,a as xe,b as ye,c as be,d as V}from"./SelectValue.vue_vue_type_script_setup_true_lang-CM9Iafca.js";import{_ as we,a as $e,b as j,c as he,d as Ce,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-Cbaht4ar.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-DU4k6tzW.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BasOtxZI.js";import"./index-DqFeuJ-n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CKeFYOA5.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-sGxRETQ-.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-C5KN6rKY.js";const Ve={class:"grid gap-4 md:grid-cols-3"},ke={class:"text-2xl font-bold"},Se={class:"text-2xl font-bold"},Re={class:"text-2xl font-bold"},De=H({__name:"RefundStatistics",props:{statistics:{}},setup(n){return(_,d)=>(o(),b("div",Ve,[t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[0]||(d[0]=[f("Pending",-1)])]),_:1}),t(e(ee),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:a(()=>[u("div",ke,k(n.statistics.total_pending),1),d[1]||(d[1]=u("p",{class:"text-xs text-muted-foreground"},"Menunggu proses",-1))]),_:1})]),_:1}),t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[2]||(d[2]=[f("Diproses",-1)])]),_:1}),t(e(L),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:a(()=>[u("div",Se,k(n.statistics.total_processing),1),d[3]||(d[3]=u("p",{class:"text-xs text-muted-foreground"},"Sedang diproses",-1))]),_:1})]),_:1}),t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[4]||(d[4]=[f("Selesai",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:a(()=>[u("div",Re,k(n.statistics.total_completed),1),d[5]||(d[5]=u("p",{class:"text-xs text-muted-foreground"},"Refund selesai",-1))]),_:1})]),_:1})]))}}),Fe={class:"rounded-xl p-4 space-y-6 py-6"},Me={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Pe={class:"flex flex-1 gap-4"},je={class:"relative flex-1 max-w-sm"},Ie={class:"rounded-md border"},st=H({__name:"Index",props:{refunds:{},statistics:{},filters:{}},setup(n){const _=n,d=[{title:"Refund",href:C.url()}],x=y(_.filters.search||""),m=y(_.filters.status||"all"),v=y([{id:_.filters.sort_by||"created_at",desc:_.filters.sort_order==="desc"}]),I=y([]),K=y({}),p=y({open:!1,refund:null}),J=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),O=s=>({pending:"secondary",processing:"outline",completed:"default"})[s]||"secondary",Z=s=>{p.value={open:!0,refund:s}},G=()=>{if(!p.value.refund)return;ne({}).post(W.url(p.value.refund.id),{preserveScroll:!0,onSuccess:()=>{p.value={open:!1,refund:null}}})},A=[{id:"index",header:()=>i("div",{class:"w-12"},"No"),cell:({row:s})=>{const r=s.index+1+(_.refunds.current_page-1)*_.refunds.per_page;return i("div",{class:"font-medium"},r)}},{accessorKey:"order.order_no",header:({column:s})=>i(M,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Order",i(oe,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>{const r=s.original.order;return i("div",[i("div",{class:"font-medium"},r.order_no),i("div",{class:"text-xs text-muted-foreground"},r.customer?.name||"Unknown")])}},{accessorKey:"amount",header:()=>"Jumlah",cell:({row:s})=>i("div",{class:"font-medium"},U(s.getValue("amount")))},{accessorKey:"reason",header:()=>"Alasan",cell:({row:s})=>i("div",{class:"max-w-xs truncate"},s.getValue("reason"))},{accessorKey:"status",header:()=>"Status",cell:({row:s})=>{const r=s.getValue("status");return i(ce,{variant:O(r)},()=>r)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:s})=>J(s.getValue("created_at"))},{id:"actions",header:()=>i("div",{class:"text-right"},"Actions"),cell:({row:s})=>{const r=s.original;return r.status==="completed"?null:i("div",{class:"flex justify-end gap-2"},[i(M,{variant:"default",size:"sm",onClick:()=>Z(r)},()=>[i(L,{class:"mr-2 h-4 w-4"}),"Proses"])])}}],h=se({get data(){return _.refunds.data},columns:A,getCoreRowModel:ie(),getSortedRowModel:de(),getFilteredRowModel:ue(),onSortingChange:s=>P(s,v),onColumnFiltersChange:s=>P(s,I),onColumnVisibilityChange:s=>P(s,K),state:{get sorting(){return v.value},get columnFilters(){return I.value},get columnVisibility(){return K.value}},manualSorting:!0});T(v,s=>{s.length>0&&N.get(C.url(),{search:x.value||void 0,status:m.value!=="all"?m.value:void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let B;return T([x,m],()=>{clearTimeout(B),B=setTimeout(()=>{N.get(C.url(),{search:x.value||void 0,status:m.value!=="all"?m.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,r)=>(o(),g(Q,{breadcrumbs:d},{default:a(()=>[t(e(ae),{title:"Refund"}),u("div",Fe,[r[9]||(r[9]=u("div",{class:"flex items-center justify-between"},[u("div",null,[u("h1",{class:"text-3xl font-bold tracking-tight"},"Refund"),u("p",{class:"text-muted-foreground"},"Kelola permintaan pengembalian dana")])],-1)),t(De,{statistics:n.statistics},null,8,["statistics"]),u("div",Me,[u("div",Pe,[u("div",je,[t(e(re),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(_e),{modelValue:x.value,"onUpdate:modelValue":r[0]||(r[0]=l=>x.value=l),placeholder:"Cari order atau customer...",class:"pl-9"},null,8,["modelValue"])]),t(e(ve),{modelValue:m.value,"onUpdate:modelValue":r[1]||(r[1]=l=>m.value=l)},{default:a(()=>[t(e(xe),{class:"w-[180px]"},{default:a(()=>[t(e(ye),{placeholder:"Semua Status"})]),_:1}),t(e(be),null,{default:a(()=>[t(e(V),{value:"all"},{default:a(()=>[...r[3]||(r[3]=[f("Semua Status",-1)])]),_:1}),t(e(V),{value:"pending"},{default:a(()=>[...r[4]||(r[4]=[f("Pending",-1)])]),_:1}),t(e(V),{value:"processing"},{default:a(()=>[...r[5]||(r[5]=[f("Processing",-1)])]),_:1}),t(e(V),{value:"completed"},{default:a(()=>[...r[6]||(r[6]=[f("Completed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(fe),null,{default:a(()=>[t(e(me),{"as-child":""},{default:a(()=>[t(e(M),{variant:"outline",class:"ml-auto"},{default:a(()=>[r[7]||(r[7]=f(" Kolom ",-1)),t(e(le),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(pe),{align:"end"},{default:a(()=>[(o(!0),b(w,null,$(e(h).getAllColumns().filter(l=>l.getCanHide()),l=>(o(),g(e(ge),{key:l.id,class:"capitalize","model-value":l.getIsVisible(),"onUpdate:modelValue":c=>{l.toggleVisibility(!!c)}},{default:a(()=>[f(k(l.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),u("div",Ie,[t(e(we),null,{default:a(()=>[t(e($e),null,{default:a(()=>[(o(!0),b(w,null,$(e(h).getHeaderGroups(),l=>(o(),g(e(j),{key:l.id},{default:a(()=>[(o(!0),b(w,null,$(l.headers,c=>(o(),g(e(he),{key:c.id},{default:a(()=>[c.isPlaceholder?q("",!0):(o(),g(e(z),{key:0,render:c.column.columnDef.header,props:c.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(Ce),null,{default:a(()=>[e(h).getRowModel().rows?.length?(o(!0),b(w,{key:0},$(e(h).getRowModel().rows,l=>(o(),g(e(j),{key:l.id},{default:a(()=>[(o(!0),b(w,null,$(l.getVisibleCells(),c=>(o(),g(e(E),{key:c.id},{default:a(()=>[t(e(z),{render:c.column.columnDef.cell,props:c.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(o(),g(e(j),{key:1},{default:a(()=>[t(e(E),{colspan:A.length,class:"h-24 text-center"},{default:a(()=>[...r[8]||(r[8]=[f(" Tidak ada data refund. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),n.refunds.last_page>1?(o(),g(Y,{key:0,data:{current_page:n.refunds.current_page,last_page:n.refunds.last_page,per_page:n.refunds.per_page,from:(n.refunds.current_page-1)*n.refunds.per_page+1,to:Math.min(n.refunds.current_page*n.refunds.per_page,n.refunds.total),total:n.refunds.total},url:e(C).url(),filters:{search:x.value||void 0,status:m.value!=="all"?m.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):q("",!0)]),t(X,{open:p.value.open,"onUpdate:open":r[2]||(r[2]=l=>p.value.open=l),title:"Proses Refund?",description:`Apakah Anda yakin ingin memproses refund untuk order ${p.value.refund?.order.order_no} sebesar ${p.value.refund?U(p.value.refund.amount):""}?`,"confirm-text":"Proses","cancel-text":"Batal",onConfirm:G},null,8,["open","description"])]),_:1}))}});export{st as default};
