import{ad as C,_ as ce,ae as fe,af as pe,ag as ge}from"./AppLayout.vue_vue_type_script_setup_true_lang-BbJISVUI.js";import{_ as T}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-BJiLAzyM.js";import{_ as _e}from"./Pagination.vue_vue_type_script_setup_true_lang-DKF3iH7r.js";import{_ as ve}from"./index-gctV3Ayh.js";import{_ as D,v as V}from"./index-B7p2qoN8.js";import{_ as N,a as L}from"./CardContent.vue_vue_type_script_setup_true_lang-pGOtvMG5.js";import{_ as E}from"./CardHeader.vue_vue_type_script_setup_true_lang-BW0MQQHd.js";import{_ as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-DQhrnhF9.js";import{_ as O}from"./Checkbox.vue_vue_type_script_setup_true_lang-waq3CXyO.js";import{_ as be,a as xe,b as we,d as ye,e as z,c as G}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DKSq9Cld.js";import{d as he,r as m,d0 as Re,p as J,q as Se,E as W,j as B,v as b,g as i,b as t,w as l,u as s,e as o,ai as ke,t as A,s as u,F as x,am as X,z as $e,a0 as Ce,ar as De,Y as Ve,at as Be,K as S,d7 as Fe,c as g,Z as Ie,x as F,y as Y,n as r,D as Z,cy as Te,aL as Ae,an as Me,aF as Ue,A as Pe,B as je}from"./vendor-CVW9Nval.js";import{_ as Ke}from"./Input.vue_vue_type_script_setup_true_lang-Dtyom-PX.js";import{_ as He,a as Ne,b as Le,c as Ee,d as M}from"./SelectValue.vue_vue_type_script_setup_true_lang-Rp4It03a.js";import{_ as qe,a as Oe,b as U,c as ze,d as Ge,e as Q}from"./TableHeader.vue_vue_type_script_setup_true_lang-BqOLyMdL.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-DenOdfSF.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BvNVfb1D.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BE6efEuL.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-1rpGkrO5.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-B6g-EPwh.js";const Je={class:"flex h-full flex-1 flex-col gap-6 p-6"},We={class:"flex items-center justify-between"},Xe={class:"text-3xl font-bold tracking-tight flex items-center gap-2"},Ye={class:"grid gap-4 md:grid-cols-4"},Ze={class:"text-2xl font-bold"},Qe={class:"text-xs text-muted-foreground"},es={class:"text-2xl font-bold text-green-600"},ss={class:"text-xs text-muted-foreground"},ts={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},as={class:"flex flex-1 items-center gap-4"},ls={class:"relative flex-1 md:max-w-sm"},ns={class:"rounded-md border"},$s=he({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(_){const c=_,ee=[{title:"Bonus Reward",href:C.url()}],w=m(c.filters.search||""),p=m(c.filters.status?.toString()||"all"),y=m([{id:c.filters.sort_by,desc:c.filters.sort_order==="desc"}]),P=m([]),j=m({}),h=m({}),[se,te]=Re(),v=m({open:!1,bonus:null}),f=m({open:!1,bonus:null}),k=m({open:!1}),ae=J(()=>Object.keys(h.value).map(e=>c.bonuses.data[parseInt(e)]).filter(Boolean)),R=J(()=>ae.value.filter(e=>e.status===0)),$=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),le=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=e=>{v.value={open:!0,bonus:e}},oe=()=>{v.value.bonus&&B.delete(fe.url(v.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{v.value={open:!1,bonus:null}}})},re=e=>{f.value={open:!0,bonus:e}},ie=()=>{if(!f.value.bonus)return;Z({}).post(pe.url(f.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{f.value={open:!1,bonus:null},h.value={}}})},ue=()=>{R.value.length&&(k.value.open=!0)},de=()=>{const e=R.value.map(n=>n.id);Z({ids:e}).post(ge.url(),{preserveScroll:!0,onSuccess:()=>{h.value={},k.value.open=!1}})},K=[{id:"select",header:({table:e})=>r(O,{modelValue:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":a=>e.toggleAllPageRowsSelected(!!a),ariaLabel:"Select all"}),cell:({row:e})=>r(O,{modelValue:e.getIsSelected(),"onUpdate:modelValue":a=>e.toggleSelected(!!a),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>r("div",{class:"w-12"},"No"),cell:({row:e})=>r("div",{class:"font-medium"},e.index+1+(c.bonuses.current_page-1)*c.bonuses.per_page)},{accessorKey:"member_name",header:()=>"Member",cell:({row:e})=>r("div",[r("div",{class:"font-medium"},e.original.member_name),r("div",{class:"text-xs text-muted-foreground"},e.original.member_ewallet_id)])},{accessorKey:"reward_type",header:()=>"Tipe Reward",cell:({row:e})=>r("div",{class:"text-sm"},e.original.reward_type||"-")},{accessorKey:"amount",header:()=>r("div",{class:"text-right"},"Jumlah"),cell:({row:e})=>r("div",{class:"text-right font-medium"},$(e.original.amount))},{accessorKey:"status",header:()=>"Status",cell:({row:e})=>r(ve,{variant:e.original.status===1?"default":"secondary",class:"gap-1"},()=>[r(e.original.status===1?Te:Ae,{class:"h-3 w-3"}),e.original.status_text])},{accessorKey:"created_at",header:({column:e})=>r(D,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",r(Me,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>le(e.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:e})=>r(te,{bonus:e.original,onRelease:()=>re(e.original),onDelete:()=>ne(e.original)})}],I=Se({get data(){return c.bonuses.data},columns:K,getCoreRowModel:je(),getSortedRowModel:Pe(),getFilteredRowModel:Ue(),onSortingChange:e=>V(e,y),onColumnFiltersChange:e=>V(e,P),onColumnVisibilityChange:e=>V(e,j),onRowSelectionChange:e=>V(e,h),state:{get sorting(){return y.value},get columnFilters(){return P.value},get columnVisibility(){return j.value},get rowSelection(){return h.value}},manualSorting:!0,enableRowSelection:!0});W(y,e=>{e.length>0&&B.get(C.url(),{search:w.value||void 0,status:p.value!=="all"?parseInt(p.value):void 0,sort_by:e[0].id,sort_order:e[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let H;return W([w,p],()=>{clearTimeout(H),H=setTimeout(()=>{B.get(C.url(),{search:w.value||void 0,status:p.value!=="all"?parseInt(p.value):void 0,sort_by:y.value[0]?.id||"created_at",sort_order:y.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(e,a)=>(i(),b(x,null,[t(s(se),null,{default:l(({bonus:n,onRelease:d,onDelete:me})=>[t(s(be),null,{default:l(()=>[t(s(xe),{"as-child":""},{default:l(()=>[t(s(D),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[a[6]||(a[6]=o("span",{class:"sr-only"},"Open menu",-1)),t(s(ke),{class:"h-4 w-4"})]),_:1})]),_:1}),t(s(we),{align:"end"},{default:l(()=>[t(s(ye),null,{default:l(()=>[...a[7]||(a[7]=[u("Actions",-1)])]),_:1}),n.status===0?(i(),b(x,{key:0},[t(s(z)),t(s(G),{onClick:d},{default:l(()=>[t(s(X),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=u(" Release Bonus ",-1))]),_:1},8,["onClick"])],64)):A("",!0),t(s(z)),t(s(G),{class:"text-destructive",onClick:me},{default:l(()=>[t(s($e),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=u(" Hapus ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1}),t(ce,{breadcrumbs:ee},{default:l(()=>[t(s(Ce),{title:"Bonus Reward"}),o("div",Je,[o("div",We,[o("div",null,[o("h1",Xe,[t(s(De),{class:"h-8 w-8"}),a[10]||(a[10]=u(" Bonus Reward ",-1))]),a[11]||(a[11]=o("p",{class:"text-muted-foreground"},"Kelola bonus reward member",-1))]),t(s(D),{onClick:a[0]||(a[0]=n=>s(B).visit("/bonus/reward/create"))},{default:l(()=>[t(s(Ve),{class:"mr-2 h-4 w-4"}),a[12]||(a[12]=u(" Tambah Bonus ",-1))]),_:1})]),o("div",Ye,[t(s(N),null,{default:l(()=>[t(s(E),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(s(q),{class:"text-sm font-medium"},{default:l(()=>[...a[13]||(a[13]=[u("Total Pending",-1)])]),_:1}),t(s(Be),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(s(L),null,{default:l(()=>[o("div",Ze,S($(_.statistics.total_pending)),1),o("p",Qe,S(_.statistics.count_pending)+" transaksi",1)]),_:1})]),_:1}),t(s(N),null,{default:l(()=>[t(s(E),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(s(q),{class:"text-sm font-medium"},{default:l(()=>[...a[14]||(a[14]=[u("Total Released",-1)])]),_:1}),t(s(Fe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(s(L),null,{default:l(()=>[o("div",es,S($(_.statistics.total_released)),1),o("p",ss,S(_.statistics.count_released)+" transaksi",1)]),_:1})]),_:1})]),o("div",ts,[o("div",as,[o("div",ls,[t(s(Ie),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(s(Ke),{modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=n=>w.value=n),placeholder:"Cari member atau tipe reward...",class:"pl-9"},null,8,["modelValue"])]),t(s(He),{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=n=>p.value=n)},{default:l(()=>[t(s(Ne),{class:"w-40"},{default:l(()=>[t(s(Le),{placeholder:"Semua Status"})]),_:1}),t(s(Ee),null,{default:l(()=>[t(s(M),{value:"all"},{default:l(()=>[...a[15]||(a[15]=[u("Semua Status",-1)])]),_:1}),t(s(M),{value:"0"},{default:l(()=>[...a[16]||(a[16]=[u("Pending",-1)])]),_:1}),t(s(M),{value:"1"},{default:l(()=>[...a[17]||(a[17]=[u("Released",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),R.value.length?(i(),g(s(D),{key:0,variant:"outline",onClick:ue},{default:l(()=>[t(s(X),{class:"mr-2 h-4 w-4"}),u(" Release "+S(R.value.length)+" Bonus ",1)]),_:1})):A("",!0)]),o("div",ns,[t(s(qe),null,{default:l(()=>[t(s(Oe),null,{default:l(()=>[(i(!0),b(x,null,F(s(I).getHeaderGroups(),n=>(i(),g(s(U),{key:n.id},{default:l(()=>[(i(!0),b(x,null,F(n.headers,d=>(i(),g(s(ze),{key:d.id},{default:l(()=>[d.isPlaceholder?A("",!0):(i(),g(s(Y),{key:0,render:d.column.columnDef.header,props:d.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(s(Ge),null,{default:l(()=>[s(I).getRowModel().rows?.length?(i(!0),b(x,{key:0},F(s(I).getRowModel().rows,n=>(i(),g(s(U),{key:n.id,"data-state":n.getIsSelected()&&"selected"},{default:l(()=>[(i(!0),b(x,null,F(n.getVisibleCells(),d=>(i(),g(s(Q),{key:d.id},{default:l(()=>[t(s(Y),{render:d.column.columnDef.cell,props:d.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(i(),g(s(U),{key:1},{default:l(()=>[t(s(Q),{colspan:K.length,class:"h-24 text-center"},{default:l(()=>[...a[18]||(a[18]=[u("Tidak ada data.",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),t(_e,{data:_.bonuses,url:s(C).url()},null,8,["data","url"])]),t(T,{open:v.value.open,title:"Hapus Bonus",description:"Apakah Anda yakin ingin menghapus bonus ini?","confirm-text":"Hapus","onUpdate:open":a[3]||(a[3]=n=>v.value.open=n),onConfirm:oe},null,8,["open"]),t(T,{open:f.value.open,title:"Release Bonus",description:`Apakah Anda yakin ingin merilis bonus sebesar ${f.value.bonus?$(f.value.bonus.amount):""} ke member?`,"confirm-text":"Release","onUpdate:open":a[4]||(a[4]=n=>f.value.open=n),onConfirm:ie},null,8,["open","description"]),t(T,{open:k.value.open,title:"Mass Release Bonus",description:`Apakah Anda yakin ingin merilis ${R.value.length} bonus yang dipilih?`,"confirm-text":"Release All","onUpdate:open":a[5]||(a[5]=n=>k.value.open=n),onConfirm:de},null,8,["open","description"])]),_:1})],64))}});export{$s as default};
