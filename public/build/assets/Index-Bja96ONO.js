import{_ as ee,L as te,M as ae}from"./AppLayout.vue_vue_type_script_setup_true_lang-Hu_mZ1eB.js";import{d as X,v as y,g as u,b as s,u as a,w as l,s as c,aw as se,e as d,K as C,as as le,aR as re,aA as ne,r as h,q as oe,E as U,j as P,a0 as ie,c as v,t as W,Z as de,a9 as ue,F as b,x as k,y as z,n as r,D as L,an as q,bz as ce,X as me,aL as fe,A as ge,B as pe}from"./vendor-flWeloHs.js";import{_ as E}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-Cl2-SULB.js";import{_ as we}from"./Pagination.vue_vue_type_script_setup_true_lang-D5lnraLN.js";import{_ as j,a as D}from"./CardContent.vue_vue_type_script_setup_true_lang-DFr8PgO7.js";import{_ as F}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cgov_qDz.js";import{_ as R}from"./CardTitle.vue_vue_type_script_setup_true_lang-BdUxjhrU.js";import{f as ve}from"./currency-DfrMaoZy.js";import{_ as _e}from"./index-BonpZqDt.js";import{_ as $,v as T}from"./index-D9Hie8NE.js";import{_ as xe,a as he,b as ye}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BLeUwnH4.js";import{_ as be}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-DlsQO5tE.js";import{_ as ke}from"./Input.vue_vue_type_script_setup_true_lang-BI8FpPnw.js";import{_ as $e,a as Ce,b as Se,c as Ve,d as K}from"./SelectValue.vue_vue_type_script_setup_true_lang-CnNjP2es.js";import{_ as je,a as De,b as A,c as Fe,d as Re,e as H}from"./TableHeader.vue_vue_type_script_setup_true_lang-Dhjk0EnN.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-D5yDigSh.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Dv6VzhWI.js";import"./index-DqFeuJ-n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BC4ik9Oa.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-BsQpZQb0.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CL8LVL2o.js";const Ke={class:"grid gap-4 md:grid-cols-4"},Te={class:"text-2xl font-bold"},Ae={class:"text-2xl font-bold"},Ie={class:"text-2xl font-bold"},Me={class:"text-2xl font-bold"},Be=X({__name:"WithdrawalStatistics",props:{statistics:{}},setup(i){return(w,n)=>(u(),y("div",Ke,[s(a(j),null,{default:l(()=>[s(a(F),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(a(R),{class:"text-sm font-medium"},{default:l(()=>[...n[0]||(n[0]=[c("Pending",-1)])]),_:1}),s(a(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(D),null,{default:l(()=>[d("div",Te,C(i.statistics.total_pending),1),n[1]||(n[1]=d("p",{class:"text-xs text-muted-foreground"},"Menunggu persetujuan",-1))]),_:1})]),_:1}),s(a(j),null,{default:l(()=>[s(a(F),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(a(R),{class:"text-sm font-medium"},{default:l(()=>[...n[2]||(n[2]=[c("Disetujui",-1)])]),_:1}),s(a(le),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(D),null,{default:l(()=>[d("div",Ae,C(i.statistics.total_completed),1),n[3]||(n[3]=d("p",{class:"text-xs text-muted-foreground"},"Withdrawal selesai",-1))]),_:1})]),_:1}),s(a(j),null,{default:l(()=>[s(a(F),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(a(R),{class:"text-sm font-medium"},{default:l(()=>[...n[4]||(n[4]=[c("Ditolak",-1)])]),_:1}),s(a(re),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(D),null,{default:l(()=>[d("div",Ie,C(i.statistics.total_failed),1),n[5]||(n[5]=d("p",{class:"text-xs text-muted-foreground"},"Withdrawal gagal",-1))]),_:1})]),_:1}),s(a(j),null,{default:l(()=>[s(a(F),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(a(R),{class:"text-sm font-medium"},{default:l(()=>[...n[6]||(n[6]=[c("Total Nominal",-1)])]),_:1}),s(a(ne),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(D),null,{default:l(()=>[d("div",Me,C(a(ve)(i.statistics.total_amount)),1),n[7]||(n[7]=d("p",{class:"text-xs text-muted-foreground"},"Total withdrawal berhasil",-1))]),_:1})]),_:1})]))}}),Ne={class:"rounded-xl p-4 space-y-6 py-6"},Ue={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Pe={class:"flex flex-1 gap-4"},We={class:"relative flex-1 max-w-sm"},ze={class:"rounded-md border"},ct=X({__name:"Index",props:{withdrawals:{},statistics:{},filters:{}},setup(i){const w=i,n=h(w.filters.search||""),f=h(w.filters.status||"all"),_=h([{id:w.filters.sort_by||"created_at",desc:w.filters.sort_order==="desc"}]),I=h([]),M=h({}),g=h({open:!1,withdrawal:null}),p=h({open:!1,withdrawal:null}),x=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),J=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),O=e=>({pending:"secondary",completed:"default",failed:"destructive"})[e]||"secondary",S=e=>{if(!e)return null;try{return JSON.parse(e)}catch{return null}},Z=e=>{g.value={open:!0,withdrawal:e}},G=()=>{if(!g.value.withdrawal)return;L({}).post(te.url(g.value.withdrawal.id),{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,withdrawal:null}}})},Q=e=>{p.value={open:!0,withdrawal:e}},Y=()=>{if(!p.value.withdrawal)return;L({}).post(ae.url(p.value.withdrawal.id),{preserveScroll:!0,onSuccess:()=>{p.value={open:!1,withdrawal:null}}})},B=[{id:"index",header:()=>r("div",{class:"w-12"},"No"),cell:({row:e})=>{const t=e.index+1+(w.withdrawals.current_page-1)*w.withdrawals.per_page;return r("div",{class:"font-medium"},t)}},{accessorKey:"customer.name",header:({column:e})=>r($,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Pelanggan",r(q,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>{const t=e.original.customer;return r("div",[r("div",{class:"font-medium"},t.name),r("div",{class:"text-xs text-muted-foreground"},t.email)])}},{accessorKey:"customer.username",header:({column:e})=>r($,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Username",r(q,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>{const t=e.original.customer;return r("div",[r("div",{class:"font-medium"},t.username),r("div",{class:"text-xs text-muted-foreground"},t.email)])}},{accessorKey:"customer.ewallet_saldo",header:()=>"Saldo",cell:({row:e})=>r("div",x(e.original.customer.ewallet_saldo))},{accessorKey:"amount",header:()=>"Penarikan",cell:({row:e})=>r("div",{class:"font-bold text-red-600"},x(e.getValue("amount")))},{accessorKey:"notes",header:()=>"Biaya Admin",cell:({row:e})=>{const t=S(e.getValue("notes"));return t?r("div",[r("div",{class:"text-xs font-medium"},`${x(t.admin_fee??0)}`)]):r("div",{class:"text-xs text-muted-foreground"},"-")}},{accessorKey:"notes",header:()=>"Biaya Admin",cell:({row:e})=>{const t=S(e.getValue("notes"));return t?r("div",[r("div",{class:"text-xs font-medium"},`${x(t.admin_fee??0)}`)]):r("div",{class:"text-xs text-muted-foreground"},"-")}},{accessorKey:"notes",header:()=>"Penarikan Net",cell:({row:e})=>{const t=S(e.getValue("notes"));return t?r("div",[r("div",{class:"text-xs font-medium"},`${x(t.net_amount??0)}`)]):r("div",{class:"text-xs text-muted-foreground"},"-")}},{accessorKey:"notes",header:()=>"Rekening Tujuan",cell:({row:e})=>{const t=S(e.getValue("notes"));return t?r("div",[r("div",{class:"text-xs font-medium"},`${t.bank_name} - ${t.bank_account}`),r("div",{class:"text-xs text-muted-foreground"},t.bank_holder)]):r("div",{class:"text-xs text-muted-foreground"},"-")}},{accessorKey:"transaction_ref",header:()=>"Referensi",cell:({row:e})=>r("div",{class:"font-mono text-xs"},e.getValue("transaction_ref"))},{accessorKey:"status",header:()=>"Status",cell:({row:e})=>{const t=e.getValue("status");return r(_e,{variant:O(t)},()=>t)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:e})=>r("div",{class:"text-sm"},J(e.getValue("created_at")))},{id:"actions",header:()=>r("div",{class:"text-right"},"Aksi"),cell:({row:e})=>{const t=e.original;if(t.status!=="pending")return null;const o=t.customer.ewallet_saldo<t.amount;return r("div",{class:"flex justify-end gap-2"},[r($,{size:"sm",onClick:()=>Z(t),disabled:o},()=>[r(ce,{class:"mr-1 h-4 w-4"}),"Setujui"]),r($,{size:"sm",variant:"destructive",onClick:()=>Q(t)},()=>[r(me,{class:"mr-1 h-4 w-4"}),"Tolak"])])}}],V=oe({get data(){return w.withdrawals.data},columns:B,getCoreRowModel:pe(),getSortedRowModel:ge(),getFilteredRowModel:fe(),onSortingChange:e=>T(e,_),onColumnFiltersChange:e=>T(e,I),onColumnVisibilityChange:e=>T(e,M),state:{get sorting(){return _.value},get columnFilters(){return I.value},get columnVisibility(){return M.value}},manualSorting:!0});U(_,e=>{e.length>0&&P.get("/admin/withdrawals",{search:n.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:e[0].id,sort_order:e[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let N;return U([n,f],()=>{clearTimeout(N),N=setTimeout(()=>{P.get("/admin/withdrawals",{search:n.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:_.value[0]?.id||"created_at",sort_order:_.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(e,t)=>(u(),y(b,null,[s(a(ie),{title:"Permintaan Withdrawal"}),s(ee,null,{default:l(()=>[d("div",Ne,[t[10]||(t[10]=d("div",null,[d("h2",{class:"text-3xl font-bold tracking-tight"},"Permintaan Withdrawal"),d("p",{class:"text-muted-foreground"},"Kelola permintaan penarikan saldo dari pelanggan")],-1)),s(Be,{statistics:i.statistics},null,8,["statistics"]),d("div",Ue,[d("div",Pe,[d("div",We,[s(a(de),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s(a(ke),{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=o=>n.value=o),placeholder:"Cari pelanggan atau referensi...",class:"pl-9"},null,8,["modelValue"])]),s(a($e),{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=o=>f.value=o)},{default:l(()=>[s(a(Ce),{class:"w-[180px]"},{default:l(()=>[s(a(Se),{placeholder:"Semua Status"})]),_:1}),s(a(Ve),null,{default:l(()=>[s(a(K),{value:"all"},{default:l(()=>[...t[4]||(t[4]=[c("Semua Status",-1)])]),_:1}),s(a(K),{value:"pending"},{default:l(()=>[...t[5]||(t[5]=[c("Pending",-1)])]),_:1}),s(a(K),{value:"completed"},{default:l(()=>[...t[6]||(t[6]=[c("Completed",-1)])]),_:1}),s(a(K),{value:"failed"},{default:l(()=>[...t[7]||(t[7]=[c("Failed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),s(a(xe),null,{default:l(()=>[s(a(he),{"as-child":""},{default:l(()=>[s(a($),{variant:"outline",class:"ml-auto"},{default:l(()=>[t[8]||(t[8]=c(" Kolom ",-1)),s(a(ue),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),s(a(ye),{align:"end"},{default:l(()=>[(u(!0),y(b,null,k(a(V).getAllColumns().filter(o=>o.getCanHide()),o=>(u(),v(a(be),{key:o.id,class:"capitalize","model-value":o.getIsVisible(),"onUpdate:modelValue":m=>{o.toggleVisibility(!!m)}},{default:l(()=>[c(C(o.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),d("div",ze,[s(a(je),null,{default:l(()=>[s(a(De),null,{default:l(()=>[(u(!0),y(b,null,k(a(V).getHeaderGroups(),o=>(u(),v(a(A),{key:o.id},{default:l(()=>[(u(!0),y(b,null,k(o.headers,m=>(u(),v(a(Fe),{key:m.id},{default:l(()=>[m.isPlaceholder?W("",!0):(u(),v(a(z),{key:0,render:m.column.columnDef.header,props:m.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),s(a(Re),null,{default:l(()=>[a(V).getRowModel().rows?.length?(u(!0),y(b,{key:0},k(a(V).getRowModel().rows,o=>(u(),v(a(A),{key:o.id},{default:l(()=>[(u(!0),y(b,null,k(o.getVisibleCells(),m=>(u(),v(a(H),{key:m.id},{default:l(()=>[s(a(z),{render:m.column.columnDef.cell,props:m.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(u(),v(a(A),{key:1},{default:l(()=>[s(a(H),{colspan:B.length,class:"h-24 text-center"},{default:l(()=>[...t[9]||(t[9]=[c(" Tidak ada permintaan withdrawal. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),i.withdrawals.last_page>1?(u(),v(we,{key:0,data:{current_page:i.withdrawals.current_page,last_page:i.withdrawals.last_page,per_page:i.withdrawals.per_page,from:(i.withdrawals.current_page-1)*i.withdrawals.per_page+1,to:Math.min(i.withdrawals.current_page*i.withdrawals.per_page,i.withdrawals.total),total:i.withdrawals.total},url:"/admin/withdrawals",filters:{search:n.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:_.value[0]?.id||"created_at",sort_order:_.value[0]?.desc?"desc":"asc"}},null,8,["data","filters"])):W("",!0)]),s(E,{open:g.value.open,"onUpdate:open":t[2]||(t[2]=o=>g.value.open=o),title:"Setujui Withdrawal?",description:`Apakah Anda yakin ingin menyetujui permintaan withdrawal sebesar ${g.value.withdrawal?x(g.value.withdrawal.amount):""} untuk ${g.value.withdrawal?.customer.name}? Dana akan ditransfer via Midtrans ke rekening tujuan.`,"confirm-text":"Setujui & Transfer","cancel-text":"Batal",onConfirm:G},null,8,["open","description"]),s(E,{open:p.value.open,"onUpdate:open":t[3]||(t[3]=o=>p.value.open=o),title:"Tolak Withdrawal?",description:`Apakah Anda yakin ingin menolak permintaan withdrawal sebesar ${p.value.withdrawal?x(p.value.withdrawal.amount):""} dari ${p.value.withdrawal?.customer.name}?`,"confirm-text":"Tolak","cancel-text":"Batal",variant:"destructive",onConfirm:Y},null,8,["open","description"])]),_:1})],64))}});export{ct as default};
