import{n as C,_ as X,p as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-ySs7Rre_.js";import{_ as ee}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-DA4pNA17.js";import{_ as te}from"./Pagination.vue_vue_type_script_setup_true_lang-CQM_G0lK.js";import{a as k,_ as R}from"./CardContent.vue_vue_type_script_setup_true_lang-LKEwQoWP.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-N3E9ALN1.js";import{_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-Mk0zvokq.js";import{d as L,v as b,g as o,b as t,w as a,u as e,s as m,ax as se,e as u,K as V,at as J,aB as ae,r as y,q as re,E as N,j as q,c as g,a1 as le,t as z,Z as ne,aa as oe,F as w,x as $,y as E,n as i,D as ue,ao as de,aM as ie,A as ce,B as me}from"./vendor-FclwbLvj.js";import{_ as fe}from"./index-CRPqrtU2.js";import{_ as M,v as P}from"./index-B4cH97KR.js";import{_ as pe,a as ge,b as _e}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D90ORJgI.js";import{_ as ve}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-BsPeayAj.js";import{_ as xe}from"./Input.vue_vue_type_script_setup_true_lang-ZVESK4JK.js";import{_ as ye,a as be,b as we,c as $e,d as S}from"./SelectValue.vue_vue_type_script_setup_true_lang-BqISnkMA.js";import{_ as he,a as Ce,b as A,c as Se,d as Ve,e as H}from"./TableHeader.vue_vue_type_script_setup_true_lang-BhZiDflO.js";import{u as ke}from"./usePermissions-DzkwVpfD.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-ByVucR83.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-9OZOAxj9.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ZLo4HemS.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DuXcz617.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-D_xJ4jwR.js";const Re={class:"grid gap-4 md:grid-cols-3"},De={class:"text-2xl font-bold"},Fe={class:"text-2xl font-bold"},Me={class:"text-2xl font-bold"},Pe=L({__name:"RefundStatistics",props:{statistics:{}},setup(n){return(j,d)=>(o(),b("div",Re,[t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[0]||(d[0]=[m("Pending",-1)])]),_:1}),t(e(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(k),null,{default:a(()=>[u("div",De,V(n.statistics.total_pending),1),d[1]||(d[1]=u("p",{class:"text-xs text-muted-foreground"},"Menunggu proses",-1))]),_:1})]),_:1}),t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[2]||(d[2]=[m("Diproses",-1)])]),_:1}),t(e(J),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(k),null,{default:a(()=>[u("div",Fe,V(n.statistics.total_processing),1),d[3]||(d[3]=u("p",{class:"text-xs text-muted-foreground"},"Sedang diproses",-1))]),_:1})]),_:1}),t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[4]||(d[4]=[m("Selesai",-1)])]),_:1}),t(e(ae),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(k),null,{default:a(()=>[u("div",Me,V(n.statistics.total_completed),1),d[5]||(d[5]=u("p",{class:"text-xs text-muted-foreground"},"Refund selesai",-1))]),_:1})]),_:1})]))}}),Ae={class:"rounded-xl p-4 space-y-6 py-6"},je={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Be={class:"flex flex-1 gap-4"},Ie={class:"relative flex-1 max-w-sm"},Ke={class:"rounded-md border"},nt=L({__name:"Index",props:{refunds:{},statistics:{},filters:{}},setup(n){const{isSuperAdmin:j,isAdmin:d}=ke(),_=n,O=[{title:"Refund",href:C.url()}],x=y(_.filters.search||""),f=y(_.filters.status||"all"),v=y([{id:_.filters.sort_by||"created_at",desc:_.filters.sort_order==="desc"}]),B=y([]),I=y({}),p=y({open:!1,refund:null}),Z=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),K=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),G=s=>({pending:"secondary",processing:"outline",completed:"default"})[s]||"secondary",Q=s=>{p.value={open:!0,refund:s}},W=()=>{if(!p.value.refund)return;ue({}).post(Y.url(p.value.refund.id),{preserveScroll:!0,onSuccess:()=>{p.value={open:!1,refund:null}}})},U=[{id:"index",header:()=>i("div",{class:"w-12"},"No"),cell:({row:s})=>{const r=s.index+1+(_.refunds.current_page-1)*_.refunds.per_page;return i("div",{class:"font-medium"},r)}},{accessorKey:"order.order_no",header:({column:s})=>i(M,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Order",i(de,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>{const r=s.original.order;return i("div",[i("div",{class:"font-medium"},r.order_no),i("div",{class:"text-xs text-muted-foreground"},r.customer?.name||"Unknown")])}},{accessorKey:"amount",header:()=>"Jumlah",cell:({row:s})=>i("div",{class:"font-medium"},K(s.getValue("amount")))},{accessorKey:"reason",header:()=>"Alasan",cell:({row:s})=>i("div",{class:"max-w-xs truncate"},s.getValue("reason"))},{accessorKey:"status",header:()=>"Status",cell:({row:s})=>{const r=s.getValue("status");return i(fe,{variant:G(r)},()=>r)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:s})=>Z(s.getValue("created_at"))},{id:"actions",header:()=>i("div",{class:"text-right"},"Actions"),cell:({row:s})=>{const r=s.original;return r.status==="completed"?null:((j||d)&&[].push(i(M,{variant:"default",size:"sm",onClick:()=>Q(r)},()=>[i(J,{class:"mr-2 h-4 w-4"}),"Proses"])),i("div",{class:"flex justify-end gap-2"},[]))}}],h=re({get data(){return _.refunds.data},columns:U,getCoreRowModel:me(),getSortedRowModel:ce(),getFilteredRowModel:ie(),onSortingChange:s=>P(s,v),onColumnFiltersChange:s=>P(s,B),onColumnVisibilityChange:s=>P(s,I),state:{get sorting(){return v.value},get columnFilters(){return B.value},get columnVisibility(){return I.value}},manualSorting:!0});N(v,s=>{s.length>0&&q.get(C.url(),{search:x.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let T;return N([x,f],()=>{clearTimeout(T),T=setTimeout(()=>{q.get(C.url(),{search:x.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,r)=>(o(),g(X,{breadcrumbs:O},{default:a(()=>[t(e(le),{title:"Refund"}),u("div",Ae,[r[9]||(r[9]=u("div",{class:"flex items-center justify-between"},[u("div",null,[u("h1",{class:"text-3xl font-bold tracking-tight"},"Refund"),u("p",{class:"text-muted-foreground"},"Kelola permintaan pengembalian dana")])],-1)),t(Pe,{statistics:n.statistics},null,8,["statistics"]),u("div",je,[u("div",Be,[u("div",Ie,[t(e(ne),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(xe),{modelValue:x.value,"onUpdate:modelValue":r[0]||(r[0]=l=>x.value=l),placeholder:"Cari order atau customer...",class:"pl-9"},null,8,["modelValue"])]),t(e(ye),{modelValue:f.value,"onUpdate:modelValue":r[1]||(r[1]=l=>f.value=l)},{default:a(()=>[t(e(be),{class:"w-[180px]"},{default:a(()=>[t(e(we),{placeholder:"Semua Status"})]),_:1}),t(e($e),null,{default:a(()=>[t(e(S),{value:"all"},{default:a(()=>[...r[3]||(r[3]=[m("Semua Status",-1)])]),_:1}),t(e(S),{value:"pending"},{default:a(()=>[...r[4]||(r[4]=[m("Pending",-1)])]),_:1}),t(e(S),{value:"processing"},{default:a(()=>[...r[5]||(r[5]=[m("Processing",-1)])]),_:1}),t(e(S),{value:"completed"},{default:a(()=>[...r[6]||(r[6]=[m("Completed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(pe),null,{default:a(()=>[t(e(ge),{"as-child":""},{default:a(()=>[t(e(M),{variant:"outline",class:"ml-auto"},{default:a(()=>[r[7]||(r[7]=m(" Kolom ",-1)),t(e(oe),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(_e),{align:"end"},{default:a(()=>[(o(!0),b(w,null,$(e(h).getAllColumns().filter(l=>l.getCanHide()),l=>(o(),g(e(ve),{key:l.id,class:"capitalize","model-value":l.getIsVisible(),"onUpdate:modelValue":c=>{l.toggleVisibility(!!c)}},{default:a(()=>[m(V(l.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),u("div",Ke,[t(e(he),null,{default:a(()=>[t(e(Ce),null,{default:a(()=>[(o(!0),b(w,null,$(e(h).getHeaderGroups(),l=>(o(),g(e(A),{key:l.id},{default:a(()=>[(o(!0),b(w,null,$(l.headers,c=>(o(),g(e(Se),{key:c.id},{default:a(()=>[c.isPlaceholder?z("",!0):(o(),g(e(E),{key:0,render:c.column.columnDef.header,props:c.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(Ve),null,{default:a(()=>[e(h).getRowModel().rows?.length?(o(!0),b(w,{key:0},$(e(h).getRowModel().rows,l=>(o(),g(e(A),{key:l.id},{default:a(()=>[(o(!0),b(w,null,$(l.getVisibleCells(),c=>(o(),g(e(H),{key:c.id},{default:a(()=>[t(e(E),{render:c.column.columnDef.cell,props:c.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(o(),g(e(A),{key:1},{default:a(()=>[t(e(H),{colspan:U.length,class:"h-24 text-center"},{default:a(()=>[...r[8]||(r[8]=[m(" Tidak ada data refund. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),n.refunds.last_page>1?(o(),g(te,{key:0,data:{current_page:n.refunds.current_page,last_page:n.refunds.last_page,per_page:n.refunds.per_page,from:(n.refunds.current_page-1)*n.refunds.per_page+1,to:Math.min(n.refunds.current_page*n.refunds.per_page,n.refunds.total),total:n.refunds.total},url:e(C).url(),filters:{search:x.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):z("",!0)]),t(ee,{open:p.value.open,"onUpdate:open":r[2]||(r[2]=l=>p.value.open=l),title:"Proses Refund?",description:`Apakah Anda yakin ingin memproses refund untuk order ${p.value.refund?.order.order_no} sebesar ${p.value.refund?K(p.value.refund.amount):""}?`,"confirm-text":"Proses","cancel-text":"Batal",onConfirm:W},null,8,["open","description"])]),_:1}))}});export{nt as default};
