import{d as L,r as f,am as U,p as H,q as G,c as u,g as n,w as r,b as l,e as c,u as s,a0 as q,a3 as b,s as K,Y as O,Z as Q,v as h,F as x,x as y,t as Y,y as I,n as t,an as N,ao as Z,ap as J,$ as W,z as X,D as ee,Q as w,j as B,B as ae}from"./vendor-MSza8NbP.js";import{c as te,i as F,_ as se,a as le,e as re,d as ne}from"./AppLayout.vue_vue_type_script_setup_true_lang-4ED1Xj29.js";import{_ as m}from"./index-DPBmQVLp.js";import{_ as oe}from"./Input.vue_vue_type_script_setup_true_lang-bXD-JnOr.js";import{_ as T}from"./index-DWwRQAkq.js";import{_ as ie,a as ce,b as V,c as de,d as ue,e as z}from"./TableHeader.vue_vue_type_script_setup_true_lang-gCq3xuQk.js";import{_ as me}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-Bm7ku-wc.js";import{_ as pe}from"./Pagination.vue_vue_type_script_setup_true_lang-ZI4hZ9bj.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-CAy2W9eb.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BZBhZv32.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-VUM4Jj0u.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-LF5-spqp.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-B-o61Jab.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BEfnzQ6f.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-C9D_fxoj.js";const ge={class:"rounded-xl p-4 space-y-6 py-6"},fe={class:"mb-6 flex items-center justify-between"},_e={class:"mb-4 flex items-center gap-4"},ve={class:"relative flex-1"},he={class:"rounded-md border"},Te=L({__name:"Index",props:{customers:{},filters:{}},setup(C){const E=(a,e)=>{ee({}).post(`/manage/customers/${a}/login-as`,{onSuccess:()=>{w.success(`Login sebagai ${e}`)},onError:()=>{w.error("Gagal login sebagai customer")}})},d=C,_=f(d.filters.search||""),v=f(d.filters.sort_by||"created_at"),g=f(d.filters.sort_order||"desc"),$=f(d.filters.per_page||10),M=a=>{B.delete(ne.url(a),{preserveScroll:!0,onSuccess:()=>{w.success("Pelanggan berhasil dihapus")},onError:()=>{w.error("Gagal menghapus pelanggan")}})},p=f({open:!1,data:null}),R=a=>{p.value={open:!0,data:a}},D=U(()=>{B.get(F.url(),{search:_.value,sort_by:v.value,sort_order:g.value,per_page:$.value},{preserveState:!0,preserveScroll:!0})},300),S=a=>{v.value===a?g.value=g.value==="asc"?"desc":"asc":(v.value=a,g.value="asc"),D()},j=()=>{p.value.data&&M(p.value.data.id)},P=[{id:"index",header:()=>t("div",{class:"text-left"},"No"),cell:({row:a})=>{const e=a.index+1+(d.customers.current_page-1)*d.customers.per_page;return t("div",{class:"text-left"},e.toString())}},{accessorKey:"ewallet_id",header:()=>t(m,{variant:"ghost",onClick:()=>S("ewallet_id")},()=>["Ewallet ID",t(N,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>t("div",{class:"font-mono text-sm"},a.getValue("ewallet_id"))},{accessorKey:"name",header:()=>t(m,{variant:"ghost",onClick:()=>S("name")},()=>["Nama",t(N,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>t("div",{},a.getValue("name"))},{accessorKey:"email",header:"Email",cell:({row:a})=>t("div",{class:"text-sm"},a.getValue("email"))},{accessorKey:"phone",header:"Telepon",cell:({row:a})=>{const e=a.getValue("phone");return t("div",{class:"text-sm"},e||"-")}},{accessorKey:"ewallet_saldo",header:()=>t("div",{class:"text-right"},"Saldo"),cell:({row:a})=>{const e=a.getValue("ewallet_saldo");return t("div",{class:"text-right font-medium"},"Rp "+new Intl.NumberFormat("id-ID").format(e))}},{accessorKey:"position",header:"Posisi",cell:({row:a})=>{const e=a.getValue("position");return e?t(T,{variant:e==="left"?"default":"secondary",class:"capitalize"},()=>e):t("div",{class:"text-center"},"-")}},{accessorKey:"email_verified_at",header:"Status",cell:({row:a})=>{const e=a.getValue("email_verified_at");return t(T,{variant:e?"default":"outline"},()=>e?"Verified":"Unverified")}},{id:"actions",header:()=>t("div",{class:"text-center"},"Aksi"),cell:({row:a})=>{const e=a.original;return t("div",{class:"flex items-center justify-center gap-2"},[t(m,{variant:"ghost",size:"icon",onClick:()=>E(e.id,e.name),title:"Login sebagai customer"},()=>t(Z,{class:"h-4 w-4 text-primary"})),t(b,{href:le.url(e.id)},()=>t(m,{variant:"ghost",size:"icon"},()=>t(J,{class:"h-4 w-4"}))),t(b,{href:re.url(e.id)},()=>t(m,{variant:"ghost",size:"icon"},()=>t(W,{class:"h-4 w-4"}))),t(m,{variant:"ghost",size:"icon",onClick:()=>R(e)},()=>t(X,{class:"h-4 w-4 text-destructive"}))])}}],A=H(()=>d.customers.data),k=G({get data(){return A.value},columns:P,getCoreRowModel:ae(),manualSorting:!0,manualPagination:!0});return(a,e)=>(n(),u(se,null,{default:r(()=>[l(s(q),{title:"Kelola Pelanggan"}),c("div",ge,[c("div",fe,[e[3]||(e[3]=c("div",null,[c("h1",{class:"text-3xl font-bold tracking-tight"},"Kelola Pelanggan"),c("p",{class:"text-muted-foreground"}," Kelola data pelanggan dan jaringan MLM ")],-1)),l(s(b),{href:s(te).url()},{default:r(()=>[l(s(m),null,{default:r(()=>[l(s(O),{class:"mr-2 h-4 w-4"}),e[2]||(e[2]=K(" Tambah Pelanggan ",-1))]),_:1})]),_:1},8,["href"])]),c("div",_e,[c("div",ve,[l(s(Q),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),l(s(oe),{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),placeholder:"Cari nama, email, telepon, atau ewallet ID...",class:"pl-10",onInput:s(D)},null,8,["modelValue","onInput"])])]),c("div",he,[l(s(ie),null,{default:r(()=>[l(s(ce),null,{default:r(()=>[(n(!0),h(x,null,y(s(k).getHeaderGroups(),o=>(n(),u(s(V),{key:o.id},{default:r(()=>[(n(!0),h(x,null,y(o.headers,i=>(n(),u(s(de),{key:i.id},{default:r(()=>[i.isPlaceholder?Y("",!0):(n(),u(s(I),{key:0,render:i.column.columnDef.header,props:i.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),l(s(ue),null,{default:r(()=>[s(k).getRowModel().rows?.length?(n(!0),h(x,{key:0},y(s(k).getRowModel().rows,o=>(n(),u(s(V),{key:o.id},{default:r(()=>[(n(!0),h(x,null,y(o.getVisibleCells(),i=>(n(),u(s(z),{key:i.id},{default:r(()=>[l(s(I),{render:i.column.columnDef.cell,props:i.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(n(),u(s(V),{key:1},{default:r(()=>[l(s(z),{colspan:P.length,class:"h-24 text-center"},{default:r(()=>[...e[4]||(e[4]=[K(" Tidak ada data pelanggan. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),l(pe,{data:C.customers,url:s(F).url(),filters:{search:_.value,sort_by:v.value,sort_order:g.value,per_page:$.value}},null,8,["data","url","filters"])]),l(me,{open:p.value.open,"onUpdate:open":e[1]||(e[1]=o=>p.value.open=o),title:"Hapus Pelanggan?",description:`Apakah Anda yakin ingin menghapus pelanggan ${p.value.data?.name}? Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data terkait termasuk jaringan dan bonus.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:j},null,8,["open","description"])]),_:1}))}});export{Te as default};
