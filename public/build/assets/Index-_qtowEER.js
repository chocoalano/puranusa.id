import{_ as G,B as O,C as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-BWDCecJb.js";import{d as J,v as b,g as d,b as t,u as e,w as s,s as p,cu as ee,e as i,J as k,cv as te,b7 as ae,ar as se,r as y,q as le,D as N,j as C,Z as oe,c as v,t as P,W as re,a7 as ne,F as w,x as $,y as z,n,ak as ue,bQ as ie,X as de,aD as pe,A as ce,B as me}from"./vendor-CraqpIJ-.js";import{_ as q}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-D8AYChA2.js";import{_ as fe}from"./Pagination.vue_vue_type_script_setup_true_lang-D1dwDX2q.js";import{_ as S,a as V}from"./CardContent.vue_vue_type_script_setup_true_lang-DM70BYA8.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-D25MJpMC.js";import{_ as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-l0wDcl-m.js";import{_ as ge}from"./index-COroZ9V9.js";import{_ as j,v as U}from"./index-DPd1r_cX.js";import{_ as _e,a as ve,b as xe}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DA-zofsy.js";import{_ as ye}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-Biukrt9b.js";import{_ as be}from"./Input.vue_vue_type_script_setup_true_lang-CqlAd_sW.js";import{_ as we,a as $e,b as ke,c as he,d as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-Bvtl-Sz4.js";import{_ as Ce,a as Se,b as M,c as Ve,d as De,e as H}from"./TableHeader.vue_vue_type_script_setup_true_lang-DUQMK31p.js";import"./index-B7Ms5jW_.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-BmdNsnpq.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-4BlfWucD.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BZHhRcHM.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CQgGBfly.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-C2jUDPfA.js";const Te={class:"grid gap-4 md:grid-cols-4"},je={class:"text-2xl font-bold"},Fe={class:"text-2xl font-bold"},Re={class:"text-2xl font-bold"},Ue={class:"text-2xl font-bold"},Me=J({__name:"TopupStatistics",props:{statistics:{}},setup(u){const m=f=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(f);return(f,o)=>(d(),b("div",Te,[t(e(S),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(T),{class:"text-sm font-medium"},{default:s(()=>[...o[0]||(o[0]=[p("Pending",-1)])]),_:1}),t(e(ee),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[i("div",je,k(u.statistics.total_pending),1),o[1]||(o[1]=i("p",{class:"text-xs text-muted-foreground"},"Menunggu persetujuan",-1))]),_:1})]),_:1}),t(e(S),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(T),{class:"text-sm font-medium"},{default:s(()=>[...o[2]||(o[2]=[p("Disetujui",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[i("div",Fe,k(u.statistics.total_completed),1),o[3]||(o[3]=i("p",{class:"text-xs text-muted-foreground"},"Topup selesai",-1))]),_:1})]),_:1}),t(e(S),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(T),{class:"text-sm font-medium"},{default:s(()=>[...o[4]||(o[4]=[p("Ditolak",-1)])]),_:1}),t(e(ae),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[i("div",Re,k(u.statistics.total_failed),1),o[5]||(o[5]=i("p",{class:"text-xs text-muted-foreground"},"Topup gagal",-1))]),_:1})]),_:1}),t(e(S),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(T),{class:"text-sm font-medium"},{default:s(()=>[...o[6]||(o[6]=[p("Total Nominal",-1)])]),_:1}),t(e(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[i("div",Ue,k(m(u.statistics.total_amount)),1),o[7]||(o[7]=i("p",{class:"text-xs text-muted-foreground"},"Total topup berhasil",-1))]),_:1})]),_:1})]))}}),Ae={class:"rounded-xl p-4 space-y-6 py-6"},Ie={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Be={class:"flex flex-1 gap-4"},Ke={class:"relative flex-1 max-w-sm"},Ne={class:"rounded-md border"},rt=J({__name:"Index",props:{topups:{},statistics:{},filters:{}},setup(u){const m=u,f=y(m.filters.search||""),o=y(m.filters.status||"all"),x=y([{id:m.filters.sort_by||"created_at",desc:m.filters.sort_order==="desc"}]),A=y([]),I=y({}),g=y({open:!1,topup:null}),_=y({open:!1,topup:null}),R=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),L=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),X=a=>({pending:"secondary",completed:"default",failed:"destructive"})[a]||"secondary",E=a=>{g.value={open:!0,topup:a}},Q=()=>{g.value.topup&&C.post(O.url(g.value.topup.id),{},{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,topup:null}}})},W=a=>{_.value={open:!0,topup:a}},Z=()=>{_.value.topup&&C.post(Y.url(_.value.topup.id),{},{preserveScroll:!0,onSuccess:()=>{_.value={open:!1,topup:null}}})},B=[{id:"index",header:()=>n("div",{class:"w-12"},"No"),cell:({row:a})=>{const l=a.index+1+(m.topups.current_page-1)*m.topups.per_page;return n("div",{class:"font-medium"},l)}},{accessorKey:"customer.name",header:({column:a})=>n(j,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Pelanggan",n(ue,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>{const l=a.original.customer;return n("div",[n("div",{class:"font-medium"},l.name),n("div",{class:"text-xs text-muted-foreground"},l.email)])}},{accessorKey:"amount",header:()=>"Jumlah",cell:({row:a})=>n("div",{class:"font-bold"},R(a.getValue("amount")))},{accessorKey:"payment_method",header:()=>"Metode",cell:({row:a})=>n("div",{class:"uppercase"},a.getValue("payment_method"))},{accessorKey:"transaction_ref",header:()=>"Referensi",cell:({row:a})=>n("div",{class:"font-mono text-xs"},a.getValue("transaction_ref"))},{accessorKey:"status",header:()=>"Status",cell:({row:a})=>{const l=a.getValue("status");return n(ge,{variant:X(l)},()=>l)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:a})=>n("div",{class:"text-sm"},L(a.getValue("created_at")))},{id:"actions",header:()=>n("div",{class:"text-right"},"Aksi"),cell:({row:a})=>{const l=a.original;return l.status!=="pending"?null:n("div",{class:"flex justify-end gap-2"},[n(j,{size:"sm",onClick:()=>E(l)},()=>[n(ie,{class:"mr-1 h-4 w-4"}),"Setujui"]),n(j,{size:"sm",variant:"destructive",onClick:()=>W(l)},()=>[n(de,{class:"mr-1 h-4 w-4"}),"Tolak"])])}}],h=le({get data(){return m.topups.data},columns:B,getCoreRowModel:me(),getSortedRowModel:ce(),getFilteredRowModel:pe(),onSortingChange:a=>U(a,x),onColumnFiltersChange:a=>U(a,A),onColumnVisibilityChange:a=>U(a,I),state:{get sorting(){return x.value},get columnFilters(){return A.value},get columnVisibility(){return I.value}},manualSorting:!0});N(x,a=>{a.length>0&&C.get("/admin/topups",{search:f.value||void 0,status:o.value!=="all"?o.value:void 0,sort_by:a[0].id,sort_order:a[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let K;return N([f,o],()=>{clearTimeout(K),K=setTimeout(()=>{C.get("/admin/topups",{search:f.value||void 0,status:o.value!=="all"?o.value:void 0,sort_by:x.value[0]?.id||"created_at",sort_order:x.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(a,l)=>(d(),b(w,null,[t(e(oe),{title:"Permintaan Top Up"}),t(G,null,{default:s(()=>[i("div",Ae,[l[10]||(l[10]=i("div",null,[i("h2",{class:"text-3xl font-bold tracking-tight"},"Permintaan Top Up"),i("p",{class:"text-muted-foreground"},"Kelola permintaan top up saldo dari pelanggan")],-1)),t(Me,{statistics:u.statistics},null,8,["statistics"]),i("div",Ie,[i("div",Be,[i("div",Ke,[t(e(re),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(be),{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=r=>f.value=r),placeholder:"Cari pelanggan atau referensi...",class:"pl-9"},null,8,["modelValue"])]),t(e(we),{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=r=>o.value=r)},{default:s(()=>[t(e($e),{class:"w-[180px]"},{default:s(()=>[t(e(ke),{placeholder:"Semua Status"})]),_:1}),t(e(he),null,{default:s(()=>[t(e(F),{value:"all"},{default:s(()=>[...l[4]||(l[4]=[p("Semua Status",-1)])]),_:1}),t(e(F),{value:"pending"},{default:s(()=>[...l[5]||(l[5]=[p("Pending",-1)])]),_:1}),t(e(F),{value:"completed"},{default:s(()=>[...l[6]||(l[6]=[p("Completed",-1)])]),_:1}),t(e(F),{value:"failed"},{default:s(()=>[...l[7]||(l[7]=[p("Failed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(_e),null,{default:s(()=>[t(e(ve),{"as-child":""},{default:s(()=>[t(e(j),{variant:"outline",class:"ml-auto"},{default:s(()=>[l[8]||(l[8]=p(" Kolom ",-1)),t(e(ne),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(xe),{align:"end"},{default:s(()=>[(d(!0),b(w,null,$(e(h).getAllColumns().filter(r=>r.getCanHide()),r=>(d(),v(e(ye),{key:r.id,class:"capitalize","model-value":r.getIsVisible(),"onUpdate:modelValue":c=>{r.toggleVisibility(!!c)}},{default:s(()=>[p(k(r.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),i("div",Ne,[t(e(Ce),null,{default:s(()=>[t(e(Se),null,{default:s(()=>[(d(!0),b(w,null,$(e(h).getHeaderGroups(),r=>(d(),v(e(M),{key:r.id},{default:s(()=>[(d(!0),b(w,null,$(r.headers,c=>(d(),v(e(Ve),{key:c.id},{default:s(()=>[c.isPlaceholder?P("",!0):(d(),v(e(z),{key:0,render:c.column.columnDef.header,props:c.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(De),null,{default:s(()=>[e(h).getRowModel().rows?.length?(d(!0),b(w,{key:0},$(e(h).getRowModel().rows,r=>(d(),v(e(M),{key:r.id},{default:s(()=>[(d(!0),b(w,null,$(r.getVisibleCells(),c=>(d(),v(e(H),{key:c.id},{default:s(()=>[t(e(z),{render:c.column.columnDef.cell,props:c.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(d(),v(e(M),{key:1},{default:s(()=>[t(e(H),{colspan:B.length,class:"h-24 text-center"},{default:s(()=>[...l[9]||(l[9]=[p(" Tidak ada permintaan topup. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),u.topups.last_page>1?(d(),v(fe,{key:0,data:{current_page:u.topups.current_page,last_page:u.topups.last_page,per_page:u.topups.per_page,from:(u.topups.current_page-1)*u.topups.per_page+1,to:Math.min(u.topups.current_page*u.topups.per_page,u.topups.total),total:u.topups.total},url:"/admin/topups",filters:{search:f.value||void 0,status:o.value!=="all"?o.value:void 0,sort_by:x.value[0]?.id||"created_at",sort_order:x.value[0]?.desc?"desc":"asc"}},null,8,["data","filters"])):P("",!0)]),t(q,{open:g.value.open,"onUpdate:open":l[2]||(l[2]=r=>g.value.open=r),title:"Setujui Top Up?",description:`Apakah Anda yakin ingin menyetujui permintaan top up sebesar ${g.value.topup?R(g.value.topup.amount):""} untuk ${g.value.topup?.customer.name}?`,"confirm-text":"Setujui","cancel-text":"Batal",onConfirm:Q},null,8,["open","description"]),t(q,{open:_.value.open,"onUpdate:open":l[3]||(l[3]=r=>_.value.open=r),title:"Tolak Top Up?",description:`Apakah Anda yakin ingin menolak permintaan top up sebesar ${_.value.topup?R(_.value.topup.amount):""} dari ${_.value.topup?.customer.name}?`,"confirm-text":"Tolak","cancel-text":"Batal",variant:"destructive",onConfirm:Z},null,8,["open","description"])]),_:1})],64))}});export{rt as default};
