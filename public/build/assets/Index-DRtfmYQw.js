import{j as k,k as G,_ as Q,l as W,m as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-C9ON-RNz.js";import{_ as O}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-DOF9i1Mo.js";import{a as I,_ as M}from"./CardContent.vue_vue_type_script_setup_true_lang-tg0tM1mE.js";import{_ as A}from"./CardHeader.vue_vue_type_script_setup_true_lang-DNr1O3j0.js";import{_ as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-DiexmtNY.js";import{d as V,v as y,g as m,b as t,w as a,u as e,s as v,bd as ee,e as d,K as b,ct as te,cu as se,ac as F,Z as ae,r as w,q as oe,E as N,j as C,c as x,a0 as le,t as H,a3 as S,Y as re,F as D,x as P,y as L,n,J as T,a4 as ne,a5 as ie,a6 as de,a7 as ue,a8 as ce,a9 as me,aa as fe,cq as pe,z as ve,A as ge,B as he}from"./vendor-CZXNXaHB.js";import{_ as _e}from"./Input.vue_vue_type_script_setup_true_lang-CQ6gFgAL.js";import{a as xe,b as ye,c as be,d as $,_ as ke}from"./SelectValue.vue_vue_type_script_setup_true_lang-Dx5Mn26f.js";import{_ as we}from"./index-B-sjbl-G.js";import{_ as h}from"./index-DQccm4Bv.js";import{_ as Se,a as $e,b as B,c as Ce,d as De,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-DUNzXVGC.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-TpB8oA6T.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Bh3WDF-P.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-gjluvqqt.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B95dSWYf.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-BDsQhCvz.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-ByTOEn2m.js";const Pe={class:"grid gap-4 md:grid-cols-3"},Te={class:"text-2xl font-bold"},Re={class:"text-2xl font-bold"},je={class:"text-2xl font-bold"},Ie=V({__name:"PromotionStatistics",props:{statistics:{}},setup(o){return(f,i)=>(m(),y("div",Pe,[t(e(M),null,{default:a(()=>[t(e(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(z),{class:"text-sm font-medium"},{default:a(()=>[...i[0]||(i[0]=[v("Promosi Aktif",-1)])]),_:1}),t(e(ee),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(I),null,{default:a(()=>[d("div",Te,b(o.statistics.total_active),1),i[1]||(i[1]=d("p",{class:"text-xs text-muted-foreground"},"Sedang berjalan",-1))]),_:1})]),_:1}),t(e(M),null,{default:a(()=>[t(e(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(z),{class:"text-sm font-medium"},{default:a(()=>[...i[2]||(i[2]=[v("Terjadwal",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(I),null,{default:a(()=>[d("div",Re,b(o.statistics.total_scheduled),1),i[3]||(i[3]=d("p",{class:"text-xs text-muted-foreground"},"Akan datang",-1))]),_:1})]),_:1}),t(e(M),null,{default:a(()=>[t(e(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(z),{class:"text-sm font-medium"},{default:a(()=>[...i[4]||(i[4]=[v("Kadaluarsa",-1)])]),_:1}),t(e(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(I),null,{default:a(()=>[d("div",je,b(o.statistics.total_expired),1),i[5]||(i[5]=d("p",{class:"text-xs text-muted-foreground"},"Sudah berakhir",-1))]),_:1})]),_:1})]))}}),Me={class:"flex items-center gap-4"},Ae={class:"relative flex-1"},ze=V({__name:"PromotionFilters",props:{search:{required:!0},searchModifiers:{},type:{required:!0},typeModifiers:{}},emits:["update:search","update:type"],setup(o){const f=F(o,"search"),i=F(o,"type");return(g,l)=>(m(),y("div",Me,[d("div",Ae,[t(e(ae),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(_e),{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=u=>f.value=u),placeholder:"Cari promosi...",class:"pl-9"},null,8,["modelValue"])]),t(e(ke),{modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=u=>i.value=u)},{default:a(()=>[t(e(xe),{class:"w-40"},{default:a(()=>[t(e(ye),{placeholder:"Semua Tipe"})]),_:1}),t(e(be),null,{default:a(()=>[t(e($),{value:"all"},{default:a(()=>[...l[2]||(l[2]=[v("Semua Tipe",-1)])]),_:1}),t(e($),{value:"discount"},{default:a(()=>[...l[3]||(l[3]=[v("Diskon",-1)])]),_:1}),t(e($),{value:"bundle"},{default:a(()=>[...l[4]||(l[4]=[v("Bundle",-1)])]),_:1}),t(e($),{value:"flash_sale"},{default:a(()=>[...l[5]||(l[5]=[v("Flash Sale",-1)])]),_:1}),t(e($),{value:"promo"},{default:a(()=>[...l[6]||(l[6]=[v("Promo",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Be={class:"rounded-xl p-4 space-y-6 py-6"},Ve={class:"flex items-center justify-between"},qe={class:"rounded-md border"},Ke={key:0,class:"flex items-center justify-between"},Ue={class:"text-sm text-muted-foreground"},Fe={class:"flex gap-2"},rt=V({__name:"Index",props:{promotions:{},statistics:{},filters:{}},setup(o){const f=o,i=[{title:"Promosi & Diskon",href:k.url()}],g=w(f.filters.search||""),l=w(f.filters.type||"all"),u=w([{id:f.filters.sort_by,desc:f.filters.sort_order==="desc"}]),R=w({}),_=w({open:!1,promotion:null}),q=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),J=s=>{const r=new Date,c=new Date(s.start_at),p=new Date(s.end_at);return s.is_active?r<c?{text:"Scheduled",variant:"outline"}:r>p?{text:"Expired",variant:"destructive"}:{text:"Active",variant:"default"}:{text:"Inactive",variant:"secondary"}},Y=s=>{_.value={open:!0,promotion:s}},Z=()=>{_.value.promotion&&C.delete(W.url(_.value.promotion.id),{preserveScroll:!0,onSuccess:()=>{_.value={open:!1,promotion:null}}})},K=[{id:"select",header:({table:s})=>n("input",{type:"checkbox",checked:s.getIsAllPageRowsSelected(),indeterminate:s.getIsSomePageRowsSelected(),onChange:s.getToggleAllPageRowsSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),cell:({row:s})=>n("input",{type:"checkbox",checked:s.getIsSelected(),disabled:!s.getCanSelect(),onChange:s.getToggleSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),enableSorting:!1},{id:"index",header:()=>n("div",{class:"w-12"},"No"),cell:({row:s})=>{const r=s.index+1+(f.promotions.current_page-1)*f.promotions.per_page;return n("div",{class:"font-medium"},r)}},{accessorKey:"name",header:({column:s})=>n(h,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Nama Promosi",n(s.getIsSorted()==="asc"?ce:s.getIsSorted()==="desc"?me:fe,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>n("div",[n("div",{class:"font-medium"},s.original.name),n("div",{class:"text-xs text-muted-foreground"},s.original.type)])},{accessorKey:"code",header:()=>n("div","Kode"),cell:({row:s})=>n("div",{class:"font-mono text-sm"},s.original.code)},{accessorKey:"start_at",header:()=>"Periode",cell:({row:s})=>n("div",{class:"text-sm"},[n("div",q(s.original.start_at)),n("div",{class:"text-muted-foreground"},q(s.original.end_at))])},{id:"status",header:()=>"Status",cell:({row:s})=>{const r=J(s.original);return n(we,{variant:r.variant},()=>r.text)}},{id:"actions",header:()=>n("div",{class:"text-right"},"Actions"),cell:({row:s})=>{const r=s.original;return n("div",{class:"flex justify-end gap-2"},[n(h,{variant:"outline",size:"sm",onClick:()=>C.visit(X.url(r.id))},()=>n(pe,{class:"h-4 w-4"})),n(h,{variant:"outline",size:"sm",onClick:()=>Y(r)},()=>n(ve,{class:"h-4 w-4 text-destructive"}))])}}],j=oe({get data(){return f.promotions.data},columns:K,getCoreRowModel:he(),getSortedRowModel:ge(),state:{get sorting(){return u.value},get rowSelection(){return R.value}},onSortingChange:s=>{u.value=typeof s=="function"?s(u.value):s},onRowSelectionChange:s=>{R.value=typeof s=="function"?s(R.value):s},manualSorting:!0,enableRowSelection:!0});N(u,s=>{s.length>0&&C.get(k.url(),{search:g.value||void 0,type:l.value!=="all"?l.value:void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let U;return N([g,l],()=>{clearTimeout(U),U=setTimeout(()=>{C.get(k.url(),{search:g.value||void 0,type:l.value!=="all"?l.value:void 0,sort_by:u.value[0]?.id||"created_at",sort_order:u.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,r)=>(m(),x(Q,{breadcrumbs:i},{default:a(()=>[t(e(le),{title:"Promosi & Diskon"}),d("div",Be,[d("div",Ve,[r[4]||(r[4]=d("div",null,[d("h1",{class:"text-3xl font-bold tracking-tight"},"Promosi & Diskon"),d("p",{class:"text-muted-foreground"},"Kelola promosi dan diskon produk")],-1)),t(e(S),{href:e(G).url()},{default:a(()=>[t(e(h),null,{default:a(()=>[t(e(re),{class:"h-4 w-4"}),r[3]||(r[3]=v(" Tambah Promosi ",-1))]),_:1})]),_:1},8,["href"])]),t(Ie,{statistics:o.statistics},null,8,["statistics"]),t(ze,{search:g.value,"onUpdate:search":r[0]||(r[0]=c=>g.value=c),type:l.value,"onUpdate:type":r[1]||(r[1]=c=>l.value=c)},null,8,["search","type"]),d("div",qe,[t(e(Se),null,{default:a(()=>[t(e($e),null,{default:a(()=>[(m(!0),y(D,null,P(e(j).getHeaderGroups(),c=>(m(),x(e(B),{key:c.id},{default:a(()=>[(m(!0),y(D,null,P(c.headers,p=>(m(),x(e(Ce),{key:p.id},{default:a(()=>[p.isPlaceholder?H("",!0):(m(),x(e(L),{key:0,render:p.column.columnDef.header,props:p.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(De),null,{default:a(()=>[e(j).getRowModel().rows?.length?(m(!0),y(D,{key:0},P(e(j).getRowModel().rows,c=>(m(),x(e(B),{key:c.id,"data-state":c.getIsSelected()?"selected":void 0},{default:a(()=>[(m(!0),y(D,null,P(c.getVisibleCells(),p=>(m(),x(e(E),{key:p.id},{default:a(()=>[t(e(L),{render:p.column.columnDef.cell,props:p.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(m(),x(e(B),{key:1},{default:a(()=>[t(e(E),{colspan:K.length,class:"h-24 text-center"},{default:a(()=>[...r[5]||(r[5]=[v(" Tidak ada data promosi. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),o.promotions.last_page>1?(m(),y("div",Ke,[d("p",Ue," Menampilkan "+b((o.promotions.current_page-1)*o.promotions.per_page+1)+" hingga "+b(Math.min(o.promotions.current_page*o.promotions.per_page,o.promotions.total))+" dari "+b(o.promotions.total)+" hasil ",1),d("div",Fe,[t(e(h),{variant:"outline",size:"sm",disabled:o.promotions.current_page===1,"as-child":""},{default:a(()=>[t(e(S),{href:e(k).url({query:{page:1,search:g.value||void 0,type:l.value!=="all"?l.value:void 0,sort_by:u.value[0]?.id,sort_order:u.value[0]?.desc?"desc":"asc"}}),class:T({"pointer-events-none opacity-50":o.promotions.current_page===1}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(ne),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"]),t(e(h),{variant:"outline",size:"sm",disabled:!o.promotions.links[0]?.url,"as-child":""},{default:a(()=>[t(e(S),{href:o.promotions.links[0]?.url||"#",class:T({"pointer-events-none opacity-50":!o.promotions.links[0]?.url}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(ie),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"]),t(e(h),{variant:"outline",size:"sm",disabled:!o.promotions.links[o.promotions.links.length-1]?.url,"as-child":""},{default:a(()=>[t(e(S),{href:o.promotions.links[o.promotions.links.length-1]?.url||"#",class:T({"pointer-events-none opacity-50":!o.promotions.links[o.promotions.links.length-1]?.url}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(de),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"]),t(e(h),{variant:"outline",size:"sm",disabled:o.promotions.current_page===o.promotions.last_page,"as-child":""},{default:a(()=>[t(e(S),{href:e(k).url({query:{page:o.promotions.last_page,search:g.value||void 0,type:l.value!=="all"?l.value:void 0,sort_by:u.value[0]?.id,sort_order:u.value[0]?.desc?"desc":"asc"}}),class:T({"pointer-events-none opacity-50":o.promotions.current_page===o.promotions.last_page}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(ue),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"])])])):H("",!0)]),t(O,{open:_.value.open,"onUpdate:open":r[2]||(r[2]=c=>_.value.open=c),title:"Hapus Promosi?",description:`Apakah Anda yakin ingin menghapus promosi '${_.value.promotion?.name}'? Tindakan ini tidak dapat dibatalkan.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:Z},null,8,["open","description"])]),_:1}))}});export{rt as default};
