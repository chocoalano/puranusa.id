import{i as f,_ as C,s as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-CAMiCJvC.js";import{u as S,a as E,_ as F}from"./useShippingLocation-DFMC5j1o.js";import{_ as m}from"./index-BYj0gYCc.js";import{d as B,o as G,Q as o,E as T,v as $,g as M,b as s,u as e,a1 as N,w as n,e as l,a4 as c,s as p,G as V,al as j,K,F as L}from"./vendor-ppbe-N6l.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-DiRTNO4J.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BAAtcDkZ.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DA3JUaxj.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CKDVFyjr.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-B3c6JmTR.js";import"./CardContent.vue_vue_type_script_setup_true_lang-vqvbNoPF.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DlqFqAdi.js";import"./CardHeader.vue_vue_type_script_setup_true_lang-_r3YWix0.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CuQE-qUU.js";import"./Input.vue_vue_type_script_setup_true_lang-DNj-uKug.js";import"./Label.vue_vue_type_script_setup_true_lang-DqlcMzBV.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CzK-upws.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CBeaEOLc.js";const A={class:"space-y-6 rounded-xl p-4 py-6"},D={class:"flex items-center justify-between"},oa=B({__name:"Create",setup(O){const{form:i,toPayload:g}=S("create"),{provinces:_,cities:h,loadingProvinces:y,loadingCities:b,fetchProvinces:v,fetchCities:k,resetCities:d}=E(),w=t=>{const a=Object.values(t).filter(r=>typeof r=="string"&&r.length>0);if(a.length===0){o.error("Gagal menyimpan data pelanggan. Silakan periksa kembali input form.");return}o.error(a[0]),a.length>1&&o.warning(`Terdapat ${a.length} kesalahan pada form.`)},u=(t,a)=>t instanceof Error&&t.message.trim()!==""?t.message:a;G(async()=>{try{await v()}catch(t){o.error(u(t,"Gagal memuat daftar provinsi."))}}),T(()=>i.province_id,async(t,a)=>{if(!t){d(),i.city_id=null;return}t!==a&&(i.city_id=null);try{await k(t)}catch(r){o.error(u(r,"Gagal memuat daftar kota/kabupaten.")),d()}});const x=()=>{i.transform(t=>g(t)).post(P.url(),{preserveScroll:!0,onSuccess:()=>{o.success("Pelanggan berhasil didaftarkan.")},onError:t=>{w(t)}})};return(t,a)=>(M(),$(L,null,[s(e(N),{title:"Tambah Pelanggan"}),s(C,null,{default:n(()=>[l("div",A,[l("div",D,[a[2]||(a[2]=l("div",null,[l("h1",{class:"text-3xl font-bold"},"Tambah Pelanggan"),l("p",{class:"mt-2 text-muted-foreground"}," Form registrasi pelanggan dengan data identitas, alamat, dan rekening yang lengkap. ")],-1)),s(e(c),{href:e(f).url()},{default:n(()=>[s(e(m),{variant:"outline"},{default:n(()=>[s(e(V),{class:"mr-2 h-4 w-4"}),a[1]||(a[1]=p(" Kembali ",-1))]),_:1})]),_:1},8,["href"])]),s(F,{form:e(i),"onUpdate:form":a[0]||(a[0]=r=>j(i)?i.value=r:null),mode:"create",provinces:e(_),cities:e(h),"loading-provinces":e(y),"loading-cities":e(b),onSubmit:x},{actions:n(({processing:r})=>[s(e(c),{href:e(f).url()},{default:n(()=>[s(e(m),{type:"button",variant:"outline"},{default:n(()=>[...a[3]||(a[3]=[p(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),s(e(m),{type:"submit",disabled:r},{default:n(()=>[p(K(r?"Menyimpan...":"Simpan Pelanggan"),1)]),_:2},1032,["disabled"])]),_:1},8,["form","provinces","cities","loading-provinces","loading-cities"])])]),_:1})],64))}});export{oa as default};
