import{i as _,_ as C,u as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-3Xwj2Srj.js";import{u as $,a as B,_ as F}from"./useShippingLocation-DUc2xcH1.js";import{_ as u}from"./index-BhPH699V.js";import{d as G,o as M,Q as n,E as N,v as V,g as j,b as i,u as e,a1 as D,w as o,e as l,a4 as b,s as p,G as K,al as L,K as T,F as A}from"./vendor-DfMbnFaR.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-Bqij1zEj.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BOYUcfDs.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-NxThyEhC.js";import"./index-DnSHhU6t.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrG-1awo.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CpOM3BUc.js";import"./CardContent.vue_vue_type_script_setup_true_lang-NxxB_dAy.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DW_PX5BW.js";import"./CardHeader.vue_vue_type_script_setup_true_lang-Kdg7L6IL.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-Cj4ck2dV.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-Cqsoy_WK.js";import"./Input.vue_vue_type_script_setup_true_lang-Bi8Aupzl.js";import"./Label.vue_vue_type_script_setup_true_lang-C_XGMl1H.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-VBwlv4qP.js";import"./Textarea.vue_vue_type_script_setup_true_lang-DZT34h2b.js";const O={class:"space-y-6 rounded-xl p-4 py-6"},Q={class:"flex items-center justify-between"},mt=G({__name:"Edit",props:{customer:{},sponsors:{}},setup(d){const m=d,{form:r,toPayload:h}=$("edit",{...m.customer}),{provinces:v,cities:y,loadingProvinces:w,loadingCities:k,fetchProvinces:x,fetchCities:c,resetCities:f}=B(),E=a=>{const t=Object.values(a).filter(s=>typeof s=="string"&&s.length>0);if(t.length===0){n.error("Gagal memperbarui data pelanggan. Silakan periksa kembali input form.");return}n.error(t[0]),t.length>1&&n.warning(`Terdapat ${t.length} kesalahan pada form.`)},g=(a,t)=>a instanceof Error&&a.message.trim()!==""?a.message:t;M(async()=>{try{await x(),r.province_id&&await c(r.province_id)}catch(a){n.error(g(a,"Gagal memuat data wilayah pelanggan."))}}),N(()=>r.province_id,async(a,t)=>{if(!a){f(),r.city_id=null;return}a!==t&&(r.city_id=null);try{await c(a)}catch(s){n.error(g(s,"Gagal memuat daftar kota/kabupaten.")),f()}});const S=()=>{r.transform(a=>h(a)).put(P.url(m.customer.id),{preserveScroll:!0,onSuccess:()=>{n.success("Data pelanggan berhasil diperbarui.")},onError:a=>{E(a)}})};return(a,t)=>(j(),V(A,null,[i(e(D),{title:`Edit ${d.customer.name}`},null,8,["title"]),i(C,null,{default:o(()=>[l("div",O,[l("div",Q,[t[2]||(t[2]=l("div",null,[l("h1",{class:"text-3xl font-bold"},"Edit Pelanggan"),l("p",{class:"mt-2 text-muted-foreground"}," Perbarui data identitas, alamat, rekening, dan catatan pelanggan secara terstruktur. ")],-1)),i(e(b),{href:e(_).url()},{default:o(()=>[i(e(u),{variant:"outline"},{default:o(()=>[i(e(K),{class:"mr-2 h-4 w-4"}),t[1]||(t[1]=p(" Kembali ",-1))]),_:1})]),_:1},8,["href"])]),i(F,{form:e(r),"onUpdate:form":t[0]||(t[0]=s=>L(r)?r.value=s:null),mode:"edit",sponsors:m.sponsors,provinces:e(v),cities:e(y),"loading-provinces":e(w),"loading-cities":e(k),onSubmit:S},{actions:o(({processing:s})=>[i(e(b),{href:e(_).url()},{default:o(()=>[i(e(u),{type:"button",variant:"outline"},{default:o(()=>[...t[3]||(t[3]=[p(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),i(e(u),{type:"submit",disabled:s},{default:o(()=>[p(T(s?"Menyimpan...":"Simpan Perubahan"),1)]),_:2},1032,["disabled"])]),_:1},8,["form","sponsors","provinces","cities","loading-provinces","loading-cities"])])]),_:1})],64))}});export{mt as default};
