import{d as ea,D as sa,r as _,p as B,E as ta,h as la,Q as C,c as k,g as u,w as t,b as s,e as l,u as a,a0 as na,a3 as K,G as ia,ad as oa,s as d,aH as da,v as m,t as w,J as $,K as r,aa as M,F as S,x as P,bv as U,M as ua,L as ra,aM as ma,ba as pa}from"./vendor-Bs9J5EGp.js";import{B as _a,C as D,_ as ca,D as fa}from"./AppLayout.vue_vue_type_script_setup_true_lang-oneAxjQP.js";import{_ as v,c as E}from"./index-x8bH5uI1.js";import{_ as j}from"./Label.vue_vue_type_script_setup_true_lang-B670ab_y.js";import{_ as ka,a as va,b as ba,c as ga,d as xa}from"./SelectValue.vue_vue_type_script_setup_true_lang-DdtG3tbZ.js";import{_ as N,a as A}from"./CardContent.vue_vue_type_script_setup_true_lang-BWHkBrZf.js";import{_ as F}from"./CardDescription.vue_vue_type_script_setup_true_lang-BVqqwHu4.js";import{_ as O}from"./CardHeader.vue_vue_type_script_setup_true_lang-CiO4by8s.js";import{_ as z}from"./CardTitle.vue_vue_type_script_setup_true_lang-DyZsrvsj.js";import{_ as G,a as H,b as I,c as J,d as Q,e as W,f as q,g as R,h as X}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-YmkSoH-n.js";import{_ as V}from"./index-D-h5IonM.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-rVF6Cf0K.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-CWDum3cA.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CbrHoqZt.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Ciactf0d.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-RkxObc6k.js";const ya={class:"rounded-xl p-4 space-y-6 py-6"},ha={class:"mb-6 flex items-center gap-4"},wa={class:"space-y-2"},$a={key:0,class:"flex items-center gap-2"},Ca={key:1,class:"text-muted-foreground"},Sa={class:"flex flex-col"},Pa={class:"flex items-center gap-2"},ja={class:"font-medium"},Va={class:"text-xs text-muted-foreground"},La={key:0,class:"text-sm text-destructive"},Ta={key:0,class:"rounded-lg bg-muted p-4 space-y-2"},Ba={class:"flex items-center gap-2 text-sm"},Ka={class:"flex items-center gap-2 text-sm"},Ma={class:"flex items-center gap-2 text-sm"},Ua={class:"space-y-2"},Da={class:"space-y-2"},Ea={key:0,class:"flex items-center gap-2"},Na={key:1},Aa={key:2,class:"text-muted-foreground"},Fa={class:"flex items-center gap-2"},Oa={key:0,class:"text-sm text-destructive"},za={class:"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-800 dark:bg-blue-950"},Ga={class:"flex items-start gap-3"},Ha={class:"flex items-center gap-4"},de=ea({__name:"Create",props:{customers:{},provinces:{},assignedKabupaten:{}},setup(L){const c=L,i=sa({customer_id:null,stockist_kabupaten_id:null,stockist_kabupaten_name:"",stockist_province_id:null,stockist_province_name:""}),b=_(!1),g=_(""),f=_(null),x=_([]),y=_(!1),h=_(!1),p=B(()=>c.customers.find(o=>o.id===i.customer_id)||null),Y=B(()=>{if(!g.value)return c.customers;const o=g.value.toLowerCase();return c.customers.filter(e=>e.name.toLowerCase().includes(o)||e.ewallet_id.toLowerCase().includes(o)||e.email.toLowerCase().includes(o))});ta(f,async o=>{if(!o){x.value=[],i.stockist_kabupaten_id=null,i.stockist_kabupaten_name="",i.stockist_province_id=null,i.stockist_province_name="";return}const e=c.provinces.find(n=>n.id===o);e&&(i.stockist_province_id=e.id,i.stockist_province_name=e.name),i.stockist_kabupaten_id=null,i.stockist_kabupaten_name="",y.value=!0;try{const n=await la.get(_a.url(),{params:{province_id:o}});x.value=n.data}catch{C.error("Gagal memuat daftar kota"),x.value=[]}finally{y.value=!1}});const Z=o=>{i.stockist_kabupaten_id=o.id,i.stockist_kabupaten_name=o.name,h.value=!1},T=o=>c.assignedKabupaten.includes(o),aa=()=>{i.post(fa.url(),{onSuccess:()=>{C.success("Stokist berhasil ditambahkan")},onError:o=>{const e=Object.values(o)[0];e&&C.error(e)}})};return(o,e)=>(u(),k(ca,null,{default:t(()=>[s(a(na),{title:"Tambah Stokist"}),l("div",ya,[l("div",ha,[s(a(K),{href:a(D).url()},{default:t(()=>[s(a(v),{variant:"outline",size:"icon"},{default:t(()=>[s(a(ia),{class:"h-4 w-4"})]),_:1})]),_:1},8,["href"]),e[4]||(e[4]=l("div",null,[l("h1",{class:"text-3xl font-bold tracking-tight"},"Tambah Stokist"),l("p",{class:"text-muted-foreground"}," Pilih pelanggan dan tentukan kabupaten/kota untuk dijadikan stokist ")],-1))]),l("form",{onSubmit:oa(aa,["prevent"]),class:"space-y-6 max-w-2xl"},[s(a(N),null,{default:t(()=>[s(a(O),null,{default:t(()=>[s(a(z),{class:"flex items-center gap-2"},{default:t(()=>[s(a(da),{class:"h-5 w-5"}),e[5]||(e[5]=d(" Pilih Pelanggan ",-1))]),_:1}),s(a(F),null,{default:t(()=>[...e[6]||(e[6]=[d(" Pilih pelanggan aktif yang akan dijadikan stokist. Hanya pelanggan yang belum menjadi stokist yang ditampilkan. ",-1)])]),_:1})]),_:1}),s(a(A),{class:"space-y-4"},{default:t(()=>[l("div",wa,[s(a(j),null,{default:t(()=>[...e[7]||(e[7]=[d("Pelanggan ",-1),l("span",{class:"text-destructive"},"*",-1)])]),_:1}),s(a(G),{open:b.value,"onUpdate:open":e[1]||(e[1]=n=>b.value=n)},{default:t(()=>[s(a(H),{"as-child":""},{default:t(()=>[s(a(v),{variant:"outline",role:"combobox","aria-expanded":b.value,class:$(["w-full justify-between",{"border-destructive":a(i).errors.customer_id}])},{default:t(()=>[p.value?(u(),m("span",$a,[s(a(V),{variant:"secondary",class:"font-mono"},{default:t(()=>[d(r(p.value.ewallet_id),1)]),_:1}),d(" "+r(p.value.name),1)])):(u(),m("span",Ca,"Pilih pelanggan...")),s(a(M),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:1},8,["aria-expanded","class"])]),_:1}),s(a(I),{class:"w-[400px] p-0"},{default:t(()=>[s(a(J),null,{default:t(()=>[s(a(Q),{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=n=>g.value=n),placeholder:"Cari nama, ewallet ID, atau email..."},null,8,["modelValue"]),s(a(W),null,{default:t(()=>[s(a(q),null,{default:t(()=>[...e[8]||(e[8]=[d("Tidak ada pelanggan ditemukan.",-1)])]),_:1}),s(a(R),null,{default:t(()=>[(u(!0),m(S,null,P(Y.value,n=>(u(),k(a(X),{key:n.id,value:n.name,onSelect:()=>{a(i).customer_id=n.id,b.value=!1},class:"flex items-center gap-2"},{default:t(()=>[s(a(U),{class:$(a(E)("mr-2 h-4 w-4",a(i).customer_id===n.id?"opacity-100":"opacity-0"))},null,8,["class"]),l("div",Sa,[l("div",Pa,[s(a(V),{variant:"outline",class:"font-mono text-xs"},{default:t(()=>[d(r(n.ewallet_id),1)]),_:2},1024),l("span",ja,r(n.name),1)]),l("span",Va,r(n.email),1)])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(i).errors.customer_id?(u(),m("p",La,r(a(i).errors.customer_id),1)):w("",!0),e[9]||(e[9]=l("p",{class:"text-sm text-muted-foreground"}," Pilih pelanggan yang akan bertanggung jawab sebagai stokist di wilayah tertentu. ",-1))]),p.value?(u(),m("div",Ta,[l("div",Ba,[e[10]||(e[10]=l("span",{class:"font-medium"},"Nama:",-1)),l("span",null,r(p.value.name),1)]),l("div",Ka,[e[11]||(e[11]=l("span",{class:"font-medium"},"Email:",-1)),l("span",null,r(p.value.email),1)]),l("div",Ma,[e[12]||(e[12]=l("span",{class:"font-medium"},"Telepon:",-1)),l("span",null,r(p.value.phone||"-"),1)])])):w("",!0)]),_:1})]),_:1}),s(a(N),null,{default:t(()=>[s(a(O),null,{default:t(()=>[s(a(z),{class:"flex items-center gap-2"},{default:t(()=>[s(a(ua),{class:"h-5 w-5"}),e[13]||(e[13]=d(" Wilayah Stokist ",-1))]),_:1}),s(a(F),null,{default:t(()=>[...e[14]||(e[14]=[d(" Tentukan kota yang akan dijadikan wilayah stokist. Setiap kota hanya dapat memiliki 1 stokist. ",-1)])]),_:1})]),_:1}),s(a(A),{class:"space-y-4"},{default:t(()=>[l("div",Ua,[s(a(j),null,{default:t(()=>[...e[15]||(e[15]=[d("Provinsi ",-1),l("span",{class:"text-destructive"},"*",-1)])]),_:1}),s(a(ka),{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value=n)},{default:t(()=>[s(a(va),null,{default:t(()=>[s(a(ba),{placeholder:"Pilih provinsi..."})]),_:1}),s(a(ga),null,{default:t(()=>[(u(!0),m(S,null,P(L.provinces,n=>(u(),k(a(xa),{key:n.id,value:n.id},{default:t(()=>[d(r(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e[16]||(e[16]=l("p",{class:"text-sm text-muted-foreground"}," Pilih provinsi terlebih dahulu untuk menampilkan daftar kabupaten/kota. ",-1))]),l("div",Da,[s(a(j),null,{default:t(()=>[...e[17]||(e[17]=[d("Kota ",-1),l("span",{class:"text-destructive"},"*",-1)])]),_:1}),s(a(G),{open:h.value,"onUpdate:open":e[3]||(e[3]=n=>h.value=n)},{default:t(()=>[s(a(H),{"as-child":""},{default:t(()=>[s(a(v),{variant:"outline",role:"combobox","aria-expanded":h.value,class:$(["w-full justify-between",{"border-destructive":a(i).errors.stockist_kabupaten_id}]),disabled:!f.value||y.value},{default:t(()=>[y.value?(u(),m("span",Ea,[s(a(ra),{class:"h-4 w-4 animate-spin"}),e[18]||(e[18]=d(" Memuat... ",-1))])):a(i).stockist_kabupaten_name?(u(),m("span",Na,r(a(i).stockist_kabupaten_name),1)):(u(),m("span",Aa,r(f.value?"Pilih kota...":"Pilih provinsi terlebih dahulu"),1)),s(a(M),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:1},8,["aria-expanded","class","disabled"])]),_:1}),s(a(I),{class:"w-[400px] p-0"},{default:t(()=>[s(a(J),null,{default:t(()=>[s(a(Q),{placeholder:"Cari kota..."}),s(a(W),null,{default:t(()=>[s(a(q),null,{default:t(()=>[...e[19]||(e[19]=[d("Tidak ada kota ditemukan.",-1)])]),_:1}),s(a(R),null,{default:t(()=>[(u(!0),m(S,null,P(x.value,n=>(u(),k(a(X),{key:n.id,value:n.name,disabled:T(n.id),onSelect:()=>Z(n),class:"flex items-center justify-between"},{default:t(()=>[l("div",Fa,[s(a(U),{class:$(a(E)("mr-2 h-4 w-4",a(i).stockist_kabupaten_id===n.id?"opacity-100":"opacity-0"))},null,8,["class"]),l("span",null,r(n.name),1)]),T(n.id)?(u(),k(a(V),{key:0,variant:"secondary",class:"text-xs"},{default:t(()=>[...e[20]||(e[20]=[d(" Sudah ada stokist ",-1)])]),_:1})):w("",!0)]),_:2},1032,["value","disabled","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(i).errors.stockist_kabupaten_id?(u(),m("p",Oa,r(a(i).errors.stockist_kabupaten_id),1)):w("",!0),e[21]||(e[21]=l("p",{class:"text-sm text-muted-foreground"}," Kota yang sudah memiliki stokist akan ditandai dan tidak dapat dipilih. ",-1))])]),_:1})]),_:1}),l("div",za,[l("div",Ga,[s(a(ma),{class:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),e[22]||(e[22]=l("div",{class:"text-sm text-blue-700 dark:text-blue-300"},[l("p",{class:"font-medium"},"Informasi"),l("p",{class:"mt-1"}," Setelah pelanggan dijadikan stokist, mereka akan bertanggung jawab atas distribusi produk di wilayah kota yang ditentukan. Setiap kota hanya dapat memiliki 1 stokist aktif. ")],-1))])]),l("div",Ha,[s(a(v),{type:"submit",disabled:a(i).processing},{default:t(()=>[s(a(pa),{class:"mr-2 h-4 w-4"}),d(" "+r(a(i).processing?"Menyimpan...":"Simpan Stokist"),1)]),_:1},8,["disabled"]),s(a(K),{href:a(D).url()},{default:t(()=>[s(a(v),{variant:"outline",type:"button"},{default:t(()=>[...e[23]||(e[23]=[d("Batal",-1)])]),_:1})]),_:1},8,["href"])])],32)])]),_:1}))}});export{de as default};
