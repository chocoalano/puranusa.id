import{d as G,r as _,am as q,p as L,q as O,c,g as n,w as o,b as r,e as u,u as e,a1 as Q,t as B,a4 as A,s as Y,Y as Z,Z as J,v as g,F as h,x,y as N,n as t,bj as I,ao as w,M as W,$ as X,z as ee,j as M,Q as j,B as te}from"./vendor-DYgHfk08.js";import{G as ae,D as E,_ as se,H as le,I as re}from"./AppLayout.vue_vue_type_script_setup_true_lang-DRH_ebPA.js";import{_ as m}from"./index-DBsPyq8S.js";import{_ as ne}from"./Input.vue_vue_type_script_setup_true_lang-DkLAfZys.js";import{_ as oe}from"./index-C9h8PSdL.js";import{_ as ie,a as ue,b as S,c as ce,d as de,e as H}from"./TableHeader.vue_vue_type_script_setup_true_lang-YFJtZzp6.js";import{_ as pe}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-c-fNq-Gn.js";import{_ as me}from"./Pagination.vue_vue_type_script_setup_true_lang-CB_rUuml.js";import{u as fe}from"./usePermissions-QR2nm5rZ.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-BuaobLrR.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Bql-RK5d.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Wm0IkLbg.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DRgKjkJL.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-D72m4PHj.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-1hBkLUKH.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-DYYIQ-He.js";const _e={class:"rounded-xl p-4 space-y-6 py-6"},ke={class:"mb-6 flex items-center justify-between"},ve={class:"mb-4 flex items-center gap-4"},ge={class:"relative flex-1"},he={class:"rounded-md border"},xe={class:"flex flex-col items-center gap-2 text-muted-foreground"},Re=G({__name:"Index",props:{stockists:{},filters:{},provinces:{}},setup(V){const{isSuperAdmin:$,isAdmin:C}=fe(),d=V,k=_(d.filters.search||""),v=_(d.filters.sort_by||"created_at"),f=_(d.filters.sort_order||"desc"),K=_(d.filters.per_page||10),R=a=>{M.delete(re.url(a),{preserveScroll:!0,onSuccess:()=>{j.success("Status stokist berhasil dihapus")},onError:()=>{j.error("Gagal menghapus status stokist")}})},p=_({open:!1,data:null}),T=a=>{p.value={open:!0,data:a}},D=q(()=>{M.get(E.url(),{search:k.value,sort_by:v.value,sort_order:f.value,per_page:K.value},{preserveState:!0,preserveScroll:!0})},300),b=a=>{v.value===a?f.value=f.value==="asc"?"desc":"asc":(v.value=a,f.value="asc"),D()},U=()=>{p.value.data&&R(p.value.data.id)},z=a=>{switch(a){case 1:return{label:"Aktif",variant:"default"};case 2:return{label:"Pasif",variant:"secondary"};case 3:return{label:"Prospek",variant:"outline"};default:return{label:"Unknown",variant:"outline"}}},P=[{id:"index",header:()=>t("div",{class:"text-left"},"No"),cell:({row:a})=>{const s=a.index+1+(d.stockists.current_page-1)*d.stockists.per_page;return t("div",{class:"text-left"},s.toString())}},{accessorKey:"ewallet_id",header:()=>t(m,{variant:"ghost",onClick:()=>b("ewallet_id")},()=>["Ewallet ID",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>t("div",{class:"font-mono text-sm"},a.getValue("ewallet_id"))},{accessorKey:"name",header:()=>t(m,{variant:"ghost",onClick:()=>b("name")},()=>["Nama Stokist",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>t("div",{class:"flex items-center gap-2"},[t(I,{class:"h-4 w-4 text-primary"}),t("span",{},a.getValue("name"))])},{accessorKey:"email",header:"Email",cell:({row:a})=>t("div",{class:"text-sm"},a.getValue("email"))},{accessorKey:"phone",header:"Telepon",cell:({row:a})=>{const s=a.getValue("phone");return t("div",{class:"text-sm"},s||"-")}},{accessorKey:"stockist_kabupaten_name",header:()=>t(m,{variant:"ghost",onClick:()=>b("stockist_kabupaten_name")},()=>["Kabupaten/Kota",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>{const s=a.getValue("stockist_kabupaten_name");return s?t("div",{class:"flex items-center gap-2"},[t(W,{class:"h-4 w-4 text-muted-foreground"}),t("span",{},s)]):t("div",{class:"text-muted-foreground"},"-")}},{accessorKey:"status",header:"Status",cell:({row:a})=>{const s=a.getValue("status"),{label:l,variant:i}=z(s);return t(oe,{variant:i},()=>l)}},{id:"actions",header:()=>t("div",{class:"text-center"},"Aksi"),cell:({row:a})=>{const s=a.original,l=[];return($.value||C.value)&&l.push(t(A,{href:le.url(s.id)},()=>t(m,{variant:"ghost",size:"icon",title:"Edit Kabupaten"},()=>t(X,{class:"h-4 w-4"}))),t(m,{variant:"ghost",size:"icon",onClick:()=>T(s),title:"Hapus Status Stokist"},()=>t(ee,{class:"h-4 w-4 text-destructive"}))),t("div",{class:"flex items-center justify-center gap-2"},l)}}],F=L(()=>d.stockists.data),y=O({get data(){return F.value},columns:P,getCoreRowModel:te(),manualSorting:!0,manualPagination:!0});return(a,s)=>(n(),c(se,null,{default:o(()=>[r(e(Q),{title:"Kelola Stokist"}),u("div",_e,[u("div",ke,[s[3]||(s[3]=u("div",null,[u("h1",{class:"text-3xl font-bold tracking-tight"},"Kelola Stokist"),u("p",{class:"text-muted-foreground"}," Kelola data stokist berdasarkan kabupaten/kota. Setiap kabupaten/kota hanya dapat memiliki 1 stokist. ")],-1)),e($)||e(C)?(n(),c(e(A),{key:0,href:e(ae).url()},{default:o(()=>[r(e(m),null,{default:o(()=>[r(e(Z),{class:"mr-2 h-4 w-4"}),s[2]||(s[2]=Y(" Tambah Stokist ",-1))]),_:1})]),_:1},8,["href"])):B("",!0)]),u("div",ve,[u("div",ge,[r(e(J),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),r(e(ne),{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=l=>k.value=l),placeholder:"Cari nama, email, telepon, ewallet ID, atau kabupaten...",class:"pl-10",onInput:e(D)},null,8,["modelValue","onInput"])])]),u("div",he,[r(e(ie),null,{default:o(()=>[r(e(ue),null,{default:o(()=>[(n(!0),g(h,null,x(e(y).getHeaderGroups(),l=>(n(),c(e(S),{key:l.id},{default:o(()=>[(n(!0),g(h,null,x(l.headers,i=>(n(),c(e(ce),{key:i.id},{default:o(()=>[i.isPlaceholder?B("",!0):(n(),c(e(N),{key:0,render:i.column.columnDef.header,props:i.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),r(e(de),null,{default:o(()=>[e(y).getRowModel().rows?.length?(n(!0),g(h,{key:0},x(e(y).getRowModel().rows,l=>(n(),c(e(S),{key:l.id},{default:o(()=>[(n(!0),g(h,null,x(l.getVisibleCells(),i=>(n(),c(e(H),{key:i.id},{default:o(()=>[r(e(N),{render:i.column.columnDef.cell,props:i.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(n(),c(e(S),{key:1},{default:o(()=>[r(e(H),{colspan:P.length,class:"h-24 text-center"},{default:o(()=>[u("div",xe,[r(e(I),{class:"h-8 w-8"}),s[4]||(s[4]=u("span",null,"Belum ada stokist terdaftar.",-1))])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),r(me,{data:V.stockists,url:e(E).url(),filters:{search:k.value,sort_by:v.value,sort_order:f.value,per_page:K.value}},null,8,["data","url","filters"])]),r(pe,{open:p.value.open,"onUpdate:open":s[1]||(s[1]=l=>p.value.open=l),title:"Hapus Status Stokist?",description:`Apakah Anda yakin ingin menghapus status stokist dari ${p.value.data?.name}? Pelanggan ini akan tetap ada namun tidak lagi menjadi stokist untuk ${p.value.data?.stockist_kabupaten_name}.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:U},null,8,["open","description"])]),_:1}))}});export{Re as default};
