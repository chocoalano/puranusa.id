import{_ as Q,D as Z,E as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-B4Q7M_yc.js";import{d as q,v as h,g as u,b as t,u as e,w as s,s as c,cv as te,e as d,J as k,cw as ae,aK as le,as as se,r as x,q as re,D as U,j as S,$ as ne,c as _,t as P,Y as ie,a8 as oe,F as y,x as b,y as W,n as i,al as de,bt as ue,X as ce,aE as me,A as fe,B as pe}from"./vendor-zBKKL15G.js";import{_ as z}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-IDKWa8Pc.js";import{_ as we}from"./Pagination.vue_vue_type_script_setup_true_lang-BvpV56IR.js";import{_ as D,a as V}from"./CardContent.vue_vue_type_script_setup_true_lang-DMEXwOYw.js";import{_ as j}from"./CardHeader.vue_vue_type_script_setup_true_lang-DAmVrl_s.js";import{_ as R}from"./CardTitle.vue_vue_type_script_setup_true_lang-BNxuRtlf.js";import{_ as ge}from"./index-Bgaf6fPq.js";import{_ as F,v as I}from"./index-D-ZDeNW7.js";import{_ as _e,a as ve,b as xe}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CJL3Y8wp.js";import{_ as he}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-E3LrliJt.js";import{_ as ye}from"./Input.vue_vue_type_script_setup_true_lang-B8h33Tay.js";import{_ as be,a as ke,b as $e,c as Ce,d as T}from"./SelectValue.vue_vue_type_script_setup_true_lang-DhBu_Vgs.js";import{_ as Se,a as De,b as M,c as Ve,d as je,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-B4pjwwGU.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-kKofCkkG.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-CzoF4v2h.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-5qqdoF-N.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DSZTc71l.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-ZdsPM9bJ.js";const Re={class:"grid gap-4 md:grid-cols-4"},Fe={class:"text-2xl font-bold"},Te={class:"text-2xl font-bold"},Ie={class:"text-2xl font-bold"},Me={class:"text-2xl font-bold"},Ae=q({__name:"WithdrawalStatistics",props:{statistics:{}},setup(o){const f=p=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(p);return(p,r)=>(u(),h("div",Re,[t(e(D),null,{default:s(()=>[t(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(R),{class:"text-sm font-medium"},{default:s(()=>[...r[0]||(r[0]=[c("Pending",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[d("div",Fe,k(o.statistics.total_pending),1),r[1]||(r[1]=d("p",{class:"text-xs text-muted-foreground"},"Menunggu persetujuan",-1))]),_:1})]),_:1}),t(e(D),null,{default:s(()=>[t(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(R),{class:"text-sm font-medium"},{default:s(()=>[...r[2]||(r[2]=[c("Disetujui",-1)])]),_:1}),t(e(ae),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[d("div",Te,k(o.statistics.total_completed),1),r[3]||(r[3]=d("p",{class:"text-xs text-muted-foreground"},"Withdrawal selesai",-1))]),_:1})]),_:1}),t(e(D),null,{default:s(()=>[t(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(R),{class:"text-sm font-medium"},{default:s(()=>[...r[4]||(r[4]=[c("Ditolak",-1)])]),_:1}),t(e(le),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[d("div",Ie,k(o.statistics.total_failed),1),r[5]||(r[5]=d("p",{class:"text-xs text-muted-foreground"},"Withdrawal gagal",-1))]),_:1})]),_:1}),t(e(D),null,{default:s(()=>[t(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(R),{class:"text-sm font-medium"},{default:s(()=>[...r[6]||(r[6]=[c("Total Nominal",-1)])]),_:1}),t(e(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:s(()=>[d("div",Me,k(f(o.statistics.total_amount)),1),r[7]||(r[7]=d("p",{class:"text-xs text-muted-foreground"},"Total withdrawal berhasil",-1))]),_:1})]),_:1})]))}}),Ke={class:"rounded-xl p-4 space-y-6 py-6"},Be={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Ne={class:"flex flex-1 gap-4"},Ue={class:"relative flex-1 max-w-sm"},Pe={class:"rounded-md border"},it=q({__name:"Index",props:{withdrawals:{},statistics:{},filters:{}},setup(o){const f=o,p=x(f.filters.search||""),r=x(f.filters.status||"all"),v=x([{id:f.filters.sort_by||"created_at",desc:f.filters.sort_order==="desc"}]),A=x([]),K=x({}),w=x({open:!1,withdrawal:null}),g=x({open:!1,withdrawal:null}),$=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),H=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),J=a=>({pending:"secondary",completed:"default",failed:"destructive"})[a]||"secondary",L=a=>{if(!a)return null;try{return JSON.parse(a)}catch{return null}},X=a=>{w.value={open:!0,withdrawal:a}},O=()=>{w.value.withdrawal&&S.post(Z.url(w.value.withdrawal.id),{},{preserveScroll:!0,onSuccess:()=>{w.value={open:!1,withdrawal:null}}})},Y=a=>{g.value={open:!0,withdrawal:a}},G=()=>{g.value.withdrawal&&S.post(ee.url(g.value.withdrawal.id),{},{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,withdrawal:null}}})},B=[{id:"index",header:()=>i("div",{class:"w-12"},"No"),cell:({row:a})=>{const l=a.index+1+(f.withdrawals.current_page-1)*f.withdrawals.per_page;return i("div",{class:"font-medium"},l)}},{accessorKey:"customer.name",header:({column:a})=>i(F,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Pelanggan",i(de,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>{const l=a.original.customer;return i("div",[i("div",{class:"font-medium"},l.name),i("div",{class:"text-xs text-muted-foreground"},l.email)])}},{accessorKey:"customer.ewallet_saldo",header:()=>"Saldo",cell:({row:a})=>i("div",$(a.original.customer.ewallet_saldo))},{accessorKey:"amount",header:()=>"Penarikan",cell:({row:a})=>i("div",{class:"font-bold text-red-600"},$(a.getValue("amount")))},{accessorKey:"notes",header:()=>"Rekening Tujuan",cell:({row:a})=>{const l=L(a.getValue("notes"));return l?i("div",[i("div",{class:"text-xs font-medium"},`${l.bank_name} - ${l.bank_account}`),i("div",{class:"text-xs text-muted-foreground"},l.bank_holder)]):i("div",{class:"text-xs text-muted-foreground"},"-")}},{accessorKey:"transaction_ref",header:()=>"Referensi",cell:({row:a})=>i("div",{class:"font-mono text-xs"},a.getValue("transaction_ref"))},{accessorKey:"status",header:()=>"Status",cell:({row:a})=>{const l=a.getValue("status");return i(ge,{variant:J(l)},()=>l)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:a})=>i("div",{class:"text-sm"},H(a.getValue("created_at")))},{id:"actions",header:()=>i("div",{class:"text-right"},"Aksi"),cell:({row:a})=>{const l=a.original;if(l.status!=="pending")return null;const n=l.customer.ewallet_saldo<l.amount;return i("div",{class:"flex justify-end gap-2"},[i(F,{size:"sm",onClick:()=>X(l),disabled:n},()=>[i(ue,{class:"mr-1 h-4 w-4"}),"Setujui"]),i(F,{size:"sm",variant:"destructive",onClick:()=>Y(l)},()=>[i(ce,{class:"mr-1 h-4 w-4"}),"Tolak"])])}}],C=re({get data(){return f.withdrawals.data},columns:B,getCoreRowModel:pe(),getSortedRowModel:fe(),getFilteredRowModel:me(),onSortingChange:a=>I(a,v),onColumnFiltersChange:a=>I(a,A),onColumnVisibilityChange:a=>I(a,K),state:{get sorting(){return v.value},get columnFilters(){return A.value},get columnVisibility(){return K.value}},manualSorting:!0});U(v,a=>{a.length>0&&S.get("/admin/withdrawals",{search:p.value||void 0,status:r.value!=="all"?r.value:void 0,sort_by:a[0].id,sort_order:a[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let N;return U([p,r],()=>{clearTimeout(N),N=setTimeout(()=>{S.get("/admin/withdrawals",{search:p.value||void 0,status:r.value!=="all"?r.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(a,l)=>(u(),h(y,null,[t(e(ne),{title:"Permintaan Withdrawal"}),t(Q,null,{default:s(()=>[d("div",Ke,[l[10]||(l[10]=d("div",null,[d("h2",{class:"text-3xl font-bold tracking-tight"},"Permintaan Withdrawal"),d("p",{class:"text-muted-foreground"},"Kelola permintaan penarikan saldo dari pelanggan")],-1)),t(Ae,{statistics:o.statistics},null,8,["statistics"]),d("div",Be,[d("div",Ne,[d("div",Ue,[t(e(ie),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(ye),{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=n=>p.value=n),placeholder:"Cari pelanggan atau referensi...",class:"pl-9"},null,8,["modelValue"])]),t(e(be),{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=n=>r.value=n)},{default:s(()=>[t(e(ke),{class:"w-[180px]"},{default:s(()=>[t(e($e),{placeholder:"Semua Status"})]),_:1}),t(e(Ce),null,{default:s(()=>[t(e(T),{value:"all"},{default:s(()=>[...l[4]||(l[4]=[c("Semua Status",-1)])]),_:1}),t(e(T),{value:"pending"},{default:s(()=>[...l[5]||(l[5]=[c("Pending",-1)])]),_:1}),t(e(T),{value:"completed"},{default:s(()=>[...l[6]||(l[6]=[c("Completed",-1)])]),_:1}),t(e(T),{value:"failed"},{default:s(()=>[...l[7]||(l[7]=[c("Failed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(_e),null,{default:s(()=>[t(e(ve),{"as-child":""},{default:s(()=>[t(e(F),{variant:"outline",class:"ml-auto"},{default:s(()=>[l[8]||(l[8]=c(" Kolom ",-1)),t(e(oe),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(xe),{align:"end"},{default:s(()=>[(u(!0),h(y,null,b(e(C).getAllColumns().filter(n=>n.getCanHide()),n=>(u(),_(e(he),{key:n.id,class:"capitalize","model-value":n.getIsVisible(),"onUpdate:modelValue":m=>{n.toggleVisibility(!!m)}},{default:s(()=>[c(k(n.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),d("div",Pe,[t(e(Se),null,{default:s(()=>[t(e(De),null,{default:s(()=>[(u(!0),h(y,null,b(e(C).getHeaderGroups(),n=>(u(),_(e(M),{key:n.id},{default:s(()=>[(u(!0),h(y,null,b(n.headers,m=>(u(),_(e(Ve),{key:m.id},{default:s(()=>[m.isPlaceholder?P("",!0):(u(),_(e(W),{key:0,render:m.column.columnDef.header,props:m.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(je),null,{default:s(()=>[e(C).getRowModel().rows?.length?(u(!0),h(y,{key:0},b(e(C).getRowModel().rows,n=>(u(),_(e(M),{key:n.id},{default:s(()=>[(u(!0),h(y,null,b(n.getVisibleCells(),m=>(u(),_(e(E),{key:m.id},{default:s(()=>[t(e(W),{render:m.column.columnDef.cell,props:m.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(u(),_(e(M),{key:1},{default:s(()=>[t(e(E),{colspan:B.length,class:"h-24 text-center"},{default:s(()=>[...l[9]||(l[9]=[c(" Tidak ada permintaan withdrawal. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),o.withdrawals.last_page>1?(u(),_(we,{key:0,data:{current_page:o.withdrawals.current_page,last_page:o.withdrawals.last_page,per_page:o.withdrawals.per_page,from:(o.withdrawals.current_page-1)*o.withdrawals.per_page+1,to:Math.min(o.withdrawals.current_page*o.withdrawals.per_page,o.withdrawals.total),total:o.withdrawals.total},url:"/admin/withdrawals",filters:{search:p.value||void 0,status:r.value!=="all"?r.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"}},null,8,["data","filters"])):P("",!0)]),t(z,{open:w.value.open,"onUpdate:open":l[2]||(l[2]=n=>w.value.open=n),title:"Setujui Withdrawal?",description:`Apakah Anda yakin ingin menyetujui permintaan withdrawal sebesar ${w.value.withdrawal?$(w.value.withdrawal.amount):""} untuk ${w.value.withdrawal?.customer.name}? Dana akan ditransfer via Midtrans ke rekening tujuan.`,"confirm-text":"Setujui & Transfer","cancel-text":"Batal",onConfirm:O},null,8,["open","description"]),t(z,{open:g.value.open,"onUpdate:open":l[3]||(l[3]=n=>g.value.open=n),title:"Tolak Withdrawal?",description:`Apakah Anda yakin ingin menolak permintaan withdrawal sebesar ${g.value.withdrawal?$(g.value.withdrawal.amount):""} dari ${g.value.withdrawal?.customer.name}?`,"confirm-text":"Tolak","cancel-text":"Batal",variant:"destructive",onConfirm:G},null,8,["open","description"])]),_:1})],64))}});export{it as default};
