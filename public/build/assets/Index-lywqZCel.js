import{F as T,G as ce,_ as me,I as fe,J as ve,K as ge,L as pe}from"./AppLayout.vue_vue_type_script_setup_true_lang-B4Q7M_yc.js";import{_ as F}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-IDKWa8Pc.js";import{_ as _e}from"./Pagination.vue_vue_type_script_setup_true_lang-BvpV56IR.js";import{_ as J}from"./index-Bgaf6fPq.js";import{_ as h,v as M}from"./index-D-ZDeNW7.js";import{_ as j,a as K}from"./CardContent.vue_vue_type_script_setup_true_lang-DMEXwOYw.js";import{_ as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-DAmVrl_s.js";import{_ as P}from"./CardTitle.vue_vue_type_script_setup_true_lang-BNxuRtlf.js";import{_ as be,a as xe,b as ye}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CJL3Y8wp.js";import{_ as he}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-E3LrliJt.js";import{_ as we}from"./Input.vue_vue_type_script_setup_true_lang-B8h33Tay.js";import{_ as W,a as q,b as G,c as O,d as p}from"./SelectValue.vue_vue_type_script_setup_true_lang-DhBu_Vgs.js";import{_ as ke,a as Se,b as A,c as Ce,d as $e,e as X}from"./TableHeader.vue_vue_type_script_setup_true_lang-B4pjwwGU.js";import{d as Re,r as m,p as Y,q as De,D as Q,j as w,c as x,g as i,w as a,b as l,e as r,u as e,$ as Be,v as k,t as Z,s as u,W as Ie,cR as Ve,J as _,as as Le,F as D,x as B,ao as ee,Y as Te,cS as Me,a8 as Fe,y as te,n as o,cT as je,cw as Ke,aK as Ue,al as Pe,an as Ae,z as ze,aE as He,A as Ne,B as Ee}from"./vendor-zBKKL15G.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-kKofCkkG.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-CzoF4v2h.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-5qqdoF-N.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DSZTc71l.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-ZdsPM9bJ.js";const Je={class:"rounded-xl p-4 space-y-6 py-6"},We={class:"flex items-center justify-between"},qe={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},Ge={class:"text-2xl font-bold"},Oe={class:"text-xs text-muted-foreground"},Xe={class:"text-2xl font-bold"},Ye={class:"text-xs text-muted-foreground"},Qe={class:"grid grid-cols-5 gap-2 text-sm"},Ze={class:"font-semibold text-xs text-muted-foreground"},et={class:"font-bold"},tt={class:"text-xs text-muted-foreground"},st={key:0,class:"flex items-center justify-between rounded-lg border bg-muted/50 p-4"},lt={class:"text-sm font-medium"},at={class:"flex items-center gap-4"},nt={class:"relative flex-1"},ot={class:"rounded-md border"},Rt=Re({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(c){const f=c,se=[{title:"Bonus Matching",href:T.url()}],S=m(f.filters.search||""),v=m(f.filters.status?.toString()||"all"),g=m(f.filters.level?.toString()||"all"),y=m([{id:f.filters.sort_by,desc:f.filters.sort_order==="desc"}]),z=m([]),H=m({}),I=m({}),C=m({open:!1,bonus:null}),b=m({open:!1,bonus:null}),V=m({open:!1}),le=Y(()=>Object.keys(I.value).map(s=>f.bonuses.data[parseInt(s)]).filter(Boolean)),$=Y(()=>le.value.filter(s=>s.status===0)),R=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),ae=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=s=>{C.value={open:!0,bonus:s}},oe=()=>{C.value.bonus&&w.delete(fe.url(C.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{C.value={open:!1,bonus:null}}})},re=s=>{b.value={open:!0,bonus:s}},ue=()=>{b.value.bonus&&w.post(ve.url(b.value.bonus.id),{},{preserveScroll:!0,onSuccess:()=>{b.value={open:!1,bonus:null},I.value={}}})},ie=()=>{$.value.length&&(V.value.open=!0)},de=()=>{const s=$.value.map(t=>t.id);w.post(ge.url(),{bonus_ids:s},{preserveScroll:!0,onSuccess:()=>{I.value={},V.value.open=!1}})},N=[{id:"select",header:({table:s})=>o("input",{type:"checkbox",checked:s.getIsAllPageRowsSelected(),indeterminate:s.getIsSomePageRowsSelected(),onChange:s.getToggleAllPageRowsSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),cell:({row:s})=>o("input",{type:"checkbox",checked:s.getIsSelected(),disabled:!s.getCanSelect(),onChange:s.getToggleSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),enableSorting:!1},{id:"index",header:()=>o("div",{class:"w-12"},"No"),cell:({row:s})=>{const t=s.index+1+(f.bonuses.current_page-1)*f.bonuses.per_page;return o("div",{class:"font-medium"},t)}},{accessorKey:"member_name",header:()=>"Member (Penerima)",cell:({row:s})=>o("div",[o("div",{class:"font-medium"},s.original.member_name),o("div",{class:"text-xs text-muted-foreground"},s.original.member_ewallet_id)])},{accessorKey:"from_member_name",header:()=>"Dari Member",cell:({row:s})=>o("div",[o("div",{class:"font-medium"},s.original.from_member_name),o("div",{class:"text-xs text-muted-foreground"},s.original.from_member_ewallet_id)])},{accessorKey:"level",header:()=>"Level",cell:({row:s})=>o(J,{variant:"outline",class:"gap-1"},()=>[o(je,{class:"h-3 w-3"}),`Level ${s.original.level}`])},{accessorKey:"amount",header:()=>o("div",{class:"text-right"},"Jumlah"),cell:({row:s})=>o("div",{class:"text-right font-medium"},R(s.original.amount))},{accessorKey:"status",header:()=>"Status",cell:({row:s})=>{const t=s.original.status;return o(J,{variant:t===1?"default":"secondary",class:"gap-1"},()=>[o(t===1?Ke:Ue,{class:"h-3 w-3"}),s.original.status_text])}},{accessorKey:"created_at",header:({column:s})=>o(h,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",o(Pe,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>ae(s.getValue("created_at"))},{id:"actions",header:()=>o("div",{class:"text-right"},"Actions"),cell:({row:s})=>{const t=s.original;return o("div",{class:"flex justify-end gap-2"},[o(h,{variant:"outline",size:"sm",onClick:()=>w.visit(pe.url(t.id))},()=>o(Ae,{class:"h-4 w-4"})),t.status===0?o(h,{variant:"default",size:"sm",onClick:()=>re(t)},()=>o(ee,{class:"h-4 w-4"})):null,t.status===0?o(h,{variant:"outline",size:"sm",onClick:()=>ne(t)},()=>o(ze,{class:"h-4 w-4 text-destructive"})):null])}}],L=De({get data(){return f.bonuses.data},columns:N,getCoreRowModel:Ee(),getSortedRowModel:Ne(),getFilteredRowModel:He(),state:{get sorting(){return y.value},get columnFilters(){return z.value},get columnVisibility(){return H.value},get rowSelection(){return I.value}},onSortingChange:s=>M(s,y),onColumnFiltersChange:s=>M(s,z),onColumnVisibilityChange:s=>M(s,H),onRowSelectionChange:s=>M(s,I),manualSorting:!0,enableRowSelection:!0});Q(y,s=>{s.length>0&&w.get(T.url(),{search:S.value||void 0,status:v.value!=="all"?parseInt(v.value):void 0,level:g.value!=="all"?parseInt(g.value):void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let E;return Q([S,v,g],()=>{clearTimeout(E),E=setTimeout(()=>{w.get(T.url(),{search:S.value||void 0,status:v.value!=="all"?parseInt(v.value):void 0,level:g.value!=="all"?parseInt(g.value):void 0,sort_by:y.value[0]?.id||"created_at",sort_order:y.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,t)=>(i(),x(me,{breadcrumbs:se},{default:a(()=>[l(e(Be),{title:"Bonus Matching"}),r("div",Je,[r("div",We,[t[8]||(t[8]=r("div",null,[r("h1",{class:"text-3xl font-bold tracking-tight"},"Bonus Matching"),r("p",{class:"text-muted-foreground"},"Kelola bonus matching multi-level")],-1)),l(e(h),{onClick:t[0]||(t[0]=n=>e(w).visit(e(ce).url()))},{default:a(()=>[l(e(Ie),{class:"h-4 w-4"}),t[7]||(t[7]=u(" Tambah Bonus ",-1))]),_:1})]),r("div",qe,[l(e(j),null,{default:a(()=>[l(e(U),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[l(e(P),{class:"text-sm font-medium"},{default:a(()=>[...t[9]||(t[9]=[u("Total Pending",-1)])]),_:1}),l(e(Ve),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),l(e(K),null,{default:a(()=>[r("div",Ge,_(R(c.statistics.total_pending)),1),r("p",Oe,_(c.statistics.count_pending)+" bonus ",1)]),_:1})]),_:1}),l(e(j),null,{default:a(()=>[l(e(U),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[l(e(P),{class:"text-sm font-medium"},{default:a(()=>[...t[10]||(t[10]=[u("Total Released",-1)])]),_:1}),l(e(Le),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),l(e(K),null,{default:a(()=>[r("div",Xe,_(R(c.statistics.total_released)),1),r("p",Ye,_(c.statistics.count_released)+" bonus ",1)]),_:1})]),_:1}),l(e(j),{class:"md:col-span-2"},{default:a(()=>[l(e(U),null,{default:a(()=>[l(e(P),{class:"text-sm font-medium"},{default:a(()=>[...t[11]||(t[11]=[u("By Level",-1)])]),_:1})]),_:1}),l(e(K),null,{default:a(()=>[r("div",Qe,[(i(),k(D,null,B([1,2,3,4,5],n=>r("div",{key:n,class:"text-center"},[r("div",Ze," Level "+_(n),1),r("div",et,_(R(c.statistics.by_level&&c.statistics.by_level[n]?.total||0)),1),r("div",tt,_(c.statistics.by_level&&c.statistics.by_level[n]?.count||0)+" bonus ",1)])),64))])]),_:1})]),_:1})]),$.value.length>0?(i(),k("div",st,[r("p",lt,_($.value.length)+" bonus pending dipilih ",1),l(e(h),{size:"sm",onClick:ie},{default:a(()=>[l(e(ee),{class:"h-4 w-4"}),t[12]||(t[12]=u(" Release Semua ",-1))]),_:1})])):Z("",!0),r("div",at,[r("div",nt,[l(e(Te),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),l(e(we),{modelValue:S.value,"onUpdate:modelValue":t[1]||(t[1]=n=>S.value=n),placeholder:"Cari member atau deskripsi...",class:"pl-9"},null,8,["modelValue"])]),l(e(W),{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=n=>v.value=n)},{default:a(()=>[l(e(q),{class:"w-40"},{default:a(()=>[l(e(G),{placeholder:"Semua Status"})]),_:1}),l(e(O),null,{default:a(()=>[l(e(p),{value:"all"},{default:a(()=>[...t[13]||(t[13]=[u("Semua Status",-1)])]),_:1}),l(e(p),{value:"0"},{default:a(()=>[...t[14]||(t[14]=[u("Pending",-1)])]),_:1}),l(e(p),{value:"1"},{default:a(()=>[...t[15]||(t[15]=[u("Released",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(e(W),{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=n=>g.value=n)},{default:a(()=>[l(e(q),{class:"w-40"},{default:a(()=>[l(e(G),{placeholder:"Semua Level"})]),_:1}),l(e(O),null,{default:a(()=>[l(e(p),{value:"all"},{default:a(()=>[...t[16]||(t[16]=[u("Semua Level",-1)])]),_:1}),l(e(p),{value:"1"},{default:a(()=>[...t[17]||(t[17]=[u("Level 1",-1)])]),_:1}),l(e(p),{value:"2"},{default:a(()=>[...t[18]||(t[18]=[u("Level 2",-1)])]),_:1}),l(e(p),{value:"3"},{default:a(()=>[...t[19]||(t[19]=[u("Level 3",-1)])]),_:1}),l(e(p),{value:"4"},{default:a(()=>[...t[20]||(t[20]=[u("Level 4",-1)])]),_:1}),l(e(p),{value:"5"},{default:a(()=>[...t[21]||(t[21]=[u("Level 5",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(e(be),null,{default:a(()=>[l(e(xe),{"as-child":""},{default:a(()=>[l(e(h),{variant:"outline",class:"ml-auto"},{default:a(()=>[l(e(Me),{class:"h-4 w-4"}),t[22]||(t[22]=u(" Kolom ",-1)),l(e(Fe),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),l(e(ye),{align:"end"},{default:a(()=>[(i(!0),k(D,null,B(e(L).getAllColumns().filter(n=>n.getCanHide()),n=>(i(),x(e(he),{key:n.id,class:"capitalize",checked:n.getIsVisible(),"onUpdate:checked":d=>n.toggleVisibility(!!d)},{default:a(()=>[u(_(n.id),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1})]),r("div",ot,[l(e(ke),null,{default:a(()=>[l(e(Se),null,{default:a(()=>[(i(!0),k(D,null,B(e(L).getHeaderGroups(),n=>(i(),x(e(A),{key:n.id},{default:a(()=>[(i(!0),k(D,null,B(n.headers,d=>(i(),x(e(Ce),{key:d.id},{default:a(()=>[d.isPlaceholder?Z("",!0):(i(),x(e(te),{key:0,render:d.column.columnDef.header,props:d.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),l(e($e),null,{default:a(()=>[e(L).getRowModel().rows?.length?(i(!0),k(D,{key:0},B(e(L).getRowModel().rows,n=>(i(),x(e(A),{key:n.id,"data-state":n.getIsSelected()?"selected":void 0},{default:a(()=>[(i(!0),k(D,null,B(n.getVisibleCells(),d=>(i(),x(e(X),{key:d.id},{default:a(()=>[l(e(te),{render:d.column.columnDef.cell,props:d.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(i(),x(e(A),{key:1},{default:a(()=>[l(e(X),{colspan:N.length,class:"h-24 text-center"},{default:a(()=>[...t[23]||(t[23]=[u(" Tidak ada data bonus. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),l(_e,{data:c.bonuses,url:e(T).url(),filters:{search:S.value||void 0,status:v.value!=="all"?parseInt(v.value):void 0,level:g.value!=="all"?parseInt(g.value):void 0,sort_by:y.value[0]?.id,sort_order:y.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])]),l(F,{open:C.value.open,"onUpdate:open":t[4]||(t[4]=n=>C.value.open=n),title:"Hapus Bonus?",description:"Apakah Anda yakin ingin menghapus bonus ini? Tindakan ini tidak dapat dibatalkan.","confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:oe},null,8,["open"]),l(F,{open:b.value.open,"onUpdate:open":t[5]||(t[5]=n=>b.value.open=n),title:"Release Bonus?",description:`Bonus sebesar ${b.value.bonus?R(b.value.bonus.amount):""} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release","cancel-text":"Batal",onConfirm:ue},null,8,["open","description"]),l(F,{open:V.value.open,"onUpdate:open":t[6]||(t[6]=n=>V.value.open=n),title:`Release ${$.value.length} Bonus?`,description:`Total ${R($.value.reduce((n,d)=>n+d.amount,0))} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release Semua","cancel-text":"Batal",onConfirm:de},null,8,["open","title","description"])]),_:1}))}});export{Rt as default};
