import{h as S,j as W,_ as X,k as O,m as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-ySs7Rre_.js";import{_ as te}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-DA4pNA17.js";import{a as M,_ as z}from"./CardContent.vue_vue_type_script_setup_true_lang-LKEwQoWP.js";import{_ as B}from"./CardHeader.vue_vue_type_script_setup_true_lang-N3E9ALN1.js";import{_ as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-Mk0zvokq.js";import{d as U,v as b,g as u,b as t,w as a,u as e,s as g,bl as se,e as c,K as w,cF as ae,cG as oe,ad as L,Z as le,r as $,q as re,E,j as P,c as _,a1 as ne,t as F,a4 as C,Y as ie,F as T,x as R,y as G,n as r,J as j,a5 as de,a6 as ue,a7 as ce,a8 as me,a9 as fe,aa as pe,ab as ve,ci as ge,z as he,A as _e,B as xe}from"./vendor-FclwbLvj.js";import{_ as ye}from"./Input.vue_vue_type_script_setup_true_lang-ZVESK4JK.js";import{a as be,b as ke,c as we,d as D,_ as Se}from"./SelectValue.vue_vue_type_script_setup_true_lang-BqISnkMA.js";import{_ as $e}from"./index-CRPqrtU2.js";import{_ as x}from"./index-B4cH97KR.js";import{_ as Ce,a as De,b as K,c as Pe,d as Te,e as J}from"./TableHeader.vue_vue_type_script_setup_true_lang-BhZiDflO.js";import{u as Re}from"./usePermissions-DzkwVpfD.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-ByVucR83.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-9OZOAxj9.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D90ORJgI.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ZLo4HemS.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DuXcz617.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-D_xJ4jwR.js";const je={class:"grid gap-4 md:grid-cols-3"},Ae={class:"text-2xl font-bold"},Ie={class:"text-2xl font-bold"},Me={class:"text-2xl font-bold"},ze=U({__name:"PromotionStatistics",props:{statistics:{}},setup(o){return(k,n)=>(u(),b("div",je,[t(e(z),null,{default:a(()=>[t(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(V),{class:"text-sm font-medium"},{default:a(()=>[...n[0]||(n[0]=[g("Promosi Aktif",-1)])]),_:1}),t(e(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(M),null,{default:a(()=>[c("div",Ae,w(o.statistics.total_active),1),n[1]||(n[1]=c("p",{class:"text-xs text-muted-foreground"},"Sedang berjalan",-1))]),_:1})]),_:1}),t(e(z),null,{default:a(()=>[t(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(V),{class:"text-sm font-medium"},{default:a(()=>[...n[2]||(n[2]=[g("Terjadwal",-1)])]),_:1}),t(e(ae),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(M),null,{default:a(()=>[c("div",Ie,w(o.statistics.total_scheduled),1),n[3]||(n[3]=c("p",{class:"text-xs text-muted-foreground"},"Akan datang",-1))]),_:1})]),_:1}),t(e(z),null,{default:a(()=>[t(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(V),{class:"text-sm font-medium"},{default:a(()=>[...n[4]||(n[4]=[g("Kadaluarsa",-1)])]),_:1}),t(e(oe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(M),null,{default:a(()=>[c("div",Me,w(o.statistics.total_expired),1),n[5]||(n[5]=c("p",{class:"text-xs text-muted-foreground"},"Sudah berakhir",-1))]),_:1})]),_:1})]))}}),Be={class:"flex items-center gap-4"},Ve={class:"relative flex-1"},Fe=U({__name:"PromotionFilters",props:{search:{required:!0},searchModifiers:{},type:{required:!0},typeModifiers:{}},emits:["update:search","update:type"],setup(o){const k=L(o,"search"),n=L(o,"type");return(h,d)=>(u(),b("div",Be,[c("div",Ve,[t(e(le),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(ye),{modelValue:k.value,"onUpdate:modelValue":d[0]||(d[0]=m=>k.value=m),placeholder:"Cari promosi...",class:"pl-9"},null,8,["modelValue"])]),t(e(Se),{modelValue:n.value,"onUpdate:modelValue":d[1]||(d[1]=m=>n.value=m)},{default:a(()=>[t(e(be),{class:"w-40"},{default:a(()=>[t(e(ke),{placeholder:"Semua Tipe"})]),_:1}),t(e(we),null,{default:a(()=>[t(e(D),{value:"all"},{default:a(()=>[...d[2]||(d[2]=[g("Semua Tipe",-1)])]),_:1}),t(e(D),{value:"discount"},{default:a(()=>[...d[3]||(d[3]=[g("Diskon",-1)])]),_:1}),t(e(D),{value:"bundle"},{default:a(()=>[...d[4]||(d[4]=[g("Bundle",-1)])]),_:1}),t(e(D),{value:"flash_sale"},{default:a(()=>[...d[5]||(d[5]=[g("Flash Sale",-1)])]),_:1}),t(e(D),{value:"promo"},{default:a(()=>[...d[6]||(d[6]=[g("Promo",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Ke={class:"rounded-xl p-4 space-y-6 py-6"},Ue={class:"flex items-center justify-between"},qe={class:"rounded-md border"},Ne={key:0,class:"flex items-center justify-between"},He={class:"text-sm text-muted-foreground"},Le={class:"flex gap-2"},ct=U({__name:"Index",props:{promotions:{},statistics:{},filters:{}},setup(o){const{isSuperAdmin:k,isAdmin:n}=Re(),h=o,d=[{title:"Promosi & Diskon",href:S.url()}],m=$(h.filters.search||""),f=$(h.filters.type||"all"),p=$([{id:h.filters.sort_by,desc:h.filters.sort_order==="desc"}]),A=$({}),y=$({open:!1,promotion:null}),q=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),Y=s=>{const l=new Date,i=new Date(s.start_at),v=new Date(s.end_at);return s.is_active?l<i?{text:"Scheduled",variant:"outline"}:l>v?{text:"Expired",variant:"destructive"}:{text:"Active",variant:"default"}:{text:"Inactive",variant:"secondary"}},Z=s=>{y.value={open:!0,promotion:s}},Q=()=>{y.value.promotion&&P.delete(O.url(y.value.promotion.id),{preserveScroll:!0,onSuccess:()=>{y.value={open:!1,promotion:null}}})},N=[{id:"select",header:({table:s})=>r("input",{type:"checkbox",checked:s.getIsAllPageRowsSelected(),indeterminate:s.getIsSomePageRowsSelected(),onChange:s.getToggleAllPageRowsSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),cell:({row:s})=>r("input",{type:"checkbox",checked:s.getIsSelected(),disabled:!s.getCanSelect(),onChange:s.getToggleSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),enableSorting:!1},{id:"index",header:()=>r("div",{class:"w-12"},"No"),cell:({row:s})=>{const l=s.index+1+(h.promotions.current_page-1)*h.promotions.per_page;return r("div",{class:"font-medium"},l)}},{accessorKey:"name",header:({column:s})=>r(x,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Nama Promosi",r(s.getIsSorted()==="asc"?fe:s.getIsSorted()==="desc"?pe:ve,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>r("div",[r("div",{class:"font-medium"},s.original.name),r("div",{class:"text-xs text-muted-foreground"},s.original.type)])},{accessorKey:"code",header:()=>r("div","Kode"),cell:({row:s})=>r("div",{class:"font-mono text-sm"},s.original.code)},{accessorKey:"start_at",header:()=>"Periode",cell:({row:s})=>r("div",{class:"text-sm"},[r("div",q(s.original.start_at)),r("div",{class:"text-muted-foreground"},q(s.original.end_at))])},{id:"status",header:()=>"Status",cell:({row:s})=>{const l=Y(s.original);return r($e,{variant:l.variant},()=>l.text)}},{id:"actions",header:()=>r("div",{class:"text-right"},"Actions"),cell:({row:s})=>{const l=s.original,i=[];return(k||n)&&i.push(r(x,{variant:"outline",size:"sm",onClick:()=>P.visit(ee.url(l.id))},()=>r(ge,{class:"h-4 w-4"})),r(x,{variant:"outline",size:"sm",onClick:()=>Z(l)},()=>r(he,{class:"h-4 w-4 text-destructive"}))),r("div",{class:"flex justify-end gap-2"},i)}}],I=re({get data(){return h.promotions.data},columns:N,getCoreRowModel:xe(),getSortedRowModel:_e(),state:{get sorting(){return p.value},get rowSelection(){return A.value}},onSortingChange:s=>{p.value=typeof s=="function"?s(p.value):s},onRowSelectionChange:s=>{A.value=typeof s=="function"?s(A.value):s},manualSorting:!0,enableRowSelection:!0});E(p,s=>{s.length>0&&P.get(S.url(),{search:m.value||void 0,type:f.value!=="all"?f.value:void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let H;return E([m,f],()=>{clearTimeout(H),H=setTimeout(()=>{P.get(S.url(),{search:m.value||void 0,type:f.value!=="all"?f.value:void 0,sort_by:p.value[0]?.id||"created_at",sort_order:p.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,l)=>(u(),_(X,{breadcrumbs:d},{default:a(()=>[t(e(ne),{title:"Promosi & Diskon"}),c("div",Ke,[c("div",Ue,[l[4]||(l[4]=c("div",null,[c("h1",{class:"text-3xl font-bold tracking-tight"},"Promosi & Diskon"),c("p",{class:"text-muted-foreground"},"Kelola promosi dan diskon produk")],-1)),e(k)||e(n)?(u(),_(e(C),{key:0,href:e(W).url()},{default:a(()=>[t(e(x),null,{default:a(()=>[t(e(ie),{class:"h-4 w-4"}),l[3]||(l[3]=g(" Tambah Promosi ",-1))]),_:1})]),_:1},8,["href"])):F("",!0)]),t(ze,{statistics:o.statistics},null,8,["statistics"]),t(Fe,{search:m.value,"onUpdate:search":l[0]||(l[0]=i=>m.value=i),type:f.value,"onUpdate:type":l[1]||(l[1]=i=>f.value=i)},null,8,["search","type"]),c("div",qe,[t(e(Ce),null,{default:a(()=>[t(e(De),null,{default:a(()=>[(u(!0),b(T,null,R(e(I).getHeaderGroups(),i=>(u(),_(e(K),{key:i.id},{default:a(()=>[(u(!0),b(T,null,R(i.headers,v=>(u(),_(e(Pe),{key:v.id},{default:a(()=>[v.isPlaceholder?F("",!0):(u(),_(e(G),{key:0,render:v.column.columnDef.header,props:v.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(Te),null,{default:a(()=>[e(I).getRowModel().rows?.length?(u(!0),b(T,{key:0},R(e(I).getRowModel().rows,i=>(u(),_(e(K),{key:i.id,"data-state":i.getIsSelected()?"selected":void 0},{default:a(()=>[(u(!0),b(T,null,R(i.getVisibleCells(),v=>(u(),_(e(J),{key:v.id},{default:a(()=>[t(e(G),{render:v.column.columnDef.cell,props:v.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(u(),_(e(K),{key:1},{default:a(()=>[t(e(J),{colspan:N.length,class:"h-24 text-center"},{default:a(()=>[...l[5]||(l[5]=[g(" Tidak ada data promosi. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),o.promotions.last_page>1?(u(),b("div",Ne,[c("p",He," Menampilkan "+w((o.promotions.current_page-1)*o.promotions.per_page+1)+" hingga "+w(Math.min(o.promotions.current_page*o.promotions.per_page,o.promotions.total))+" dari "+w(o.promotions.total)+" hasil ",1),c("div",Le,[t(e(x),{variant:"outline",size:"sm",disabled:o.promotions.current_page===1,"as-child":""},{default:a(()=>[t(e(C),{href:e(S).url({query:{page:1,search:m.value||void 0,type:f.value!=="all"?f.value:void 0,sort_by:p.value[0]?.id,sort_order:p.value[0]?.desc?"desc":"asc"}}),class:j({"pointer-events-none opacity-50":o.promotions.current_page===1}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(de),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"]),t(e(x),{variant:"outline",size:"sm",disabled:!o.promotions.links[0]?.url,"as-child":""},{default:a(()=>[t(e(C),{href:o.promotions.links[0]?.url||"#",class:j({"pointer-events-none opacity-50":!o.promotions.links[0]?.url}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(ue),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"]),t(e(x),{variant:"outline",size:"sm",disabled:!o.promotions.links[o.promotions.links.length-1]?.url,"as-child":""},{default:a(()=>[t(e(C),{href:o.promotions.links[o.promotions.links.length-1]?.url||"#",class:j({"pointer-events-none opacity-50":!o.promotions.links[o.promotions.links.length-1]?.url}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(ce),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"]),t(e(x),{variant:"outline",size:"sm",disabled:o.promotions.current_page===o.promotions.last_page,"as-child":""},{default:a(()=>[t(e(C),{href:e(S).url({query:{page:o.promotions.last_page,search:m.value||void 0,type:f.value!=="all"?f.value:void 0,sort_by:p.value[0]?.id,sort_order:p.value[0]?.desc?"desc":"asc"}}),class:j({"pointer-events-none opacity-50":o.promotions.current_page===o.promotions.last_page}),"preserve-scroll":"","preserve-state":""},{default:a(()=>[t(e(me),{class:"h-4 w-4"})]),_:1},8,["href","class"])]),_:1},8,["disabled"])])])):F("",!0)]),t(te,{open:y.value.open,"onUpdate:open":l[2]||(l[2]=i=>y.value.open=i),title:"Hapus Promosi?",description:`Apakah Anda yakin ingin menghapus promosi '${y.value.promotion?.name}'? Tindakan ini tidak dapat dibatalkan.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:Q},null,8,["open","description"])]),_:1}))}});export{ct as default};
