import{n as C,_ as Q,p as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-B4Q7M_yc.js";import{_ as X}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-IDKWa8Pc.js";import{_ as Z}from"./Pagination.vue_vue_type_script_setup_true_lang-BvpV56IR.js";import{a as S,_ as R}from"./CardContent.vue_vue_type_script_setup_true_lang-DMEXwOYw.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-DAmVrl_s.js";import{_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-BNxuRtlf.js";import{d as H,v as b,g as o,b as t,w as a,u as e,s as f,cv as ee,e as u,J as k,cw as J,as as te,r as y,q as se,D as N,j as M,c as g,$ as ae,t as q,Y as le,a8 as re,F as w,x as $,y as z,n as i,al as ne,aE as oe,A as ue,B as de}from"./vendor-zBKKL15G.js";import{_ as ie}from"./index-Bgaf6fPq.js";import{_ as P,v as j}from"./index-D-ZDeNW7.js";import{_ as ce,a as fe,b as me}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CJL3Y8wp.js";import{_ as pe}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-E3LrliJt.js";import{_ as ge}from"./Input.vue_vue_type_script_setup_true_lang-B8h33Tay.js";import{_ as _e,a as ve,b as xe,c as ye,d as V}from"./SelectValue.vue_vue_type_script_setup_true_lang-DhBu_Vgs.js";import{_ as be,a as we,b as I,c as $e,d as he,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-B4pjwwGU.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-kKofCkkG.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-CzoF4v2h.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-5qqdoF-N.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DSZTc71l.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-ZdsPM9bJ.js";const Ce={class:"grid gap-4 md:grid-cols-3"},Ve={class:"text-2xl font-bold"},ke={class:"text-2xl font-bold"},Se={class:"text-2xl font-bold"},Re=H({__name:"RefundStatistics",props:{statistics:{}},setup(n){return(_,d)=>(o(),b("div",Ce,[t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[0]||(d[0]=[f("Pending",-1)])]),_:1}),t(e(ee),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:a(()=>[u("div",Ve,k(n.statistics.total_pending),1),d[1]||(d[1]=u("p",{class:"text-xs text-muted-foreground"},"Menunggu proses",-1))]),_:1})]),_:1}),t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[2]||(d[2]=[f("Diproses",-1)])]),_:1}),t(e(J),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:a(()=>[u("div",ke,k(n.statistics.total_processing),1),d[3]||(d[3]=u("p",{class:"text-xs text-muted-foreground"},"Sedang diproses",-1))]),_:1})]),_:1}),t(e(R),null,{default:a(()=>[t(e(D),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[4]||(d[4]=[f("Selesai",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:a(()=>[u("div",Se,k(n.statistics.total_completed),1),d[5]||(d[5]=u("p",{class:"text-xs text-muted-foreground"},"Refund selesai",-1))]),_:1})]),_:1})]))}}),De={class:"rounded-xl p-4 space-y-6 py-6"},Fe={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Me={class:"flex flex-1 gap-4"},Pe={class:"relative flex-1 max-w-sm"},je={class:"rounded-md border"},et=H({__name:"Index",props:{refunds:{},statistics:{},filters:{}},setup(n){const _=n,d=[{title:"Refund",href:C.url()}],x=y(_.filters.search||""),m=y(_.filters.status||"all"),v=y([{id:_.filters.sort_by||"created_at",desc:_.filters.sort_order==="desc"}]),U=y([]),A=y({}),p=y({open:!1,refund:null}),L=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),B=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),O=s=>({pending:"secondary",processing:"outline",completed:"default"})[s]||"secondary",Y=s=>{p.value={open:!0,refund:s}},G=()=>{p.value.refund&&M.post(W.url(p.value.refund.id),{},{preserveScroll:!0,onSuccess:()=>{p.value={open:!1,refund:null}}})},K=[{id:"index",header:()=>i("div",{class:"w-12"},"No"),cell:({row:s})=>{const l=s.index+1+(_.refunds.current_page-1)*_.refunds.per_page;return i("div",{class:"font-medium"},l)}},{accessorKey:"order.order_no",header:({column:s})=>i(P,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Order",i(ne,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>{const l=s.original.order;return i("div",[i("div",{class:"font-medium"},l.order_no),i("div",{class:"text-xs text-muted-foreground"},l.customer?.name||"Unknown")])}},{accessorKey:"amount",header:()=>"Jumlah",cell:({row:s})=>i("div",{class:"font-medium"},B(s.getValue("amount")))},{accessorKey:"reason",header:()=>"Alasan",cell:({row:s})=>i("div",{class:"max-w-xs truncate"},s.getValue("reason"))},{accessorKey:"status",header:()=>"Status",cell:({row:s})=>{const l=s.getValue("status");return i(ie,{variant:O(l)},()=>l)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:s})=>L(s.getValue("created_at"))},{id:"actions",header:()=>i("div",{class:"text-right"},"Actions"),cell:({row:s})=>{const l=s.original;return l.status==="completed"?null:i("div",{class:"flex justify-end gap-2"},[i(P,{variant:"default",size:"sm",onClick:()=>Y(l)},()=>[i(J,{class:"mr-2 h-4 w-4"}),"Proses"])])}}],h=se({get data(){return _.refunds.data},columns:K,getCoreRowModel:de(),getSortedRowModel:ue(),getFilteredRowModel:oe(),onSortingChange:s=>j(s,v),onColumnFiltersChange:s=>j(s,U),onColumnVisibilityChange:s=>j(s,A),state:{get sorting(){return v.value},get columnFilters(){return U.value},get columnVisibility(){return A.value}},manualSorting:!0});N(v,s=>{s.length>0&&M.get(C.url(),{search:x.value||void 0,status:m.value!=="all"?m.value:void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let T;return N([x,m],()=>{clearTimeout(T),T=setTimeout(()=>{M.get(C.url(),{search:x.value||void 0,status:m.value!=="all"?m.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,l)=>(o(),g(Q,{breadcrumbs:d},{default:a(()=>[t(e(ae),{title:"Refund"}),u("div",De,[l[9]||(l[9]=u("div",{class:"flex items-center justify-between"},[u("div",null,[u("h1",{class:"text-3xl font-bold tracking-tight"},"Refund"),u("p",{class:"text-muted-foreground"},"Kelola permintaan pengembalian dana")])],-1)),t(Re,{statistics:n.statistics},null,8,["statistics"]),u("div",Fe,[u("div",Me,[u("div",Pe,[t(e(le),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(ge),{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=r=>x.value=r),placeholder:"Cari order atau customer...",class:"pl-9"},null,8,["modelValue"])]),t(e(_e),{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=r=>m.value=r)},{default:a(()=>[t(e(ve),{class:"w-[180px]"},{default:a(()=>[t(e(xe),{placeholder:"Semua Status"})]),_:1}),t(e(ye),null,{default:a(()=>[t(e(V),{value:"all"},{default:a(()=>[...l[3]||(l[3]=[f("Semua Status",-1)])]),_:1}),t(e(V),{value:"pending"},{default:a(()=>[...l[4]||(l[4]=[f("Pending",-1)])]),_:1}),t(e(V),{value:"processing"},{default:a(()=>[...l[5]||(l[5]=[f("Processing",-1)])]),_:1}),t(e(V),{value:"completed"},{default:a(()=>[...l[6]||(l[6]=[f("Completed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(ce),null,{default:a(()=>[t(e(fe),{"as-child":""},{default:a(()=>[t(e(P),{variant:"outline",class:"ml-auto"},{default:a(()=>[l[7]||(l[7]=f(" Kolom ",-1)),t(e(re),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(me),{align:"end"},{default:a(()=>[(o(!0),b(w,null,$(e(h).getAllColumns().filter(r=>r.getCanHide()),r=>(o(),g(e(pe),{key:r.id,class:"capitalize","model-value":r.getIsVisible(),"onUpdate:modelValue":c=>{r.toggleVisibility(!!c)}},{default:a(()=>[f(k(r.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),u("div",je,[t(e(be),null,{default:a(()=>[t(e(we),null,{default:a(()=>[(o(!0),b(w,null,$(e(h).getHeaderGroups(),r=>(o(),g(e(I),{key:r.id},{default:a(()=>[(o(!0),b(w,null,$(r.headers,c=>(o(),g(e($e),{key:c.id},{default:a(()=>[c.isPlaceholder?q("",!0):(o(),g(e(z),{key:0,render:c.column.columnDef.header,props:c.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(he),null,{default:a(()=>[e(h).getRowModel().rows?.length?(o(!0),b(w,{key:0},$(e(h).getRowModel().rows,r=>(o(),g(e(I),{key:r.id},{default:a(()=>[(o(!0),b(w,null,$(r.getVisibleCells(),c=>(o(),g(e(E),{key:c.id},{default:a(()=>[t(e(z),{render:c.column.columnDef.cell,props:c.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(o(),g(e(I),{key:1},{default:a(()=>[t(e(E),{colspan:K.length,class:"h-24 text-center"},{default:a(()=>[...l[8]||(l[8]=[f(" Tidak ada data refund. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),n.refunds.last_page>1?(o(),g(Z,{key:0,data:{current_page:n.refunds.current_page,last_page:n.refunds.last_page,per_page:n.refunds.per_page,from:(n.refunds.current_page-1)*n.refunds.per_page+1,to:Math.min(n.refunds.current_page*n.refunds.per_page,n.refunds.total),total:n.refunds.total},url:e(C).url(),filters:{search:x.value||void 0,status:m.value!=="all"?m.value:void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):q("",!0)]),t(X,{open:p.value.open,"onUpdate:open":l[2]||(l[2]=r=>p.value.open=r),title:"Proses Refund?",description:`Apakah Anda yakin ingin memproses refund untuk order ${p.value.refund?.order.order_no} sebesar ${p.value.refund?B(p.value.refund.amount):""}?`,"confirm-text":"Proses","cancel-text":"Batal",onConfirm:G},null,8,["open","description"])]),_:1}))}});export{et as default};
