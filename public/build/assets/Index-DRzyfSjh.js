import{N as $,_ as me,O as fe,P as pe,Q as ge}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNFjYB-7.js";import{_ as A}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-BFGhJpjt.js";import{_ as _e}from"./Pagination.vue_vue_type_script_setup_true_lang-DQuybfRy.js";import{_ as ve}from"./index-DyUpvQGF.js";import{_ as D,v as V}from"./index-Dgwk259n.js";import{_ as H,a as L}from"./CardContent.vue_vue_type_script_setup_true_lang-CPgAkxDh.js";import{_ as O}from"./CardHeader.vue_vue_type_script_setup_true_lang-CDPuo1h4.js";import{_ as E}from"./CardTitle.vue_vue_type_script_setup_true_lang-DjmDdGQ7.js";import{_ as q}from"./Checkbox.vue_vue_type_script_setup_true_lang-yx4_pKg1.js";import{_ as be,a as xe,b as he,d as ye,e as z,c as J}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BNRb2ZrY.js";import{d as ke,r as c,d0 as Se,p as Q,q as we,E as W,j as B,v as b,g as i,b as t,w as l,u as s,e as o,ai as Re,t as T,s as u,F as x,am as X,z as Ce,a0 as $e,Y as De,at as Ve,K as w,d7 as Be,c as g,Z as Fe,x as F,y as Y,n as r,D as Z,cy as Ie,aL as Ae,an as Te,aF as Me,A as Pe,B as Ue}from"./vendor-u69_SgX4.js";import{_ as je}from"./Input.vue_vue_type_script_setup_true_lang-B09zx5te.js";import{_ as Ke,a as Ne,b as He,c as Le,d as M}from"./SelectValue.vue_vue_type_script_setup_true_lang-Dglpcc31.js";import{_ as Oe,a as Ee,b as P,c as qe,d as ze,e as G}from"./TableHeader.vue_vue_type_script_setup_true_lang-C0WMCBTo.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-dvnhmmY7.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BW0SaXTm.js";import"./index-DqFeuJ-n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-41k4hIm2.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-_3dn1dX5.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CbM4MXOh.js";const Je={class:"flex h-full flex-1 flex-col gap-6 p-6"},Qe={class:"flex items-center justify-between"},We={class:"grid gap-4 md:grid-cols-4"},Xe={class:"text-2xl font-bold"},Ye={class:"text-xs text-muted-foreground"},Ze={class:"text-2xl font-bold text-green-600"},Ge={class:"text-xs text-muted-foreground"},es={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},ss={class:"flex flex-1 items-center gap-4"},ts={class:"relative flex-1 md:max-w-sm"},as={class:"rounded-md border"},Rs=ke({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(_){const m=_,ee=[{title:"Bonus Cashback",href:$.url()}],h=c(m.filters.search||""),p=c(m.filters.status?.toString()||"all"),y=c([{id:m.filters.sort_by,desc:m.filters.sort_order==="desc"}]),U=c([]),j=c({}),k=c({}),[se,te]=Se(),v=c({open:!1,bonus:null}),f=c({open:!1,bonus:null}),R=c({open:!1}),ae=Q(()=>Object.keys(k.value).map(e=>m.bonuses.data[parseInt(e)]).filter(Boolean)),S=Q(()=>ae.value.filter(e=>e.status===0)),C=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),le=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=e=>{v.value={open:!0,bonus:e}},oe=()=>{v.value.bonus&&B.delete(fe.url(v.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{v.value={open:!1,bonus:null}}})},re=e=>{f.value={open:!0,bonus:e}},ie=()=>{if(!f.value.bonus)return;Z({}).post(pe.url(f.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{f.value={open:!1,bonus:null},k.value={}}})},ue=()=>{S.value.length&&(R.value.open=!0)},de=()=>{const e=S.value.map(n=>n.id);Z({ids:e}).post(ge.url(),{preserveScroll:!0,onSuccess:()=>{k.value={},R.value.open=!1}})},K=[{id:"select",header:({table:e})=>r(q,{modelValue:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":a=>e.toggleAllPageRowsSelected(!!a),ariaLabel:"Select all"}),cell:({row:e})=>r(q,{modelValue:e.getIsSelected(),"onUpdate:modelValue":a=>e.toggleSelected(!!a),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>r("div",{class:"w-12"},"No"),cell:({row:e})=>r("div",{class:"font-medium"},e.index+1+(m.bonuses.current_page-1)*m.bonuses.per_page)},{accessorKey:"member_name",header:()=>"Member",cell:({row:e})=>r("div",[r("div",{class:"font-medium"},e.original.member_name),r("div",{class:"text-xs text-muted-foreground"},e.original.member_ewallet_id)])},{accessorKey:"order_id",header:()=>"Order ID",cell:({row:e})=>r("div",{class:"font-mono text-sm"},e.original.order_id||"-")},{accessorKey:"amount",header:()=>r("div",{class:"text-right"},"Jumlah"),cell:({row:e})=>r("div",{class:"text-right font-medium"},C(e.original.amount))},{accessorKey:"status",header:()=>"Status",cell:({row:e})=>r(ve,{variant:e.original.status===1?"default":"secondary",class:"gap-1"},()=>[r(e.original.status===1?Ie:Ae,{class:"h-3 w-3"}),e.original.status_text])},{accessorKey:"created_at",header:({column:e})=>r(D,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",r(Te,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>le(e.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:e})=>r(te,{bonus:e.original,onRelease:()=>re(e.original),onDelete:()=>ne(e.original)})}],I=we({get data(){return m.bonuses.data},columns:K,getCoreRowModel:Ue(),getSortedRowModel:Pe(),getFilteredRowModel:Me(),onSortingChange:e=>V(e,y),onColumnFiltersChange:e=>V(e,U),onColumnVisibilityChange:e=>V(e,j),onRowSelectionChange:e=>V(e,k),state:{get sorting(){return y.value},get columnFilters(){return U.value},get columnVisibility(){return j.value},get rowSelection(){return k.value}},manualSorting:!0,enableRowSelection:!0});W(y,e=>{e.length>0&&B.get($.url(),{search:h.value||void 0,status:p.value!=="all"?parseInt(p.value):void 0,sort_by:e[0].id,sort_order:e[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let N;return W([h,p],()=>{clearTimeout(N),N=setTimeout(()=>{B.get($.url(),{search:h.value||void 0,status:p.value!=="all"?parseInt(p.value):void 0,sort_by:y.value[0]?.id||"created_at",sort_order:y.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(e,a)=>(i(),b(x,null,[t(s(se),null,{default:l(({bonus:n,onRelease:d,onDelete:ce})=>[t(s(be),null,{default:l(()=>[t(s(xe),{"as-child":""},{default:l(()=>[t(s(D),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[a[6]||(a[6]=o("span",{class:"sr-only"},"Open menu",-1)),t(s(Re),{class:"h-4 w-4"})]),_:1})]),_:1}),t(s(he),{align:"end"},{default:l(()=>[t(s(ye),null,{default:l(()=>[...a[7]||(a[7]=[u("Actions",-1)])]),_:1}),n.status===0?(i(),b(x,{key:0},[t(s(z)),t(s(J),{onClick:d},{default:l(()=>[t(s(X),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=u(" Release Bonus ",-1))]),_:1},8,["onClick"])],64)):T("",!0),t(s(z)),t(s(J),{class:"text-destructive",onClick:ce},{default:l(()=>[t(s(Ce),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=u(" Hapus ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1}),t(me,{breadcrumbs:ee},{default:l(()=>[t(s($e),{title:"Bonus Cashback"}),o("div",Je,[o("div",Qe,[a[11]||(a[11]=o("div",null,[o("h1",{class:"text-3xl font-bold tracking-tight"},"Bonus Cashback"),o("p",{class:"text-muted-foreground"},"Kelola bonus cashback member")],-1)),t(s(D),{onClick:a[0]||(a[0]=n=>s(B).visit("/bonus/cashback/create"))},{default:l(()=>[t(s(De),{class:"mr-2 h-4 w-4"}),a[10]||(a[10]=u(" Tambah Bonus ",-1))]),_:1})]),o("div",We,[t(s(H),null,{default:l(()=>[t(s(O),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(s(E),{class:"text-sm font-medium"},{default:l(()=>[...a[12]||(a[12]=[u("Total Pending",-1)])]),_:1}),t(s(Ve),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(s(L),null,{default:l(()=>[o("div",Xe,w(C(_.statistics.total_pending)),1),o("p",Ye,w(_.statistics.count_pending)+" transaksi",1)]),_:1})]),_:1}),t(s(H),null,{default:l(()=>[t(s(O),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(s(E),{class:"text-sm font-medium"},{default:l(()=>[...a[13]||(a[13]=[u("Total Released",-1)])]),_:1}),t(s(Be),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(s(L),null,{default:l(()=>[o("div",Ze,w(C(_.statistics.total_released)),1),o("p",Ge,w(_.statistics.count_released)+" transaksi",1)]),_:1})]),_:1})]),o("div",es,[o("div",ss,[o("div",ts,[t(s(Fe),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(s(je),{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=n=>h.value=n),placeholder:"Cari member...",class:"pl-9"},null,8,["modelValue"])]),t(s(Ke),{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=n=>p.value=n)},{default:l(()=>[t(s(Ne),{class:"w-40"},{default:l(()=>[t(s(He),{placeholder:"Semua Status"})]),_:1}),t(s(Le),null,{default:l(()=>[t(s(M),{value:"all"},{default:l(()=>[...a[14]||(a[14]=[u("Semua Status",-1)])]),_:1}),t(s(M),{value:"0"},{default:l(()=>[...a[15]||(a[15]=[u("Pending",-1)])]),_:1}),t(s(M),{value:"1"},{default:l(()=>[...a[16]||(a[16]=[u("Released",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),S.value.length?(i(),g(s(D),{key:0,variant:"outline",onClick:ue},{default:l(()=>[t(s(X),{class:"mr-2 h-4 w-4"}),u(" Release "+w(S.value.length)+" Bonus ",1)]),_:1})):T("",!0)]),o("div",as,[t(s(Oe),null,{default:l(()=>[t(s(Ee),null,{default:l(()=>[(i(!0),b(x,null,F(s(I).getHeaderGroups(),n=>(i(),g(s(P),{key:n.id},{default:l(()=>[(i(!0),b(x,null,F(n.headers,d=>(i(),g(s(qe),{key:d.id},{default:l(()=>[d.isPlaceholder?T("",!0):(i(),g(s(Y),{key:0,render:d.column.columnDef.header,props:d.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(s(ze),null,{default:l(()=>[s(I).getRowModel().rows?.length?(i(!0),b(x,{key:0},F(s(I).getRowModel().rows,n=>(i(),g(s(P),{key:n.id,"data-state":n.getIsSelected()&&"selected"},{default:l(()=>[(i(!0),b(x,null,F(n.getVisibleCells(),d=>(i(),g(s(G),{key:d.id},{default:l(()=>[t(s(Y),{render:d.column.columnDef.cell,props:d.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(i(),g(s(P),{key:1},{default:l(()=>[t(s(G),{colspan:K.length,class:"h-24 text-center"},{default:l(()=>[...a[17]||(a[17]=[u("Tidak ada data.",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),t(_e,{data:_.bonuses,url:s($).url()},null,8,["data","url"])]),t(A,{open:v.value.open,title:"Hapus Bonus",description:"Apakah Anda yakin ingin menghapus bonus ini?","confirm-text":"Hapus","onUpdate:open":a[3]||(a[3]=n=>v.value.open=n),onConfirm:oe},null,8,["open"]),t(A,{open:f.value.open,title:"Release Bonus",description:`Apakah Anda yakin ingin merilis bonus sebesar ${f.value.bonus?C(f.value.bonus.amount):""} ke member?`,"confirm-text":"Release","onUpdate:open":a[4]||(a[4]=n=>f.value.open=n),onConfirm:ie},null,8,["open","description"]),t(A,{open:R.value.open,title:"Mass Release Bonus",description:`Apakah Anda yakin ingin merilis ${S.value.length} bonus yang dipilih?`,"confirm-text":"Release All","onUpdate:open":a[5]||(a[5]=n=>R.value.open=n),onConfirm:de},null,8,["open","description"])]),_:1})],64))}});export{Rs as default};
