import{i as f,_ as S,s as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-3Xwj2Srj.js";import{u as F,a as B,_ as G}from"./useShippingLocation-DUc2xcH1.js";import{_ as m}from"./index-BhPH699V.js";import{d as T,o as $,Q as n,E as M,v as N,g as V,b as s,u as e,a1 as j,w as i,e as l,a4 as c,s as p,G as K,al as L,K as A,F as D}from"./vendor-DfMbnFaR.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-Bqij1zEj.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BOYUcfDs.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-NxThyEhC.js";import"./index-DnSHhU6t.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrG-1awo.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CpOM3BUc.js";import"./CardContent.vue_vue_type_script_setup_true_lang-NxxB_dAy.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DW_PX5BW.js";import"./CardHeader.vue_vue_type_script_setup_true_lang-Kdg7L6IL.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-Cj4ck2dV.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-Cqsoy_WK.js";import"./Input.vue_vue_type_script_setup_true_lang-Bi8Aupzl.js";import"./Label.vue_vue_type_script_setup_true_lang-C_XGMl1H.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-VBwlv4qP.js";import"./Textarea.vue_vue_type_script_setup_true_lang-DZT34h2b.js";const O={class:"space-y-6 rounded-xl p-4 py-6"},Q={class:"flex items-center justify-between"},ma=T({__name:"Create",props:{sponsors:{}},setup(g){const _=g,{form:o,toPayload:h}=F("create"),{provinces:y,cities:b,loadingProvinces:v,loadingCities:k,fetchProvinces:w,fetchCities:x,resetCities:d}=B(),C=t=>{const a=Object.values(t).filter(r=>typeof r=="string"&&r.length>0);if(a.length===0){n.error("Gagal menyimpan data pelanggan. Silakan periksa kembali input form.");return}n.error(a[0]),a.length>1&&n.warning(`Terdapat ${a.length} kesalahan pada form.`)},u=(t,a)=>t instanceof Error&&t.message.trim()!==""?t.message:a;$(async()=>{try{await w()}catch(t){n.error(u(t,"Gagal memuat daftar provinsi."))}}),M(()=>o.province_id,async(t,a)=>{if(!t){d(),o.city_id=null;return}t!==a&&(o.city_id=null);try{await x(t)}catch(r){n.error(u(r,"Gagal memuat daftar kota/kabupaten.")),d()}});const P=()=>{o.transform(t=>h(t)).post(E.url(),{preserveScroll:!0,onSuccess:()=>{n.success("Pelanggan berhasil didaftarkan.")},onError:t=>{C(t)}})};return(t,a)=>(V(),N(D,null,[s(e(j),{title:"Tambah Pelanggan"}),s(S,null,{default:i(()=>[l("div",O,[l("div",Q,[a[2]||(a[2]=l("div",null,[l("h1",{class:"text-3xl font-bold"},"Tambah Pelanggan"),l("p",{class:"mt-2 text-muted-foreground"}," Form registrasi pelanggan dengan data identitas, alamat, dan rekening yang lengkap. ")],-1)),s(e(c),{href:e(f).url()},{default:i(()=>[s(e(m),{variant:"outline"},{default:i(()=>[s(e(K),{class:"mr-2 h-4 w-4"}),a[1]||(a[1]=p(" Kembali ",-1))]),_:1})]),_:1},8,["href"])]),s(G,{form:e(o),"onUpdate:form":a[0]||(a[0]=r=>L(o)?o.value=r:null),mode:"create",sponsors:_.sponsors,provinces:e(y),cities:e(b),"loading-provinces":e(v),"loading-cities":e(k),onSubmit:P},{actions:i(({processing:r})=>[s(e(c),{href:e(f).url()},{default:i(()=>[s(e(m),{type:"button",variant:"outline"},{default:i(()=>[...a[3]||(a[3]=[p(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),s(e(m),{type:"submit",disabled:r},{default:i(()=>[p(A(r?"Menyimpan...":"Simpan Pelanggan"),1)]),_:2},1032,["disabled"])]),_:1},8,["form","sponsors","provinces","cities","loading-provinces","loading-cities"])])]),_:1})],64))}});export{ma as default};
