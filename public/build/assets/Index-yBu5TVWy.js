import{d as F,r as f,ak as U,p as H,q as G,c as u,g as n,w as r,b as l,e as c,u as s,$ as q,a2 as b,s as I,W as O,Y as W,v as h,F as x,x as y,t as Y,y as N,n as t,al as B,am as Z,an as J,Z as Q,z as X,j as V,P as k,B as ee}from"./vendor-zBKKL15G.js";import{c as ae,i as T,_ as te,a as se,e as le,d as re}from"./AppLayout.vue_vue_type_script_setup_true_lang-B4Q7M_yc.js";import{_ as m}from"./index-D-ZDeNW7.js";import{_ as ne}from"./Input.vue_vue_type_script_setup_true_lang-B8h33Tay.js";import{_ as z}from"./index-Bgaf6fPq.js";import{_ as oe,a as ie,b as C,c as ce,d as de,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-B4pjwwGU.js";import{_ as ue}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-IDKWa8Pc.js";import{_ as me}from"./Pagination.vue_vue_type_script_setup_true_lang-BvpV56IR.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-kKofCkkG.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-CzoF4v2h.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CJL3Y8wp.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-5qqdoF-N.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DSZTc71l.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-ZdsPM9bJ.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-DhBu_Vgs.js";const pe={class:"rounded-xl p-4 space-y-6 py-6"},ge={class:"mb-6 flex items-center justify-between"},fe={class:"mb-4 flex items-center gap-4"},_e={class:"relative flex-1"},ve={class:"rounded-md border"},Te=F({__name:"Index",props:{customers:{},filters:{}},setup($){const M=(a,e)=>{V.post(`/manage/customers/${a}/login-as`,{},{onSuccess:()=>{k.success(`Login sebagai ${e}`)},onError:()=>{k.error("Gagal login sebagai customer")}})},d=$,_=f(d.filters.search||""),v=f(d.filters.sort_by||"created_at"),g=f(d.filters.sort_order||"desc"),P=f(d.filters.per_page||10),R=a=>{V.delete(re.url(a),{preserveScroll:!0,onSuccess:()=>{k.success("Pelanggan berhasil dihapus")},onError:()=>{k.error("Gagal menghapus pelanggan")}})},p=f({open:!1,data:null}),j=a=>{p.value={open:!0,data:a}},S=U(()=>{V.get(T.url(),{search:_.value,sort_by:v.value,sort_order:g.value,per_page:P.value},{preserveState:!0,preserveScroll:!0})},300),D=a=>{v.value===a?g.value=g.value==="asc"?"desc":"asc":(v.value=a,g.value="asc"),S()},A=()=>{p.value.data&&R(p.value.data.id)},K=[{id:"index",header:()=>t("div",{class:"text-left"},"No"),cell:({row:a})=>{const e=a.index+1+(d.customers.current_page-1)*d.customers.per_page;return t("div",{class:"text-left"},e.toString())}},{accessorKey:"ewallet_id",header:()=>t(m,{variant:"ghost",onClick:()=>D("ewallet_id")},()=>["Ewallet ID",t(B,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>t("div",{class:"font-mono text-sm"},a.getValue("ewallet_id"))},{accessorKey:"name",header:()=>t(m,{variant:"ghost",onClick:()=>D("name")},()=>["Nama",t(B,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>t("div",{},a.getValue("name"))},{accessorKey:"email",header:"Email",cell:({row:a})=>t("div",{class:"text-sm"},a.getValue("email"))},{accessorKey:"phone",header:"Telepon",cell:({row:a})=>{const e=a.getValue("phone");return t("div",{class:"text-sm"},e||"-")}},{accessorKey:"ewallet_saldo",header:()=>t("div",{class:"text-right"},"Saldo"),cell:({row:a})=>{const e=a.getValue("ewallet_saldo");return t("div",{class:"text-right font-medium"},"Rp "+new Intl.NumberFormat("id-ID").format(e))}},{accessorKey:"position",header:"Posisi",cell:({row:a})=>{const e=a.getValue("position");return e?t(z,{variant:e==="left"?"default":"secondary",class:"capitalize"},()=>e):t("div",{class:"text-center"},"-")}},{accessorKey:"email_verified_at",header:"Status",cell:({row:a})=>{const e=a.getValue("email_verified_at");return t(z,{variant:e?"default":"outline"},()=>e?"Verified":"Unverified")}},{id:"actions",header:()=>t("div",{class:"text-center"},"Aksi"),cell:({row:a})=>{const e=a.original;return t("div",{class:"flex items-center justify-center gap-2"},[t(m,{variant:"ghost",size:"icon",onClick:()=>M(e.id,e.name),title:"Login sebagai customer"},()=>t(Z,{class:"h-4 w-4 text-primary"})),t(b,{href:se.url(e.id)},()=>t(m,{variant:"ghost",size:"icon"},()=>t(J,{class:"h-4 w-4"}))),t(b,{href:le.url(e.id)},()=>t(m,{variant:"ghost",size:"icon"},()=>t(Q,{class:"h-4 w-4"}))),t(m,{variant:"ghost",size:"icon",onClick:()=>j(e)},()=>t(X,{class:"h-4 w-4 text-destructive"}))])}}],L=H(()=>d.customers.data),w=G({get data(){return L.value},columns:K,getCoreRowModel:ee(),manualSorting:!0,manualPagination:!0});return(a,e)=>(n(),u(te,null,{default:r(()=>[l(s(q),{title:"Kelola Pelanggan"}),c("div",pe,[c("div",ge,[e[3]||(e[3]=c("div",null,[c("h1",{class:"text-3xl font-bold tracking-tight"},"Kelola Pelanggan"),c("p",{class:"text-muted-foreground"}," Kelola data pelanggan dan jaringan MLM ")],-1)),l(s(b),{href:s(ae).url()},{default:r(()=>[l(s(m),null,{default:r(()=>[l(s(O),{class:"mr-2 h-4 w-4"}),e[2]||(e[2]=I(" Tambah Pelanggan ",-1))]),_:1})]),_:1},8,["href"])]),c("div",fe,[c("div",_e,[l(s(W),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),l(s(ne),{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),placeholder:"Cari nama, email, telepon, atau ewallet ID...",class:"pl-10",onInput:s(S)},null,8,["modelValue","onInput"])])]),c("div",ve,[l(s(oe),null,{default:r(()=>[l(s(ie),null,{default:r(()=>[(n(!0),h(x,null,y(s(w).getHeaderGroups(),o=>(n(),u(s(C),{key:o.id},{default:r(()=>[(n(!0),h(x,null,y(o.headers,i=>(n(),u(s(ce),{key:i.id},{default:r(()=>[i.isPlaceholder?Y("",!0):(n(),u(s(N),{key:0,render:i.column.columnDef.header,props:i.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),l(s(de),null,{default:r(()=>[s(w).getRowModel().rows?.length?(n(!0),h(x,{key:0},y(s(w).getRowModel().rows,o=>(n(),u(s(C),{key:o.id},{default:r(()=>[(n(!0),h(x,null,y(o.getVisibleCells(),i=>(n(),u(s(E),{key:i.id},{default:r(()=>[l(s(N),{render:i.column.columnDef.cell,props:i.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(n(),u(s(C),{key:1},{default:r(()=>[l(s(E),{colspan:K.length,class:"h-24 text-center"},{default:r(()=>[...e[4]||(e[4]=[I(" Tidak ada data pelanggan. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),l(me,{data:$.customers,url:s(T).url(),filters:{search:_.value,sort_by:v.value,sort_order:g.value,per_page:P.value}},null,8,["data","url","filters"])]),l(ue,{open:p.value.open,"onUpdate:open":e[1]||(e[1]=o=>p.value.open=o),title:"Hapus Pelanggan?",description:`Apakah Anda yakin ingin menghapus pelanggan ${p.value.data?.name}? Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data terkait termasuk jaringan dan bonus.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:A},null,8,["open","description"])]),_:1}))}});export{Te as default};
