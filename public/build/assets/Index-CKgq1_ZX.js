import{R as V,_ as be,S as xe,T as we,V as he}from"./AppLayout.vue_vue_type_script_setup_true_lang-CAMiCJvC.js";import{_ as j}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-DRKnPmKW.js";import{_ as ye}from"./Pagination.vue_vue_type_script_setup_true_lang-DUSFRDmQ.js";import{_ as Se}from"./index-uV4J0ulh.js";import{_ as D,v as B}from"./index-BYj0gYCc.js";import{_ as P,a as U}from"./CardContent.vue_vue_type_script_setup_true_lang-vqvbNoPF.js";import{_ as K}from"./CardHeader.vue_vue_type_script_setup_true_lang-_r3YWix0.js";import{_ as L}from"./CardTitle.vue_vue_type_script_setup_true_lang-CuQE-qUU.js";import{_ as W}from"./Checkbox.vue_vue_type_script_setup_true_lang-DriYWKuu.js";import{_ as Re,a as Ce,b as ke,d as $e,e as X,c as Y}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DA3JUaxj.js";import{d as Ve,r as c,d9 as De,p as Z,q as Be,E as G,j as A,v as x,g as i,b as s,w as l,u as e,e as o,aj as Ae,t as k,c as f,s as u,F as w,an as J,z as Ie,a1 as Te,aE as Fe,Y as Me,ax as Q,K as v,dl as Ne,aV as je,Z as Pe,x as I,y as ee,n as r,D as te,ao as Ue,T as Ke,at as Le,aN as Ee,A as He,B as qe}from"./vendor-ppbe-N6l.js";import{_ as Oe}from"./Input.vue_vue_type_script_setup_true_lang-DNj-uKug.js";import{_ as ze,a as We,b as Xe,c as Ye,d as T}from"./SelectValue.vue_vue_type_script_setup_true_lang-CzK-upws.js";import{_ as Ze,a as Ge,b as E,c as Je,d as Qe,e as se}from"./TableHeader.vue_vue_type_script_setup_true_lang-CR2Mc2h7.js";import{u as et}from"./usePermissions-ooJviFw8.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-DiRTNO4J.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BAAtcDkZ.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CKDVFyjr.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-B3c6JmTR.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-sCt9Ofqi.js";const tt={class:"flex h-full flex-1 flex-col gap-6 p-6"},st={class:"flex items-center justify-between"},at={class:"text-3xl font-bold tracking-tight flex items-center gap-2"},lt={class:"grid gap-4 md:grid-cols-4"},nt={class:"text-2xl font-bold"},ot={class:"text-xs text-muted-foreground"},rt={class:"text-2xl font-bold text-green-600"},it={class:"text-xs text-muted-foreground"},ut={class:"text-2xl font-bold text-red-600"},dt={class:"text-xs text-muted-foreground"},mt={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},ct={class:"flex flex-1 items-center gap-4"},ft={class:"relative flex-1 md:max-w-sm"},pt={class:"rounded-md border"},jt=Ve({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(p){const{isSuperAdmin:F,isAdmin:M}=et(),g=p,ae=[{title:"Bonus Lifetime Cash Reward",href:V.url()}],h=c(g.filters.search||""),_=c(g.filters.status?.toString()||"all"),y=c([{id:g.filters.sort_by,desc:g.filters.sort_order==="desc"}]),H=c([]),q=c({}),S=c({}),[le,ne]=De(),b=c({open:!1,bonus:null}),m=c({open:!1,bonus:null}),$=c({open:!1}),oe=Z(()=>Object.keys(S.value).map(t=>g.bonuses.data[parseInt(t)]).filter(Boolean)),R=Z(()=>oe.value.filter(t=>t.status===0)),C=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),re=t=>new Intl.NumberFormat("id-ID").format(t),ie=t=>new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ue=t=>{switch(t){case 1:return"default";case 2:return"destructive";default:return"secondary"}},de=t=>{switch(t){case 1:return Le;case 2:return Ke;default:return Q}},me=t=>{b.value={open:!0,bonus:t}},ce=()=>{b.value.bonus&&A.delete(xe.url(b.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{b.value={open:!1,bonus:null}}})},fe=t=>{m.value={open:!0,bonus:t}},pe=()=>{if(!m.value.bonus)return;te({}).post(we.url(m.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{m.value={open:!1,bonus:null},S.value={}}})},ge=()=>{R.value.length&&($.value.open=!0)},_e=()=>{const t=R.value.map(n=>n.id);te({ids:t}).post(he.url(),{preserveScroll:!0,onSuccess:()=>{S.value={},$.value.open=!1}})},O=[{id:"select",header:({table:t})=>r(W,{modelValue:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":a=>t.toggleAllPageRowsSelected(!!a),ariaLabel:"Select all"}),cell:({row:t})=>r(W,{modelValue:t.getIsSelected(),"onUpdate:modelValue":a=>t.toggleSelected(!!a),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>r("div",{class:"w-12"},"No"),cell:({row:t})=>r("div",{class:"font-medium"},t.index+1+(g.bonuses.current_page-1)*g.bonuses.per_page)},{accessorKey:"member_name",header:()=>"Member",cell:({row:t})=>r("div",[r("div",{class:"font-medium"},t.original.member_name),r("div",{class:"text-xs text-muted-foreground"},t.original.member_ewallet_id)])},{accessorKey:"reward_name",header:()=>"Nama Reward",cell:({row:t})=>r("div",{class:"font-medium"},t.original.reward_name)},{accessorKey:"reward",header:()=>r("div",{class:"text-right"},"Reward"),cell:({row:t})=>r("div",{class:"text-right font-medium"},C(t.original.reward))},{accessorKey:"bv",header:()=>r("div",{class:"text-right"},"BV"),cell:({row:t})=>r("div",{class:"text-right text-muted-foreground"},re(t.original.bv))},{accessorKey:"status",header:()=>"Status",cell:({row:t})=>r(Se,{variant:ue(t.original.status),class:"gap-1"},()=>[r(de(t.original.status),{class:"h-3 w-3"}),t.original.status_text])},{accessorKey:"created_at",header:({column:t})=>r(D,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",r(Ue,{class:"ml-2 h-4 w-4"})]),cell:({row:t})=>ie(t.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:t})=>r(ne,{bonus:t.original,onRelease:()=>fe(t.original),onDelete:()=>me(t.original)})}],N=Be({get data(){return g.bonuses.data},columns:O,getCoreRowModel:qe(),getSortedRowModel:He(),getFilteredRowModel:Ee(),onSortingChange:t=>B(t,y),onColumnFiltersChange:t=>B(t,H),onColumnVisibilityChange:t=>B(t,q),onRowSelectionChange:t=>B(t,S),state:{get sorting(){return y.value},get columnFilters(){return H.value},get columnVisibility(){return q.value},get rowSelection(){return S.value}},manualSorting:!0,enableRowSelection:!0});G(y,t=>{t.length>0&&A.get(V.url(),{search:h.value||void 0,status:_.value!=="all"?parseInt(_.value):void 0,sort_by:t[0].id,sort_order:t[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let z;return G([h,_],()=>{clearTimeout(z),z=setTimeout(()=>{A.get(V.url(),{search:h.value||void 0,status:_.value!=="all"?parseInt(_.value):void 0,sort_by:y.value[0]?.id||"created_at",sort_order:y.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(t,a)=>(i(),x(w,null,[s(e(le),null,{default:l(({bonus:n,onRelease:d,onDelete:ve})=>[s(e(Re),null,{default:l(()=>[s(e(Ce),{"as-child":""},{default:l(()=>[s(e(D),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[a[6]||(a[6]=o("span",{class:"sr-only"},"Open menu",-1)),s(e(Ae),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(ke),{align:"end"},{default:l(()=>[s(e($e),null,{default:l(()=>[...a[7]||(a[7]=[u("Actions",-1)])]),_:1}),n.status===0&&(e(F)||e(M))?(i(),x(w,{key:0},[s(e(X)),s(e(Y),{onClick:d},{default:l(()=>[s(e(J),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=u(" Release Bonus ",-1))]),_:1},8,["onClick"])],64)):k("",!0),s(e(X)),e(F)||e(M)?(i(),f(e(Y),{key:1,class:"text-destructive",onClick:ve},{default:l(()=>[s(e(Ie),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=u(" Hapus ",-1))]),_:1},8,["onClick"])):k("",!0)]),_:2},1024)]),_:2},1024)]),_:1}),s(be,{breadcrumbs:ae},{default:l(()=>[s(e(Te),{title:"Bonus Lifetime Cash Reward"}),o("div",tt,[o("div",st,[o("div",null,[o("h1",at,[s(e(Fe),{class:"h-8 w-8"}),a[10]||(a[10]=u(" Bonus Lifetime Cash Reward ",-1))]),a[11]||(a[11]=o("p",{class:"text-muted-foreground"},"Kelola bonus lifetime cash reward member",-1))]),e(F)||e(M)?(i(),f(e(D),{key:0,onClick:a[0]||(a[0]=n=>e(A).visit("/bonus/lifetime-cash-reward/create"))},{default:l(()=>[s(e(Me),{class:"mr-2 h-4 w-4"}),a[12]||(a[12]=u(" Tambah Bonus ",-1))]),_:1})):k("",!0)]),o("div",lt,[s(e(P),null,{default:l(()=>[s(e(K),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(L),{class:"text-sm font-medium"},{default:l(()=>[...a[13]||(a[13]=[u("Total Pending",-1)])]),_:1}),s(e(Q),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(U),null,{default:l(()=>[o("div",nt,v(C(p.statistics.total_pending)),1),o("p",ot,v(p.statistics.count_pending)+" reward",1)]),_:1})]),_:1}),s(e(P),null,{default:l(()=>[s(e(K),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(L),{class:"text-sm font-medium"},{default:l(()=>[...a[14]||(a[14]=[u("Total Claimed",-1)])]),_:1}),s(e(Ne),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(U),null,{default:l(()=>[o("div",rt,v(C(p.statistics.total_claimed)),1),o("p",it,v(p.statistics.count_claimed)+" reward",1)]),_:1})]),_:1}),s(e(P),null,{default:l(()=>[s(e(K),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(L),{class:"text-sm font-medium"},{default:l(()=>[...a[15]||(a[15]=[u("Total Expired",-1)])]),_:1}),s(e(je),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(U),null,{default:l(()=>[o("div",ut,v(C(p.statistics.total_expired)),1),o("p",dt,v(p.statistics.count_expired)+" reward",1)]),_:1})]),_:1})]),o("div",mt,[o("div",ct,[o("div",ft,[s(e(Pe),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s(e(Oe),{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=n=>h.value=n),placeholder:"Cari member atau nama reward...",class:"pl-9"},null,8,["modelValue"])]),s(e(ze),{modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=n=>_.value=n)},{default:l(()=>[s(e(We),{class:"w-40"},{default:l(()=>[s(e(Xe),{placeholder:"Semua Status"})]),_:1}),s(e(Ye),null,{default:l(()=>[s(e(T),{value:"all"},{default:l(()=>[...a[16]||(a[16]=[u("Semua Status",-1)])]),_:1}),s(e(T),{value:"0"},{default:l(()=>[...a[17]||(a[17]=[u("Pending",-1)])]),_:1}),s(e(T),{value:"1"},{default:l(()=>[...a[18]||(a[18]=[u("Claimed",-1)])]),_:1}),s(e(T),{value:"2"},{default:l(()=>[...a[19]||(a[19]=[u("Expired",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),R.value.length?(i(),f(e(D),{key:0,variant:"outline",onClick:ge},{default:l(()=>[s(e(J),{class:"mr-2 h-4 w-4"}),u(" Release "+v(R.value.length)+" Bonus ",1)]),_:1})):k("",!0)]),o("div",pt,[s(e(Ze),null,{default:l(()=>[s(e(Ge),null,{default:l(()=>[(i(!0),x(w,null,I(e(N).getHeaderGroups(),n=>(i(),f(e(E),{key:n.id},{default:l(()=>[(i(!0),x(w,null,I(n.headers,d=>(i(),f(e(Je),{key:d.id},{default:l(()=>[d.isPlaceholder?k("",!0):(i(),f(e(ee),{key:0,render:d.column.columnDef.header,props:d.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),s(e(Qe),null,{default:l(()=>[e(N).getRowModel().rows?.length?(i(!0),x(w,{key:0},I(e(N).getRowModel().rows,n=>(i(),f(e(E),{key:n.id,"data-state":n.getIsSelected()&&"selected"},{default:l(()=>[(i(!0),x(w,null,I(n.getVisibleCells(),d=>(i(),f(e(se),{key:d.id},{default:l(()=>[s(e(ee),{render:d.column.columnDef.cell,props:d.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(i(),f(e(E),{key:1},{default:l(()=>[s(e(se),{colspan:O.length,class:"h-24 text-center"},{default:l(()=>[...a[20]||(a[20]=[u("Tidak ada data.",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),s(ye,{data:p.bonuses,url:e(V).url()},null,8,["data","url"])]),s(j,{open:b.value.open,title:"Hapus Bonus",description:"Apakah Anda yakin ingin menghapus bonus ini?","confirm-text":"Hapus","onUpdate:open":a[3]||(a[3]=n=>b.value.open=n),onConfirm:ce},null,8,["open"]),s(j,{open:m.value.open,title:"Release Bonus",description:`Apakah Anda yakin ingin merilis reward ${m.value.bonus?.reward_name} sebesar ${m.value.bonus?C(m.value.bonus.reward):""} ke member?`,"confirm-text":"Release","onUpdate:open":a[4]||(a[4]=n=>m.value.open=n),onConfirm:pe},null,8,["open","description"]),s(j,{open:$.value.open,title:"Mass Release Bonus",description:`Apakah Anda yakin ingin merilis ${R.value.length} bonus yang dipilih?`,"confirm-text":"Release All","onUpdate:open":a[5]||(a[5]=n=>$.value.open=n),onConfirm:_e},null,8,["open","description"])]),_:1})],64))}});export{jt as default};
