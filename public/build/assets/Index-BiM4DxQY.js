import{a0 as I,a3 as fe,a1 as pe,_ as ge,a4 as _e,a5 as ve,a6 as be}from"./AppLayout.vue_vue_type_script_setup_true_lang-BWDCecJb.js";import{_ as U}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-D8AYChA2.js";import{_ as xe}from"./Pagination.vue_vue_type_script_setup_true_lang-D1dwDX2q.js";import{_ as we}from"./index-COroZ9V9.js";import{_ as R,v as T}from"./index-DPd1r_cX.js";import{_ as N,a as z}from"./CardContent.vue_vue_type_script_setup_true_lang-DM70BYA8.js";import{_ as E}from"./CardHeader.vue_vue_type_script_setup_true_lang-D25MJpMC.js";import{_ as q}from"./CardTitle.vue_vue_type_script_setup_true_lang-l0wDcl-m.js";import{_ as J}from"./Checkbox.vue_vue_type_script_setup_true_lang-ChiKY_-L.js";import{_ as O,a as W,b as Q,d as ye,c as A,e as Se}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DA-zofsy.js";import{_ as he}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-Biukrt9b.js";import{d as ke,r as f,cI as Ce,p as X,q as $e,D as Z,j as x,v as _,g as r,b as a,w as l,u as e,e as u,ae as Re,t as F,s as d,am as De,F as w,an as G,z as Ve,Z as Be,c as v,V as Ie,cQ as Te,J as k,ar as Fe,W as Ue,a7 as Ae,x as D,y as Y,n as o,cv as Me,b7 as je,ak as Pe,aD as He,A as Ke,B as Le}from"./vendor-CraqpIJ-.js";import{_ as Ne}from"./Input.vue_vue_type_script_setup_true_lang-CqlAd_sW.js";import{_ as ze,a as Ee,b as qe,c as Je,d as M}from"./SelectValue.vue_vue_type_script_setup_true_lang-Bvtl-Sz4.js";import{_ as Oe,a as We,b as j,c as Qe,d as Xe,e as ee}from"./TableHeader.vue_vue_type_script_setup_true_lang-DUQMK31p.js";import"./index-B7Ms5jW_.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-BmdNsnpq.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-4BlfWucD.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BZHhRcHM.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CQgGBfly.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-C2jUDPfA.js";const Ze={class:"rounded-xl p-4 space-y-6 py-6"},Ge={class:"flex items-center justify-between"},Ye={class:"grid gap-4 md:grid-cols-2"},et={class:"text-2xl font-bold"},tt={class:"text-xs text-muted-foreground"},st={class:"text-2xl font-bold"},at={class:"text-xs text-muted-foreground"},lt={key:0,class:"flex items-center justify-between rounded-lg border bg-muted/50 p-4"},nt={class:"text-sm font-medium"},ot={class:"flex items-center gap-4"},rt={class:"relative flex-1"},ut={class:"rounded-md border"},It=ke({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(m){const p=m,te=[{title:"Bonus Sponsor",href:I.url()}],y=f(p.filters.search||""),c=f(p.filters.status?.toString()||"all"),b=f([{id:p.filters.sort_by,desc:p.filters.sort_order==="desc"}]),P=f([]),H=f({}),C=f({}),[se,ae]=Ce(),S=f({open:!1,bonus:null}),g=f({open:!1,bonus:null}),V=f({open:!1}),le=X(()=>Object.keys(C.value).map(s=>p.bonuses.data[parseInt(s)]).filter(Boolean)),h=X(()=>le.value.filter(s=>s.status===0)),$=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),ne=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),oe=s=>{S.value={open:!0,bonus:s}},re=()=>{S.value.bonus&&x.delete(_e.url(S.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{S.value={open:!1,bonus:null}}})},ue=s=>{g.value={open:!0,bonus:s}},ie=()=>{g.value.bonus&&x.post(ve.url(g.value.bonus.id),{},{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,bonus:null},C.value={}}})},de=()=>{h.value.length&&(V.value.open=!0)},me=()=>{const s=h.value.map(t=>t.id);x.post(be.url(),{bonus_ids:s},{preserveScroll:!0,onSuccess:()=>{C.value={},V.value.open=!1}})},K=[{id:"select",header:({table:s})=>o(J,{modelValue:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":t=>s.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:s})=>o(J,{modelValue:s.getIsSelected(),"onUpdate:modelValue":t=>s.toggleSelected(!!t),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>o("div",{class:"w-12"},"No"),cell:({row:s})=>{const t=s.index+1+(p.bonuses.current_page-1)*p.bonuses.per_page;return o("div",{class:"font-medium"},t)}},{accessorKey:"member_name",header:()=>"Sponsor (Penerima)",cell:({row:s})=>o("div",[o("div",{class:"font-medium"},s.original.member_name),o("div",{class:"text-xs text-muted-foreground"},s.original.member_ewallet_id)])},{accessorKey:"from_member_name",header:()=>"Downline",cell:({row:s})=>o("div",[o("div",{class:"font-medium"},s.original.from_member_name),o("div",{class:"text-xs text-muted-foreground"},s.original.from_member_ewallet_id)])},{accessorKey:"amount",header:()=>o("div",{class:"text-right"},"Jumlah"),cell:({row:s})=>o("div",{class:"text-right font-medium"},$(s.original.amount))},{accessorKey:"status",header:()=>"Status",cell:({row:s})=>{const t=s.original.status;return o(we,{variant:t===1?"default":"secondary",class:"gap-1"},()=>[o(t===1?Me:je,{class:"h-3 w-3"}),s.original.status_text])}},{accessorKey:"created_at",header:({column:s})=>o(R,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",o(Pe,{class:"ml-2 h-4 w-4"})]),cell:({row:s})=>ne(s.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:s})=>{const t=s.original;return o(ae,{bonus:t,onRelease:()=>ue(t),onDelete:()=>oe(t)})}}],B=$e({get data(){return p.bonuses.data},columns:K,getCoreRowModel:Le(),getSortedRowModel:Ke(),getFilteredRowModel:He(),onSortingChange:s=>T(s,b),onColumnFiltersChange:s=>T(s,P),onColumnVisibilityChange:s=>T(s,H),onRowSelectionChange:s=>T(s,C),state:{get sorting(){return b.value},get columnFilters(){return P.value},get columnVisibility(){return H.value},get rowSelection(){return C.value}},manualSorting:!0,enableRowSelection:!0});Z(b,s=>{s.length>0&&x.get(I.url(),{search:y.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:s[0].id,sort_order:s[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let L;return Z([y,c],()=>{clearTimeout(L),L=setTimeout(()=>{x.get(I.url(),{search:y.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:b.value[0]?.id||"created_at",sort_order:b.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(s,t)=>(r(),_(w,null,[a(e(se),null,{default:l(({bonus:n,onRelease:i,onDelete:ce})=>[a(e(O),null,{default:l(()=>[a(e(W),{"as-child":""},{default:l(()=>[a(e(R),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[t[6]||(t[6]=u("span",{class:"sr-only"},"Open menu",-1)),a(e(Re),{class:"h-4 w-4"})]),_:1})]),_:1}),a(e(Q),{align:"end"},{default:l(()=>[a(e(ye),null,{default:l(()=>[...t[7]||(t[7]=[d("Actions",-1)])]),_:1}),a(e(A),{onClick:it=>e(x).visit(e(fe).url(n.id))},{default:l(()=>[a(e(De),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=d(" Lihat Detail ",-1))]),_:1},8,["onClick"]),n.status===0?(r(),_(w,{key:0},[a(e(Se)),a(e(A),{onClick:i},{default:l(()=>[a(e(G),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=d(" Release Bonus ",-1))]),_:1},8,["onClick"]),a(e(A),{onClick:ce,class:"text-destructive"},{default:l(()=>[a(e(Ve),{class:"mr-2 h-4 w-4"}),t[10]||(t[10]=d(" Hapus Bonus ",-1))]),_:1},8,["onClick"])],64)):F("",!0)]),_:2},1024)]),_:2},1024)]),_:1}),a(ge,{breadcrumbs:te},{default:l(()=>[a(e(Be),{title:"Bonus Sponsor"}),u("div",Ze,[u("div",Ge,[t[12]||(t[12]=u("div",null,[u("h1",{class:"text-3xl font-bold tracking-tight"},"Bonus Sponsor"),u("p",{class:"text-muted-foreground"},"Kelola bonus sponsor dari downline")],-1)),a(e(R),{onClick:t[0]||(t[0]=n=>e(x).visit(e(pe).url()))},{default:l(()=>[a(e(Ie),{class:"h-4 w-4"}),t[11]||(t[11]=d(" Tambah Bonus ",-1))]),_:1})]),u("div",Ye,[a(e(N),null,{default:l(()=>[a(e(E),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[a(e(q),{class:"text-sm font-medium"},{default:l(()=>[...t[13]||(t[13]=[d("Total Pending",-1)])]),_:1}),a(e(Te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(e(z),null,{default:l(()=>[u("div",et,k($(m.statistics.total_pending)),1),u("p",tt,k(m.statistics.count_pending)+" bonus ",1)]),_:1})]),_:1}),a(e(N),null,{default:l(()=>[a(e(E),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[a(e(q),{class:"text-sm font-medium"},{default:l(()=>[...t[14]||(t[14]=[d("Total Released",-1)])]),_:1}),a(e(Fe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(e(z),null,{default:l(()=>[u("div",st,k($(m.statistics.total_released)),1),u("p",at,k(m.statistics.count_released)+" bonus ",1)]),_:1})]),_:1})]),h.value.length>0?(r(),_("div",lt,[u("p",nt,k(h.value.length)+" bonus pending dipilih ",1),a(e(R),{size:"sm",onClick:de},{default:l(()=>[a(e(G),{class:"h-4 w-4"}),t[15]||(t[15]=d(" Release Semua ",-1))]),_:1})])):F("",!0),u("div",ot,[u("div",rt,[a(e(Ue),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a(e(Ne),{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=n=>y.value=n),placeholder:"Cari sponsor atau downline...",class:"pl-9"},null,8,["modelValue"])]),a(e(ze),{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n)},{default:l(()=>[a(e(Ee),{class:"w-40"},{default:l(()=>[a(e(qe),{placeholder:"Semua Status"})]),_:1}),a(e(Je),null,{default:l(()=>[a(e(M),{value:"all"},{default:l(()=>[...t[16]||(t[16]=[d("Semua Status",-1)])]),_:1}),a(e(M),{value:"0"},{default:l(()=>[...t[17]||(t[17]=[d("Pending",-1)])]),_:1}),a(e(M),{value:"1"},{default:l(()=>[...t[18]||(t[18]=[d("Released",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(e(O),null,{default:l(()=>[a(e(W),{"as-child":""},{default:l(()=>[a(e(R),{variant:"outline",class:"ml-auto"},{default:l(()=>[t[19]||(t[19]=d(" Kolom ",-1)),a(e(Ae),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),a(e(Q),{align:"end"},{default:l(()=>[(r(!0),_(w,null,D(e(B).getAllColumns().filter(n=>n.getCanHide()),n=>(r(),v(e(he),{key:n.id,class:"capitalize","model-value":n.getIsVisible(),"onUpdate:modelValue":i=>{n.toggleVisibility(!!i)}},{default:l(()=>[d(k(n.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),u("div",ut,[a(e(Oe),null,{default:l(()=>[a(e(We),null,{default:l(()=>[(r(!0),_(w,null,D(e(B).getHeaderGroups(),n=>(r(),v(e(j),{key:n.id},{default:l(()=>[(r(!0),_(w,null,D(n.headers,i=>(r(),v(e(Qe),{key:i.id},{default:l(()=>[i.isPlaceholder?F("",!0):(r(),v(e(Y),{key:0,render:i.column.columnDef.header,props:i.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),a(e(Xe),null,{default:l(()=>[e(B).getRowModel().rows?.length?(r(!0),_(w,{key:0},D(e(B).getRowModel().rows,n=>(r(),v(e(j),{key:n.id,"data-state":n.getIsSelected()?"selected":void 0},{default:l(()=>[(r(!0),_(w,null,D(n.getVisibleCells(),i=>(r(),v(e(ee),{key:i.id},{default:l(()=>[a(e(Y),{render:i.column.columnDef.cell,props:i.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(r(),v(e(j),{key:1},{default:l(()=>[a(e(ee),{colspan:K.length,class:"h-24 text-center"},{default:l(()=>[...t[20]||(t[20]=[d(" Tidak ada data bonus. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),m.bonuses.last_page>1?(r(),v(xe,{key:1,data:{current_page:m.bonuses.current_page,last_page:m.bonuses.last_page,per_page:m.bonuses.per_page,from:m.bonuses.from,to:m.bonuses.to,total:m.bonuses.total},url:e(I).url(),filters:{search:y.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:b.value[0]?.id||"created_at",sort_order:b.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):F("",!0)]),a(U,{open:S.value.open,"onUpdate:open":t[3]||(t[3]=n=>S.value.open=n),title:"Hapus Bonus?",description:"Apakah Anda yakin ingin menghapus bonus ini? Tindakan ini tidak dapat dibatalkan.","confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:re},null,8,["open"]),a(U,{open:g.value.open,"onUpdate:open":t[4]||(t[4]=n=>g.value.open=n),title:"Release Bonus?",description:`Bonus sebesar ${g.value.bonus?$(g.value.bonus.amount):""} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release","cancel-text":"Batal",onConfirm:ie},null,8,["open","description"]),a(U,{open:V.value.open,"onUpdate:open":t[5]||(t[5]=n=>V.value.open=n),title:`Release ${h.value.length} Bonus?`,description:`Total ${$(h.value.reduce((n,i)=>n+i.amount,0))} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release Semua","cancel-text":"Batal",onConfirm:me},null,8,["open","title","description"])]),_:1})],64))}});export{It as default};
