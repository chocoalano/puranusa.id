import{d as h,p as w,r as l,v as y,g as S,b as e,u as a,a1 as D,w as n,e as s,a4 as _,G as E,s as g,K as F,F as $,j as P,Q as x}from"./vendor-4-BZYpFr.js";import{_ as j}from"./AppLayout.vue_vue_type_script_setup_true_lang-4ba7MJZZ.js";import{_ as d}from"./index-C_d1QX2L.js";import{_ as B}from"./PromotionForm.vue_vue_type_script_setup_true_lang-94mYLyjO.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-CQ0bN-pz.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DAlPCySi.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B92NEDT-.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DLcPllPw.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CdMXDPSC.js";import"./Input.vue_vue_type_script_setup_true_lang-BCOvYMLd.js";import"./Label.vue_vue_type_script_setup_true_lang-Cme2qRTp.js";import"./Textarea.vue_vue_type_script_setup_true_lang-VjG-xC7r.js";import"./CardContent.vue_vue_type_script_setup_true_lang-CqrB5hxD.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DgP-o0Lu.js";import"./CardHeader.vue_vue_type_script_setup_true_lang-CAU7O7lt.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CXovuBmY.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-uung8Eko.js";const N={class:"rounded-xl p-4 space-y-6 py-6"},T={class:"flex items-center gap-4"},V={class:"max-w-4xl"},Z=h({__name:"Edit",props:{promotion:{}},setup(u){const o=u,c=r=>new Date(r).toISOString().slice(0,16),b=w(()=>o.promotion.image?o.promotion.image.startsWith("http")?o.promotion.image:`/storage/${o.promotion.image}`:null),m=l({code:o.promotion.code,name:o.promotion.name,type:o.promotion.type,landing_slug:o.promotion.landing_slug||"",description:o.promotion.description||"",image:null,start_at:c(o.promotion.start_at),end_at:c(o.promotion.end_at),is_active:o.promotion.is_active,priority:o.promotion.priority,max_redemption:o.promotion.max_redemption,per_user_limit:o.promotion.per_user_limit,conditions_json:o.promotion.conditions_json||"",show_on:o.promotion.show_on||"",page:o.promotion.page||""}),f=l({}),p=l(!1),v=()=>{p.value=!0;const r=new FormData;r.append("_method","PUT"),Object.entries(m.value).forEach(([t,i])=>{t==="image"?i instanceof File&&r.append(t,i):i!=null&&(typeof i=="boolean"?r.append(t,i?"1":"0"):r.append(t,String(i)))}),P.post(`/admin/promotions/${o.promotion.id}`,r,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{x.success("Promosi berhasil diperbarui")},onError:t=>{f.value=t,x.error("Gagal memperbarui promosi")},onFinish:()=>{p.value=!1}})};return(r,t)=>(S(),y($,null,[e(a(D),{title:`Edit ${u.promotion.name}`},null,8,["title"]),e(j,null,{default:n(()=>[s("div",N,[s("div",T,[e(a(_),{href:"/admin/promotions"},{default:n(()=>[e(a(d),{variant:"outline",size:"icon"},{default:n(()=>[e(a(E),{class:"h-4 w-4"})]),_:1})]),_:1}),t[1]||(t[1]=s("div",null,[s("h1",{class:"text-3xl font-bold"},"Edit Promosi"),s("p",{class:"text-muted-foreground"},"Perbarui informasi promosi")],-1))]),s("div",V,[e(B,{"form-data":m.value,"onUpdate:formData":t[0]||(t[0]=i=>m.value=i),errors:f.value,processing:p.value,"existing-image":b.value,onSubmit:v},{actions:n(({processing:i})=>[e(a(_),{href:"/admin/promotions"},{default:n(()=>[e(a(d),{type:"button",variant:"outline"},{default:n(()=>[...t[2]||(t[2]=[g("Batal",-1)])]),_:1})]),_:1}),e(a(d),{type:"submit",disabled:i},{default:n(()=>[g(F(i?"Menyimpan...":"Simpan Perubahan"),1)]),_:2},1032,["disabled"])]),_:1},8,["form-data","errors","processing","existing-image"])])])]),_:1})],64))}});export{Z as default};
