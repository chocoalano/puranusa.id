import{_ as W,J as Y,K as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-GwD9QHRJ.js";import{d as H,v as b,g as d,b as t,u as e,w as s,s as p,cx as te,e as i,K as k,cy as ae,aL as se,at as le,r as y,q as oe,E as B,j as N,a0 as re,c as v,t as P,Z as ne,a9 as ue,F as w,x as $,y as z,n,D as L,an as ie,bv as de,X as pe,aF as me,A as ce,B as fe}from"./vendor-0sCoMzHy.js";import{_ as q}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-BQ9O-qWE.js";import{_ as ge}from"./Pagination.vue_vue_type_script_setup_true_lang-BBKil_NH.js";import{_ as C,a as S}from"./CardContent.vue_vue_type_script_setup_true_lang-DUWiWpeg.js";import{_ as V}from"./CardHeader.vue_vue_type_script_setup_true_lang-Bo9DeG24.js";import{_ as D}from"./CardTitle.vue_vue_type_script_setup_true_lang-SuNAGsFF.js";import{_ as _e}from"./index-D12gyL4d.js";import{_ as j,v as R}from"./index-DJk7aHkf.js";import{_ as ve,a as xe,b as ye}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-KgsqrYLn.js";import{_ as be}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-CGkOsAFb.js";import{_ as we}from"./Input.vue_vue_type_script_setup_true_lang-nikPKNAJ.js";import{_ as $e,a as ke,b as he,c as Ce,d as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-Dc4bXstG.js";import{_ as Se,a as Ve,b as U,c as De,d as je,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-Bg-l8dVV.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-BhL6n9ND.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-CAfd5pFE.js";import"./index-DqFeuJ-n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DEiiatvc.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CbD5L1KI.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DMm3rbrx.js";const Fe={class:"grid gap-4 md:grid-cols-4"},Te={class:"text-2xl font-bold"},Re={class:"text-2xl font-bold"},Ue={class:"text-2xl font-bold"},Me={class:"text-2xl font-bold"},Ae=H({__name:"TopupStatistics",props:{statistics:{}},setup(u){const c=f=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(f);return(f,o)=>(d(),b("div",Fe,[t(e(C),null,{default:s(()=>[t(e(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(D),{class:"text-sm font-medium"},{default:s(()=>[...o[0]||(o[0]=[p("Pending",-1)])]),_:1}),t(e(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:s(()=>[i("div",Te,k(u.statistics.total_pending),1),o[1]||(o[1]=i("p",{class:"text-xs text-muted-foreground"},"Menunggu persetujuan",-1))]),_:1})]),_:1}),t(e(C),null,{default:s(()=>[t(e(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(D),{class:"text-sm font-medium"},{default:s(()=>[...o[2]||(o[2]=[p("Disetujui",-1)])]),_:1}),t(e(ae),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:s(()=>[i("div",Re,k(u.statistics.total_completed),1),o[3]||(o[3]=i("p",{class:"text-xs text-muted-foreground"},"Topup selesai",-1))]),_:1})]),_:1}),t(e(C),null,{default:s(()=>[t(e(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(D),{class:"text-sm font-medium"},{default:s(()=>[...o[4]||(o[4]=[p("Ditolak",-1)])]),_:1}),t(e(se),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:s(()=>[i("div",Ue,k(u.statistics.total_failed),1),o[5]||(o[5]=i("p",{class:"text-xs text-muted-foreground"},"Topup gagal",-1))]),_:1})]),_:1}),t(e(C),null,{default:s(()=>[t(e(V),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(D),{class:"text-sm font-medium"},{default:s(()=>[...o[6]||(o[6]=[p("Total Nominal",-1)])]),_:1}),t(e(le),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(S),null,{default:s(()=>[i("div",Me,k(c(u.statistics.total_amount)),1),o[7]||(o[7]=i("p",{class:"text-xs text-muted-foreground"},"Total topup berhasil",-1))]),_:1})]),_:1})]))}}),Ie={class:"rounded-xl p-4 space-y-6 py-6"},Ke={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Be={class:"flex flex-1 gap-4"},Ne={class:"relative flex-1 max-w-sm"},Pe={class:"rounded-md border"},ut=H({__name:"Index",props:{topups:{},statistics:{},filters:{}},setup(u){const c=u,f=y(c.filters.search||""),o=y(c.filters.status||"all"),x=y([{id:c.filters.sort_by||"created_at",desc:c.filters.sort_order==="desc"}]),M=y([]),A=y({}),g=y({open:!1,topup:null}),_=y({open:!1,topup:null}),T=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),J=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),X=a=>({pending:"secondary",completed:"default",failed:"destructive"})[a]||"secondary",Z=a=>{g.value={open:!0,topup:a}},G=()=>{if(!g.value.topup)return;L({}).post(Y.url(g.value.topup.id),{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,topup:null}}})},O=a=>{_.value={open:!0,topup:a}},Q=()=>{if(!_.value.topup)return;L({}).post(ee.url(_.value.topup.id),{preserveScroll:!0,onSuccess:()=>{_.value={open:!1,topup:null}}})},I=[{id:"index",header:()=>n("div",{class:"w-12"},"No"),cell:({row:a})=>{const l=a.index+1+(c.topups.current_page-1)*c.topups.per_page;return n("div",{class:"font-medium"},l)}},{accessorKey:"customer.name",header:({column:a})=>n(j,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Pelanggan",n(ie,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>{const l=a.original.customer;return n("div",[n("div",{class:"font-medium"},l.name),n("div",{class:"text-xs text-muted-foreground"},l.email)])}},{accessorKey:"amount",header:()=>"Jumlah",cell:({row:a})=>n("div",{class:"font-bold"},T(a.getValue("amount")))},{accessorKey:"payment_method",header:()=>"Metode",cell:({row:a})=>n("div",{class:"uppercase"},a.getValue("payment_method"))},{accessorKey:"transaction_ref",header:()=>"Referensi",cell:({row:a})=>n("div",{class:"font-mono text-xs"},a.getValue("transaction_ref"))},{accessorKey:"status",header:()=>"Status",cell:({row:a})=>{const l=a.getValue("status");return n(_e,{variant:X(l)},()=>l)}},{accessorKey:"created_at",header:()=>"Tanggal",cell:({row:a})=>n("div",{class:"text-sm"},J(a.getValue("created_at")))},{id:"actions",header:()=>n("div",{class:"text-right"},"Aksi"),cell:({row:a})=>{const l=a.original;return l.status!=="pending"?null:n("div",{class:"flex justify-end gap-2"},[n(j,{size:"sm",onClick:()=>Z(l)},()=>[n(de,{class:"mr-1 h-4 w-4"}),"Setujui"]),n(j,{size:"sm",variant:"destructive",onClick:()=>O(l)},()=>[n(pe,{class:"mr-1 h-4 w-4"}),"Tolak"])])}}],h=oe({get data(){return c.topups.data},columns:I,getCoreRowModel:fe(),getSortedRowModel:ce(),getFilteredRowModel:me(),onSortingChange:a=>R(a,x),onColumnFiltersChange:a=>R(a,M),onColumnVisibilityChange:a=>R(a,A),state:{get sorting(){return x.value},get columnFilters(){return M.value},get columnVisibility(){return A.value}},manualSorting:!0});B(x,a=>{a.length>0&&N.get("/admin/topups",{search:f.value||void 0,status:o.value!=="all"?o.value:void 0,sort_by:a[0].id,sort_order:a[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let K;return B([f,o],()=>{clearTimeout(K),K=setTimeout(()=>{N.get("/admin/topups",{search:f.value||void 0,status:o.value!=="all"?o.value:void 0,sort_by:x.value[0]?.id||"created_at",sort_order:x.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(a,l)=>(d(),b(w,null,[t(e(re),{title:"Permintaan Top Up"}),t(W,null,{default:s(()=>[i("div",Ie,[l[10]||(l[10]=i("div",null,[i("h2",{class:"text-3xl font-bold tracking-tight"},"Permintaan Top Up"),i("p",{class:"text-muted-foreground"},"Kelola permintaan top up saldo dari pelanggan")],-1)),t(Ae,{statistics:u.statistics},null,8,["statistics"]),i("div",Ke,[i("div",Be,[i("div",Ne,[t(e(ne),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(we),{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=r=>f.value=r),placeholder:"Cari pelanggan atau referensi...",class:"pl-9"},null,8,["modelValue"])]),t(e($e),{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=r=>o.value=r)},{default:s(()=>[t(e(ke),{class:"w-[180px]"},{default:s(()=>[t(e(he),{placeholder:"Semua Status"})]),_:1}),t(e(Ce),null,{default:s(()=>[t(e(F),{value:"all"},{default:s(()=>[...l[4]||(l[4]=[p("Semua Status",-1)])]),_:1}),t(e(F),{value:"pending"},{default:s(()=>[...l[5]||(l[5]=[p("Pending",-1)])]),_:1}),t(e(F),{value:"completed"},{default:s(()=>[...l[6]||(l[6]=[p("Completed",-1)])]),_:1}),t(e(F),{value:"failed"},{default:s(()=>[...l[7]||(l[7]=[p("Failed",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(ve),null,{default:s(()=>[t(e(xe),{"as-child":""},{default:s(()=>[t(e(j),{variant:"outline",class:"ml-auto"},{default:s(()=>[l[8]||(l[8]=p(" Kolom ",-1)),t(e(ue),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(ye),{align:"end"},{default:s(()=>[(d(!0),b(w,null,$(e(h).getAllColumns().filter(r=>r.getCanHide()),r=>(d(),v(e(be),{key:r.id,class:"capitalize","model-value":r.getIsVisible(),"onUpdate:modelValue":m=>{r.toggleVisibility(!!m)}},{default:s(()=>[p(k(r.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),i("div",Pe,[t(e(Se),null,{default:s(()=>[t(e(Ve),null,{default:s(()=>[(d(!0),b(w,null,$(e(h).getHeaderGroups(),r=>(d(),v(e(U),{key:r.id},{default:s(()=>[(d(!0),b(w,null,$(r.headers,m=>(d(),v(e(De),{key:m.id},{default:s(()=>[m.isPlaceholder?P("",!0):(d(),v(e(z),{key:0,render:m.column.columnDef.header,props:m.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(je),null,{default:s(()=>[e(h).getRowModel().rows?.length?(d(!0),b(w,{key:0},$(e(h).getRowModel().rows,r=>(d(),v(e(U),{key:r.id},{default:s(()=>[(d(!0),b(w,null,$(r.getVisibleCells(),m=>(d(),v(e(E),{key:m.id},{default:s(()=>[t(e(z),{render:m.column.columnDef.cell,props:m.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(d(),v(e(U),{key:1},{default:s(()=>[t(e(E),{colspan:I.length,class:"h-24 text-center"},{default:s(()=>[...l[9]||(l[9]=[p(" Tidak ada permintaan topup. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),u.topups.last_page>1?(d(),v(ge,{key:0,data:{current_page:u.topups.current_page,last_page:u.topups.last_page,per_page:u.topups.per_page,from:(u.topups.current_page-1)*u.topups.per_page+1,to:Math.min(u.topups.current_page*u.topups.per_page,u.topups.total),total:u.topups.total},url:"/admin/topups",filters:{search:f.value||void 0,status:o.value!=="all"?o.value:void 0,sort_by:x.value[0]?.id||"created_at",sort_order:x.value[0]?.desc?"desc":"asc"}},null,8,["data","filters"])):P("",!0)]),t(q,{open:g.value.open,"onUpdate:open":l[2]||(l[2]=r=>g.value.open=r),title:"Setujui Top Up?",description:`Apakah Anda yakin ingin menyetujui permintaan top up sebesar ${g.value.topup?T(g.value.topup.amount):""} untuk ${g.value.topup?.customer.name}?`,"confirm-text":"Setujui","cancel-text":"Batal",onConfirm:G},null,8,["open","description"]),t(q,{open:_.value.open,"onUpdate:open":l[3]||(l[3]=r=>_.value.open=r),title:"Tolak Top Up?",description:`Apakah Anda yakin ingin menolak permintaan top up sebesar ${_.value.topup?T(_.value.topup.amount):""} dari ${_.value.topup?.customer.name}?`,"confirm-text":"Tolak","cancel-text":"Batal",variant:"destructive",onConfirm:Q},null,8,["open","description"])]),_:1})],64))}});export{ut as default};
