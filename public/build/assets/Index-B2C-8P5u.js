import{o as C,_ as se,q as ae,v as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-DZrLECOS.js";import{_ as q}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-DA4pNA17.js";import{_ as ne}from"./Pagination.vue_vue_type_script_setup_true_lang-CQM_G0lK.js";import{a as V,_ as D}from"./CardContent.vue_vue_type_script_setup_true_lang-LKEwQoWP.js";import{_ as A}from"./CardHeader.vue_vue_type_script_setup_true_lang-N3E9ALN1.js";import{_ as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-Mk0zvokq.js";import{d as X,v as w,g as u,b as t,w as a,u as e,s as m,ax as oe,e as i,K as j,at as Z,aU as G,r as y,q as ue,E as P,j as z,c as p,a1 as ie,t as E,Z as de,aa as ce,F as k,x as $,y as H,n as o,D as L,ao as me,aM as fe,A as pe,B as _e}from"./vendor-FclwbLvj.js";import{_ as ge}from"./index-CRPqrtU2.js";import{_ as R,v as M}from"./index-B4cH97KR.js";import{_ as ve,a as xe,b as ye}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D90ORJgI.js";import{_ as be}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-BsPeayAj.js";import{_ as we}from"./Input.vue_vue_type_script_setup_true_lang-ZVESK4JK.js";import{_ as ke,a as $e,b as he,c as Ce,d as S}from"./SelectValue.vue_vue_type_script_setup_true_lang-BqISnkMA.js";import{_ as Re,a as Se,b as U,c as je,d as Ve,e as O}from"./TableHeader.vue_vue_type_script_setup_true_lang-BhZiDflO.js";import{u as De}from"./usePermissions-DzkwVpfD.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-ByVucR83.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-9OZOAxj9.js";import"./index-B_n2dl-_.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ZLo4HemS.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DuXcz617.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-D_xJ4jwR.js";const Ae={class:"grid gap-4 md:grid-cols-3"},Fe={class:"text-2xl font-bold"},Me={class:"text-2xl font-bold"},Ue={class:"text-2xl font-bold"},Te=X({__name:"ReturnStatistics",props:{statistics:{}},setup(n){return(T,d)=>(u(),w("div",Ae,[t(e(D),null,{default:a(()=>[t(e(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[0]||(d[0]=[m("Pending",-1)])]),_:1}),t(e(oe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:a(()=>[i("div",Fe,j(n.statistics.total_pending),1),d[1]||(d[1]=i("p",{class:"text-xs text-muted-foreground"},"Menunggu persetujuan",-1))]),_:1})]),_:1}),t(e(D),null,{default:a(()=>[t(e(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[2]||(d[2]=[m("Disetujui",-1)])]),_:1}),t(e(Z),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:a(()=>[i("div",Me,j(n.statistics.total_approved),1),d[3]||(d[3]=i("p",{class:"text-xs text-muted-foreground"},"Retur disetujui",-1))]),_:1})]),_:1}),t(e(D),null,{default:a(()=>[t(e(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(F),{class:"text-sm font-medium"},{default:a(()=>[...d[4]||(d[4]=[m("Ditolak",-1)])]),_:1}),t(e(G),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(V),null,{default:a(()=>[i("div",Ue,j(n.statistics.total_rejected),1),d[5]||(d[5]=i("p",{class:"text-xs text-muted-foreground"},"Retur ditolak",-1))]),_:1})]),_:1})]))}}),Be={class:"rounded-xl p-4 space-y-6 py-6"},Ke={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},Ie={class:"flex flex-1 gap-4"},Ne={class:"relative flex-1 max-w-sm"},qe={class:"rounded-md border"},it=X({__name:"Index",props:{returns:{},statistics:{},filters:{}},setup(n){const{isSuperAdmin:T,isAdmin:d}=De(),_=n,J=[{title:"Retur & Refund",href:C.url()}],b=y(_.filters.search||""),f=y(_.filters.status||"all"),g=y([{id:_.filters.sort_by,desc:_.filters.sort_order==="desc"}]),B=y([]),K=y({}),v=y({open:!1,return:null}),x=y({open:!1,return:null}),Q=r=>r?new Date(r).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",W=r=>({pending:"secondary",approved:"default",rejected:"destructive"})[r]||"secondary",Y=r=>{v.value={open:!0,return:r}},ee=()=>{if(!v.value.return)return;L({}).post(ae.url(v.value.return.id),{preserveScroll:!0,onSuccess:()=>{v.value={open:!1,return:null}}})},te=r=>{x.value={open:!0,return:r}},re=()=>{if(!x.value.return)return;L({}).post(le.url(x.value.return.id),{preserveScroll:!0,onSuccess:()=>{x.value={open:!1,return:null}}})},I=[{id:"index",header:()=>o("div",{class:"w-12"},"No"),cell:({row:r})=>{const s=r.index+1+(_.returns.current_page-1)*_.returns.per_page;return o("div",{class:"font-medium"},s)}},{accessorKey:"order.order_number",header:({column:r})=>o(R,{variant:"ghost",onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),class:"-ml-4"},()=>["Order",o(me,{class:"ml-2 h-4 w-4"})]),cell:({row:r})=>{const s=r.original.order;return s?o("div",[o("div",{class:"font-medium"},s.order_number),o("div",{class:"text-xs text-muted-foreground"},s.customer?.name||"Unknown")]):o("div",{class:"text-muted-foreground"},"N/A")}},{accessorKey:"reason",header:()=>"Alasan",cell:({row:r})=>o("div",{class:"max-w-xs truncate"},r.getValue("reason"))},{accessorKey:"status",header:()=>"Status",cell:({row:r})=>{const s=r.getValue("status");return o(ge,{variant:W(s)},()=>s)}},{accessorKey:"requested_at",header:()=>"Tanggal Permintaan",cell:({row:r})=>Q(r.getValue("requested_at"))},{id:"actions",header:()=>o("div",{class:"text-right"},"Actions"),cell:({row:r})=>{const s=r.original;if(s.status!=="pending")return null;const l=[];return(T||d)&&l.push(o(R,{variant:"default",size:"sm",onClick:()=>Y(s)},()=>o(Z,{class:"h-4 w-4"})),o(R,{variant:"destructive",size:"sm",onClick:()=>te(s)},()=>o(G,{class:"h-4 w-4"}))),o("div",{class:"flex justify-end gap-2"},l)}}],h=ue({get data(){return _.returns.data},columns:I,getCoreRowModel:_e(),getSortedRowModel:pe(),getFilteredRowModel:fe(),onSortingChange:r=>M(r,g),onColumnFiltersChange:r=>M(r,B),onColumnVisibilityChange:r=>M(r,K),state:{get sorting(){return g.value},get columnFilters(){return B.value},get columnVisibility(){return K.value}},manualSorting:!0});P(g,r=>{r.length>0&&z.get(C.url(),{search:b.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:r[0].id,sort_order:r[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let N;return P([b,f],()=>{clearTimeout(N),N=setTimeout(()=>{z.get(C.url(),{search:b.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:g.value[0]?.id||"created_at",sort_order:g.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(r,s)=>(u(),p(se,{breadcrumbs:J},{default:a(()=>[t(e(ie),{title:"Retur & Refund"}),i("div",Be,[s[10]||(s[10]=i("div",{class:"flex items-center justify-between"},[i("div",null,[i("h1",{class:"text-3xl font-bold tracking-tight"},"Retur & Refund"),i("p",{class:"text-muted-foreground"},"Kelola permintaan retur produk")])],-1)),t(Te,{statistics:n.statistics},null,8,["statistics"]),i("div",Ke,[i("div",Ie,[i("div",Ne,[t(e(de),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(we),{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=l=>b.value=l),placeholder:"Cari order atau customer...",class:"pl-9"},null,8,["modelValue"])]),t(e(ke),{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=l=>f.value=l)},{default:a(()=>[t(e($e),{class:"w-[180px]"},{default:a(()=>[t(e(he),{placeholder:"Semua Status"})]),_:1}),t(e(Ce),null,{default:a(()=>[t(e(S),{value:"all"},{default:a(()=>[...s[4]||(s[4]=[m("Semua Status",-1)])]),_:1}),t(e(S),{value:"pending"},{default:a(()=>[...s[5]||(s[5]=[m("Pending",-1)])]),_:1}),t(e(S),{value:"approved"},{default:a(()=>[...s[6]||(s[6]=[m("Approved",-1)])]),_:1}),t(e(S),{value:"rejected"},{default:a(()=>[...s[7]||(s[7]=[m("Rejected",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(e(ve),null,{default:a(()=>[t(e(xe),{"as-child":""},{default:a(()=>[t(e(R),{variant:"outline",class:"ml-auto"},{default:a(()=>[s[8]||(s[8]=m(" Kolom ",-1)),t(e(ce),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),t(e(ye),{align:"end"},{default:a(()=>[(u(!0),w(k,null,$(e(h).getAllColumns().filter(l=>l.getCanHide()),l=>(u(),p(e(be),{key:l.id,class:"capitalize","model-value":l.getIsVisible(),"onUpdate:modelValue":c=>{l.toggleVisibility(!!c)}},{default:a(()=>[m(j(l.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),i("div",qe,[t(e(Re),null,{default:a(()=>[t(e(Se),null,{default:a(()=>[(u(!0),w(k,null,$(e(h).getHeaderGroups(),l=>(u(),p(e(U),{key:l.id},{default:a(()=>[(u(!0),w(k,null,$(l.headers,c=>(u(),p(e(je),{key:c.id},{default:a(()=>[c.isPlaceholder?E("",!0):(u(),p(e(H),{key:0,render:c.column.columnDef.header,props:c.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(e(Ve),null,{default:a(()=>[e(h).getRowModel().rows?.length?(u(!0),w(k,{key:0},$(e(h).getRowModel().rows,l=>(u(),p(e(U),{key:l.id},{default:a(()=>[(u(!0),w(k,null,$(l.getVisibleCells(),c=>(u(),p(e(O),{key:c.id},{default:a(()=>[t(e(H),{render:c.column.columnDef.cell,props:c.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(u(),p(e(U),{key:1},{default:a(()=>[t(e(O),{colspan:I.length,class:"h-24 text-center"},{default:a(()=>[...s[9]||(s[9]=[m(" Tidak ada data retur. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),n.returns.last_page>1?(u(),p(ne,{key:0,data:{current_page:n.returns.current_page,last_page:n.returns.last_page,per_page:n.returns.per_page,from:(n.returns.current_page-1)*n.returns.per_page+1,to:Math.min(n.returns.current_page*n.returns.per_page,n.returns.total),total:n.returns.total},url:e(C).url(),filters:{search:b.value||void 0,status:f.value!=="all"?f.value:void 0,sort_by:g.value[0]?.id||"created_at",sort_order:g.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):E("",!0)]),t(q,{open:v.value.open,"onUpdate:open":s[2]||(s[2]=l=>v.value.open=l),title:"Setujui Retur?",description:`Apakah Anda yakin ingin menyetujui permintaan retur untuk order ${v.value.return?.order.order_number}?`,"confirm-text":"Setujui","cancel-text":"Batal",onConfirm:ee},null,8,["open","description"]),t(q,{open:x.value.open,"onUpdate:open":s[3]||(s[3]=l=>x.value.open=l),title:"Tolak Retur?",description:`Apakah Anda yakin ingin menolak permintaan retur untuk order ${x.value.return?.order.order_number}?`,"confirm-text":"Tolak","cancel-text":"Batal",variant:"destructive",onConfirm:re},null,8,["open","description"])]),_:1}))}});export{it as default};
