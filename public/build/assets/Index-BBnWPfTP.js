import{T as I,V as re,_ as ie,X as ue,Y as de,Z as ce,$ as me}from"./AppLayout.vue_vue_type_script_setup_true_lang-BldiSP6C.js";import{_ as F}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-BcS36dg9.js";import{_ as fe}from"./Pagination.vue_vue_type_script_setup_true_lang-DDSBjCI_.js";import{_ as ge}from"./index-B-GP7Yui.js";import{_ as p,v as T}from"./index-D0F1m2iO.js";import{_ as N,a as z}from"./CardContent.vue_vue_type_script_setup_true_lang-C6T_ici3.js";import{_ as H}from"./CardHeader.vue_vue_type_script_setup_true_lang-CRP91wSD.js";import{_ as L}from"./CardTitle.vue_vue_type_script_setup_true_lang-516RZaNE.js";import{_ as pe,a as _e,b as ve}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DIwj58eL.js";import{_ as be}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-fKcU2LtC.js";import{_ as xe}from"./Input.vue_vue_type_script_setup_true_lang-DTUDRkJ-.js";import{_ as he,a as ye,b as ke,c as Se,d as M}from"./SelectValue.vue_vue_type_script_setup_true_lang-CI1mGqPa.js";import{_ as we,a as Ce,b as j,c as Re,d as $e,e as E}from"./TableHeader.vue_vue_type_script_setup_true_lang-DVvamDtf.js";import{d as De,r as m,p as q,q as Be,E as X,j as R,c as _,g as r,w as l,b as a,e as i,u as t,a0 as Ve,v as S,t as Y,s as d,Y as Ie,cS as Te,K as w,au as Fe,aq as Z,Z as Me,cT as je,a9 as Ue,F as $,x as D,y as G,n as o,D as J,an as O,cx as Ae,aM as Pe,ap as Ke,z as Ne,aG as ze,A as He,B as Le}from"./vendor-D8oi4p-n.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-CKGKFyAW.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Z0lQTrLO.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CRzWMqkE.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DkSEZT8X.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-oX1NJi3Y.js";const Ee={class:"rounded-xl p-4 space-y-6 py-6"},qe={class:"flex items-center justify-between"},Xe={class:"grid gap-4 md:grid-cols-2"},Ye={class:"text-2xl font-bold"},Ze={class:"text-xs text-muted-foreground"},Ge={class:"text-2xl font-bold"},Je={class:"text-xs text-muted-foreground"},Oe={key:0,class:"flex items-center justify-between rounded-lg border bg-muted/50 p-4"},We={class:"text-sm font-medium"},Qe={class:"flex items-center gap-4"},et={class:"relative flex-1"},tt={class:"rounded-md border"},kt=De({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(x){const f=x,W=[{title:"Bonus Regular",href:I.url()}],h=m(f.filters.search||""),c=m(f.filters.status?.toString()||"all"),v=m([{id:f.filters.sort_by,desc:f.filters.sort_order==="desc"}]),U=m([]),A=m({}),C=m({}),y=m({open:!1,bonus:null}),g=m({open:!1,bonus:null}),B=m({open:!1}),Q=q(()=>Object.keys(C.value).map(e=>f.bonuses.data[parseInt(e)]).filter(Boolean)),k=q(()=>Q.value.filter(e=>e.status===0)),b=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),ee=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),te=e=>{y.value={open:!0,bonus:e}},se=()=>{y.value.bonus&&R.delete(ue.url(y.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{y.value={open:!1,bonus:null}}})},ae=e=>{g.value={open:!0,bonus:e}},le=()=>{if(!g.value.bonus)return;J({}).post(de.url(g.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,bonus:null},C.value={}}})},ne=()=>{k.value.length&&(B.value.open=!0)},oe=()=>{const e=k.value.map(n=>n.id);J({bonus_ids:e}).post(ce.url(),{preserveScroll:!0,onSuccess:()=>{C.value={},B.value.open=!1}})},P=[{id:"select",header:({table:e})=>o("input",{type:"checkbox",checked:e.getIsAllPageRowsSelected(),indeterminate:e.getIsSomePageRowsSelected(),onChange:e.getToggleAllPageRowsSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),cell:({row:e})=>o("input",{type:"checkbox",checked:e.getIsSelected(),disabled:!e.getCanSelect(),onChange:e.getToggleSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),enableSorting:!1},{id:"index",header:()=>o("div",{class:"w-12"},"No"),cell:({row:e})=>{const s=e.index+1+(f.bonuses.current_page-1)*f.bonuses.per_page;return o("div",{class:"font-medium"},s)}},{accessorKey:"member_name",header:({column:e})=>o(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Member",o(O,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>o("div",[o("div",{class:"font-medium"},e.original.member_name),o("div",{class:"text-xs text-muted-foreground"},e.original.member_ewallet_id)])},{accessorKey:"amount",header:()=>o("div",{class:"text-right"},"Jumlah"),cell:({row:e})=>o("div",{class:"text-right"},[o("div",{class:"font-medium"},b(e.original.amount)),o("div",{class:"text-xs text-muted-foreground"},`Tax: ${b(e.original.tax_amount)}`),o("div",{class:"text-xs text-green-600"},`Netto: ${b(e.original.tax_netto)}`)])},{accessorKey:"status",header:()=>"Status",cell:({row:e})=>{const s=e.original.status;return o(ge,{variant:s===1?"default":"secondary",class:"gap-1"},()=>[o(s===1?Ae:Pe,{class:"h-3 w-3"}),e.original.status_text])}},{accessorKey:"created_at",header:({column:e})=>o(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",o(O,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>ee(e.getValue("created_at"))},{id:"actions",header:()=>o("div",{class:"text-right"},"Actions"),cell:({row:e})=>{const s=e.original;return o("div",{class:"flex justify-end gap-2"},[o(p,{variant:"outline",size:"sm",onClick:()=>R.visit(me.url(s.id))},()=>o(Ke,{class:"h-4 w-4"})),s.status===0?o(p,{variant:"default",size:"sm",onClick:()=>ae(s)},()=>o(Z,{class:"h-4 w-4"})):null,s.status===0?o(p,{variant:"outline",size:"sm",onClick:()=>te(s)},()=>o(Ne,{class:"h-4 w-4 text-destructive"})):null])}}],V=Be({get data(){return f.bonuses.data},columns:P,getCoreRowModel:Le(),getSortedRowModel:He(),getFilteredRowModel:ze(),state:{get sorting(){return v.value},get columnFilters(){return U.value},get columnVisibility(){return A.value},get rowSelection(){return C.value}},onSortingChange:e=>T(e,v),onColumnFiltersChange:e=>T(e,U),onColumnVisibilityChange:e=>T(e,A),onRowSelectionChange:e=>T(e,C),manualSorting:!0,enableRowSelection:!0});X(v,e=>{e.length>0&&R.get(I.url(),{search:h.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:e[0].id,sort_order:e[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let K;return X([h,c],()=>{clearTimeout(K),K=setTimeout(()=>{R.get(I.url(),{search:h.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(e,s)=>(r(),_(ie,{breadcrumbs:W},{default:l(()=>[a(t(Ve),{title:"Bonus Regular"}),i("div",Ee,[i("div",qe,[s[7]||(s[7]=i("div",null,[i("h1",{class:"text-3xl font-bold tracking-tight"},"Bonus Regular"),i("p",{class:"text-muted-foreground"},"Kelola bonus reguler member")],-1)),a(t(p),{onClick:s[0]||(s[0]=n=>t(R).visit(t(re).url()))},{default:l(()=>[a(t(Ie),{class:"h-4 w-4"}),s[6]||(s[6]=d(" Tambah Bonus ",-1))]),_:1})]),i("div",Xe,[a(t(N),null,{default:l(()=>[a(t(H),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[a(t(L),{class:"text-sm font-medium"},{default:l(()=>[...s[8]||(s[8]=[d("Total Pending",-1)])]),_:1}),a(t(Te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(t(z),null,{default:l(()=>[i("div",Ye,w(b(x.statistics.total_pending)),1),i("p",Ze,w(x.statistics.count_pending)+" bonus ",1)]),_:1})]),_:1}),a(t(N),null,{default:l(()=>[a(t(H),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[a(t(L),{class:"text-sm font-medium"},{default:l(()=>[...s[9]||(s[9]=[d("Total Released",-1)])]),_:1}),a(t(Fe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(t(z),null,{default:l(()=>[i("div",Ge,w(b(x.statistics.total_released)),1),i("p",Je,w(x.statistics.count_released)+" bonus ",1)]),_:1})]),_:1})]),k.value.length>0?(r(),S("div",Oe,[i("p",We,w(k.value.length)+" bonus pending dipilih ",1),a(t(p),{size:"sm",onClick:ne},{default:l(()=>[a(t(Z),{class:"h-4 w-4"}),s[10]||(s[10]=d(" Release Semua ",-1))]),_:1})])):Y("",!0),i("div",Qe,[i("div",et,[a(t(Me),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a(t(xe),{modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=n=>h.value=n),placeholder:"Cari member atau deskripsi...",class:"pl-9"},null,8,["modelValue"])]),a(t(he),{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=n=>c.value=n)},{default:l(()=>[a(t(ye),{class:"w-40"},{default:l(()=>[a(t(ke),{placeholder:"Semua Status"})]),_:1}),a(t(Se),null,{default:l(()=>[a(t(M),{value:"all"},{default:l(()=>[...s[11]||(s[11]=[d("Semua Status",-1)])]),_:1}),a(t(M),{value:"0"},{default:l(()=>[...s[12]||(s[12]=[d("Pending",-1)])]),_:1}),a(t(M),{value:"1"},{default:l(()=>[...s[13]||(s[13]=[d("Released",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(t(pe),null,{default:l(()=>[a(t(_e),{"as-child":""},{default:l(()=>[a(t(p),{variant:"outline",class:"ml-auto"},{default:l(()=>[a(t(je),{class:"h-4 w-4"}),s[14]||(s[14]=d(" Kolom ",-1)),a(t(Ue),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),a(t(ve),{align:"end"},{default:l(()=>[(r(!0),S($,null,D(t(V).getAllColumns().filter(n=>n.getCanHide()),n=>(r(),_(t(be),{key:n.id,class:"capitalize",checked:n.getIsVisible(),"onUpdate:checked":u=>n.toggleVisibility(!!u)},{default:l(()=>[d(w(n.id),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1})]),i("div",tt,[a(t(we),null,{default:l(()=>[a(t(Ce),null,{default:l(()=>[(r(!0),S($,null,D(t(V).getHeaderGroups(),n=>(r(),_(t(j),{key:n.id},{default:l(()=>[(r(!0),S($,null,D(n.headers,u=>(r(),_(t(Re),{key:u.id},{default:l(()=>[u.isPlaceholder?Y("",!0):(r(),_(t(G),{key:0,render:u.column.columnDef.header,props:u.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),a(t($e),null,{default:l(()=>[t(V).getRowModel().rows?.length?(r(!0),S($,{key:0},D(t(V).getRowModel().rows,n=>(r(),_(t(j),{key:n.id,"data-state":n.getIsSelected()?"selected":void 0},{default:l(()=>[(r(!0),S($,null,D(n.getVisibleCells(),u=>(r(),_(t(E),{key:u.id},{default:l(()=>[a(t(G),{render:u.column.columnDef.cell,props:u.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(r(),_(t(j),{key:1},{default:l(()=>[a(t(E),{colspan:P.length,class:"h-24 text-center"},{default:l(()=>[...s[15]||(s[15]=[d(" Tidak ada data bonus. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),a(fe,{data:x.bonuses,url:t(I).url(),filters:{search:h.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:v.value[0]?.id,sort_order:v.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])]),a(F,{open:y.value.open,"onUpdate:open":s[3]||(s[3]=n=>y.value.open=n),title:"Hapus Bonus?",description:"Apakah Anda yakin ingin menghapus bonus ini? Tindakan ini tidak dapat dibatalkan.","confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:se},null,8,["open"]),a(F,{open:g.value.open,"onUpdate:open":s[4]||(s[4]=n=>g.value.open=n),title:"Release Bonus?",description:`Bonus sebesar ${g.value.bonus?b(g.value.bonus.tax_netto):""} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release","cancel-text":"Batal",onConfirm:le},null,8,["open","description"]),a(F,{open:B.value.open,"onUpdate:open":s[5]||(s[5]=n=>B.value.open=n),title:`Release ${k.value.length} Bonus?`,description:`Total ${b(k.value.reduce((n,u)=>n+u.tax_netto,0))} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release Semua","cancel-text":"Batal",onConfirm:oe},null,8,["open","title","description"])]),_:1}))}});export{kt as default};
