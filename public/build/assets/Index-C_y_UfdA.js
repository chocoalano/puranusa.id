import{R as $,_ as _e,S as ve,T as be,V as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNFjYB-7.js";import{_ as A}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-BFGhJpjt.js";import{_ as we}from"./Pagination.vue_vue_type_script_setup_true_lang-DQuybfRy.js";import{_ as he}from"./index-DyUpvQGF.js";import{_ as D,v as V}from"./index-Dgwk259n.js";import{_ as M,a as N}from"./CardContent.vue_vue_type_script_setup_true_lang-CPgAkxDh.js";import{_ as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-CDPuo1h4.js";import{_ as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-DjmDdGQ7.js";import{_ as O}from"./Checkbox.vue_vue_type_script_setup_true_lang-yx4_pKg1.js";import{_ as ye,a as Se,b as Re,d as Ce,e as z,c as W}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BNRb2ZrY.js";import{d as ke,r as c,d0 as $e,p as X,q as De,E as Y,j as B,v as x,g as u,b as s,w as l,u as t,e as o,ai as Ve,t as K,s as i,F as w,am as Z,z as Be,a0 as Fe,av as Ie,Y as Te,cx as G,K as _,d7 as Ae,aL as Me,c as v,Z as Ne,x as F,y as J,n as r,D as Q,an as Ue,T as je,cy as Ke,aF as Le,A as Pe,B as He}from"./vendor-u69_SgX4.js";import{_ as Ee}from"./Input.vue_vue_type_script_setup_true_lang-B09zx5te.js";import{_ as qe,a as Oe,b as ze,c as We,d as I}from"./SelectValue.vue_vue_type_script_setup_true_lang-Dglpcc31.js";import{_ as Xe,a as Ye,b as L,c as Ze,d as Ge,e as ee}from"./TableHeader.vue_vue_type_script_setup_true_lang-C0WMCBTo.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-dvnhmmY7.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BW0SaXTm.js";import"./index-DqFeuJ-n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-41k4hIm2.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-_3dn1dX5.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CbM4MXOh.js";const Je={class:"flex h-full flex-1 flex-col gap-6 p-6"},Qe={class:"flex items-center justify-between"},et={class:"text-3xl font-bold tracking-tight flex items-center gap-2"},tt={class:"grid gap-4 md:grid-cols-4"},st={class:"text-2xl font-bold"},at={class:"text-xs text-muted-foreground"},lt={class:"text-2xl font-bold text-green-600"},nt={class:"text-xs text-muted-foreground"},ot={class:"text-2xl font-bold text-red-600"},rt={class:"text-xs text-muted-foreground"},it={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},ut={class:"flex flex-1 items-center gap-4"},dt={class:"relative flex-1 md:max-w-sm"},mt={class:"rounded-md border"},Tt=ke({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(f){const p=f,te=[{title:"Bonus Lifetime Cash Reward",href:$.url()}],h=c(p.filters.search||""),g=c(p.filters.status?.toString()||"all"),y=c([{id:p.filters.sort_by,desc:p.filters.sort_order==="desc"}]),P=c([]),H=c({}),S=c({}),[se,ae]=$e(),b=c({open:!1,bonus:null}),m=c({open:!1,bonus:null}),k=c({open:!1}),le=X(()=>Object.keys(S.value).map(e=>p.bonuses.data[parseInt(e)]).filter(Boolean)),R=X(()=>le.value.filter(e=>e.status===0)),C=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),ne=e=>new Intl.NumberFormat("id-ID").format(e),oe=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),re=e=>{switch(e){case 1:return"default";case 2:return"destructive";default:return"secondary"}},ie=e=>{switch(e){case 1:return Ke;case 2:return je;default:return G}},ue=e=>{b.value={open:!0,bonus:e}},de=()=>{b.value.bonus&&B.delete(ve.url(b.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{b.value={open:!1,bonus:null}}})},me=e=>{m.value={open:!0,bonus:e}},ce=()=>{if(!m.value.bonus)return;Q({}).post(be.url(m.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{m.value={open:!1,bonus:null},S.value={}}})},fe=()=>{R.value.length&&(k.value.open=!0)},pe=()=>{const e=R.value.map(n=>n.id);Q({ids:e}).post(xe.url(),{preserveScroll:!0,onSuccess:()=>{S.value={},k.value.open=!1}})},E=[{id:"select",header:({table:e})=>r(O,{modelValue:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":a=>e.toggleAllPageRowsSelected(!!a),ariaLabel:"Select all"}),cell:({row:e})=>r(O,{modelValue:e.getIsSelected(),"onUpdate:modelValue":a=>e.toggleSelected(!!a),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>r("div",{class:"w-12"},"No"),cell:({row:e})=>r("div",{class:"font-medium"},e.index+1+(p.bonuses.current_page-1)*p.bonuses.per_page)},{accessorKey:"member_name",header:()=>"Member",cell:({row:e})=>r("div",[r("div",{class:"font-medium"},e.original.member_name),r("div",{class:"text-xs text-muted-foreground"},e.original.member_ewallet_id)])},{accessorKey:"reward_name",header:()=>"Nama Reward",cell:({row:e})=>r("div",{class:"font-medium"},e.original.reward_name)},{accessorKey:"reward",header:()=>r("div",{class:"text-right"},"Reward"),cell:({row:e})=>r("div",{class:"text-right font-medium"},C(e.original.reward))},{accessorKey:"bv",header:()=>r("div",{class:"text-right"},"BV"),cell:({row:e})=>r("div",{class:"text-right text-muted-foreground"},ne(e.original.bv))},{accessorKey:"status",header:()=>"Status",cell:({row:e})=>r(he,{variant:re(e.original.status),class:"gap-1"},()=>[r(ie(e.original.status),{class:"h-3 w-3"}),e.original.status_text])},{accessorKey:"created_at",header:({column:e})=>r(D,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",r(Ue,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>oe(e.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:e})=>r(ae,{bonus:e.original,onRelease:()=>me(e.original),onDelete:()=>ue(e.original)})}],T=De({get data(){return p.bonuses.data},columns:E,getCoreRowModel:He(),getSortedRowModel:Pe(),getFilteredRowModel:Le(),onSortingChange:e=>V(e,y),onColumnFiltersChange:e=>V(e,P),onColumnVisibilityChange:e=>V(e,H),onRowSelectionChange:e=>V(e,S),state:{get sorting(){return y.value},get columnFilters(){return P.value},get columnVisibility(){return H.value},get rowSelection(){return S.value}},manualSorting:!0,enableRowSelection:!0});Y(y,e=>{e.length>0&&B.get($.url(),{search:h.value||void 0,status:g.value!=="all"?parseInt(g.value):void 0,sort_by:e[0].id,sort_order:e[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let q;return Y([h,g],()=>{clearTimeout(q),q=setTimeout(()=>{B.get($.url(),{search:h.value||void 0,status:g.value!=="all"?parseInt(g.value):void 0,sort_by:y.value[0]?.id||"created_at",sort_order:y.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(e,a)=>(u(),x(w,null,[s(t(se),null,{default:l(({bonus:n,onRelease:d,onDelete:ge})=>[s(t(ye),null,{default:l(()=>[s(t(Se),{"as-child":""},{default:l(()=>[s(t(D),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[a[6]||(a[6]=o("span",{class:"sr-only"},"Open menu",-1)),s(t(Ve),{class:"h-4 w-4"})]),_:1})]),_:1}),s(t(Re),{align:"end"},{default:l(()=>[s(t(Ce),null,{default:l(()=>[...a[7]||(a[7]=[i("Actions",-1)])]),_:1}),n.status===0?(u(),x(w,{key:0},[s(t(z)),s(t(W),{onClick:d},{default:l(()=>[s(t(Z),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=i(" Release Bonus ",-1))]),_:1},8,["onClick"])],64)):K("",!0),s(t(z)),s(t(W),{class:"text-destructive",onClick:ge},{default:l(()=>[s(t(Be),{class:"mr-2 h-4 w-4"}),a[9]||(a[9]=i(" Hapus ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1}),s(_e,{breadcrumbs:te},{default:l(()=>[s(t(Fe),{title:"Bonus Lifetime Cash Reward"}),o("div",Je,[o("div",Qe,[o("div",null,[o("h1",et,[s(t(Ie),{class:"h-8 w-8"}),a[10]||(a[10]=i(" Bonus Lifetime Cash Reward ",-1))]),a[11]||(a[11]=o("p",{class:"text-muted-foreground"},"Kelola bonus lifetime cash reward member",-1))]),s(t(D),{onClick:a[0]||(a[0]=n=>t(B).visit("/bonus/lifetime-cash-reward/create"))},{default:l(()=>[s(t(Te),{class:"mr-2 h-4 w-4"}),a[12]||(a[12]=i(" Tambah Bonus ",-1))]),_:1})]),o("div",tt,[s(t(M),null,{default:l(()=>[s(t(U),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(j),{class:"text-sm font-medium"},{default:l(()=>[...a[13]||(a[13]=[i("Total Pending",-1)])]),_:1}),s(t(G),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(t(N),null,{default:l(()=>[o("div",st,_(C(f.statistics.total_pending)),1),o("p",at,_(f.statistics.count_pending)+" reward",1)]),_:1})]),_:1}),s(t(M),null,{default:l(()=>[s(t(U),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(j),{class:"text-sm font-medium"},{default:l(()=>[...a[14]||(a[14]=[i("Total Claimed",-1)])]),_:1}),s(t(Ae),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(t(N),null,{default:l(()=>[o("div",lt,_(C(f.statistics.total_claimed)),1),o("p",nt,_(f.statistics.count_claimed)+" reward",1)]),_:1})]),_:1}),s(t(M),null,{default:l(()=>[s(t(U),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(t(j),{class:"text-sm font-medium"},{default:l(()=>[...a[15]||(a[15]=[i("Total Expired",-1)])]),_:1}),s(t(Me),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(t(N),null,{default:l(()=>[o("div",ot,_(C(f.statistics.total_expired)),1),o("p",rt,_(f.statistics.count_expired)+" reward",1)]),_:1})]),_:1})]),o("div",it,[o("div",ut,[o("div",dt,[s(t(Ne),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s(t(Ee),{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=n=>h.value=n),placeholder:"Cari member atau nama reward...",class:"pl-9"},null,8,["modelValue"])]),s(t(qe),{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=n=>g.value=n)},{default:l(()=>[s(t(Oe),{class:"w-40"},{default:l(()=>[s(t(ze),{placeholder:"Semua Status"})]),_:1}),s(t(We),null,{default:l(()=>[s(t(I),{value:"all"},{default:l(()=>[...a[16]||(a[16]=[i("Semua Status",-1)])]),_:1}),s(t(I),{value:"0"},{default:l(()=>[...a[17]||(a[17]=[i("Pending",-1)])]),_:1}),s(t(I),{value:"1"},{default:l(()=>[...a[18]||(a[18]=[i("Claimed",-1)])]),_:1}),s(t(I),{value:"2"},{default:l(()=>[...a[19]||(a[19]=[i("Expired",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),R.value.length?(u(),v(t(D),{key:0,variant:"outline",onClick:fe},{default:l(()=>[s(t(Z),{class:"mr-2 h-4 w-4"}),i(" Release "+_(R.value.length)+" Bonus ",1)]),_:1})):K("",!0)]),o("div",mt,[s(t(Xe),null,{default:l(()=>[s(t(Ye),null,{default:l(()=>[(u(!0),x(w,null,F(t(T).getHeaderGroups(),n=>(u(),v(t(L),{key:n.id},{default:l(()=>[(u(!0),x(w,null,F(n.headers,d=>(u(),v(t(Ze),{key:d.id},{default:l(()=>[d.isPlaceholder?K("",!0):(u(),v(t(J),{key:0,render:d.column.columnDef.header,props:d.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),s(t(Ge),null,{default:l(()=>[t(T).getRowModel().rows?.length?(u(!0),x(w,{key:0},F(t(T).getRowModel().rows,n=>(u(),v(t(L),{key:n.id,"data-state":n.getIsSelected()&&"selected"},{default:l(()=>[(u(!0),x(w,null,F(n.getVisibleCells(),d=>(u(),v(t(ee),{key:d.id},{default:l(()=>[s(t(J),{render:d.column.columnDef.cell,props:d.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(u(),v(t(L),{key:1},{default:l(()=>[s(t(ee),{colspan:E.length,class:"h-24 text-center"},{default:l(()=>[...a[20]||(a[20]=[i("Tidak ada data.",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),s(we,{data:f.bonuses,url:t($).url()},null,8,["data","url"])]),s(A,{open:b.value.open,title:"Hapus Bonus",description:"Apakah Anda yakin ingin menghapus bonus ini?","confirm-text":"Hapus","onUpdate:open":a[3]||(a[3]=n=>b.value.open=n),onConfirm:de},null,8,["open"]),s(A,{open:m.value.open,title:"Release Bonus",description:`Apakah Anda yakin ingin merilis reward ${m.value.bonus?.reward_name} sebesar ${m.value.bonus?C(m.value.bonus.reward):""} ke member?`,"confirm-text":"Release","onUpdate:open":a[4]||(a[4]=n=>m.value.open=n),onConfirm:ce},null,8,["open","description"]),s(A,{open:k.value.open,title:"Mass Release Bonus",description:`Apakah Anda yakin ingin merilis ${R.value.length} bonus yang dipilih?`,"confirm-text":"Release All","onUpdate:open":a[5]||(a[5]=n=>k.value.open=n),onConfirm:pe},null,8,["open","description"])]),_:1})],64))}});export{Tt as default};
