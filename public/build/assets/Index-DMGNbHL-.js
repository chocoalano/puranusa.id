import{U as $,_ as ve}from"./AppLayout.vue_vue_type_script_setup_true_lang-3Xwj2Srj.js";import{_ as E}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-CHMIg_4b.js";import{_ as _e}from"./Pagination.vue_vue_type_script_setup_true_lang-C64O0K5A.js";import{_ as q}from"./index-Qe8U7avD.js";import{_ as k,v as M}from"./index-BhPH699V.js";import{_ as Q}from"./Checkbox.vue_vue_type_script_setup_true_lang-CwKgDATE.js";import{_ as W,a as X,b as Y,d as he,c as H,e as ye}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-NxThyEhC.js";import{_ as ke}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-hxH_Oz-B.js";import{r as h,Q as V,j as R,d as be,d9 as we,p as Z,q as Ce,E as J,v as b,g as n,b as s,w as l,u as e,e as u,aj as xe,c as m,t as w,s as _,da as ee,a4 as ae,cz as Se,z as te,a1 as De,Y as $e,K as P,Z as Ve,aa as Ue,F as U,x as A,y as se,n as i,ap as N,au as le,aW as re,aO as Ae,A as Re,B as Be}from"./vendor-DfMbnFaR.js";import{_ as Te}from"./Input.vue_vue_type_script_setup_true_lang-Bi8Aupzl.js";import{_ as je,a as Ie,b as z,c as Me,d as Pe,e as ne}from"./TableHeader.vue_vue_type_script_setup_true_lang-PuAkTm4y.js";import{u as Fe}from"./usePermissions-Bdkvyget.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-Bqij1zEj.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BOYUcfDs.js";import"./index-DnSHhU6t.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrG-1awo.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CpOM3BUc.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DZdfZa6K.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-VBwlv4qP.js";function Ee(){const o=h(!1);return{processing:o,deleteUser:async d=>new Promise((f,g)=>{o.value=!0,R.delete(`/manage/users/${d}`,{preserveScroll:!0,onSuccess:()=>{o.value=!1,V.success("Berhasil",{description:"Pengguna berhasil dihapus"}),f()},onError:()=>{o.value=!1,V.error("Gagal",{description:"Terjadi kesalahan saat menghapus pengguna"}),g()}})}),bulkDelete:async d=>{o.value=!0;let f=0,g=0;for(const v of d)try{await new Promise((c,F)=>{R.delete(`/manage/users/${v}`,{preserveScroll:!0,onSuccess:()=>{f++,c()},onError:()=>{g++,F()}})})}catch{}o.value=!1,f>0&&(V.success("Berhasil",{description:`${f} pengguna berhasil dihapus`}),R.reload({only:["users"]})),g>0&&V.error("Gagal",{description:`${g} pengguna gagal dihapus`})},copyToClipboard:async d=>{const f=c=>c?new Date(c).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",g=d.map(c=>({Name:c.name,Email:c.email,Status:c.email_verified_at?"Verified":"Unverified",Created:f(c.created_at)})),v=[Object.keys(g[0]).join("	"),...g.map(c=>Object.values(c).join("	"))].join(`
`);try{await navigator.clipboard.writeText(v),V.success("Berhasil",{description:`Data ${d.length} pengguna berhasil disalin ke clipboard`})}catch{V.error("Gagal",{description:"Gagal menyalin data ke clipboard"})}}}}const He={class:"rounded-xl p-4 space-y-6 py-6"},Ne={class:"flex items-center justify-between"},ze={class:"flex gap-2"},Ke={key:0,class:"flex items-center justify-between rounded-lg border bg-muted/50 p-4"},Oe={class:"text-sm font-medium"},Ge={class:"flex gap-2"},Le={class:"flex items-center justify-between gap-4"},qe={class:"relative flex-1 max-w-sm"},Qe={class:"rounded-md border"},We={class:"flex items-center justify-end space-x-2 py-4"},Xe={class:"flex-1 text-sm text-muted-foreground"},Ye={key:0},Ze={class:"space-x-2"},ka=be({__name:"Index",props:{users:{},filters:{}},setup(o){const y=o,K=[{title:"User Management",href:$.index.url()}],C=h(y.filters.search||""),d=h([{id:y.filters.sort_by,desc:y.filters.sort_order==="desc"}]),f=h([]),g=h({}),v=h({}),[c,F]=we(),{deleteUser:oe,bulkDelete:ie,copyToClipboard:O}=Ee(),x=h({open:!1,user:null}),B=h({open:!1}),T=h({open:!1}),j=Z(()=>Object.keys(v.value).map(a=>y.users.data[parseInt(a)]).filter(Boolean)),S=Z(()=>Object.keys(v.value).length),ue=a=>a?new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",de=a=>{x.value={open:!0,user:a}},ce=async()=>{x.value.user&&(await oe(x.value.user.id),v.value={},x.value={open:!1,user:null})},pe=()=>{j.value.length&&(B.value.open=!0)},me=async()=>{const a=j.value.map(t=>t.id);await ie(a),v.value={},B.value.open=!1},ge=()=>{j.value.length&&(T.value.open=!0)},fe=async()=>{await O(j.value),T.value.open=!1},{isSuperAdmin:I}=Fe(),G=[{id:"select",header:({table:a})=>i(Q,{modelValue:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":t=>a.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:a})=>i(Q,{modelValue:a.getIsSelected(),"onUpdate:modelValue":t=>a.toggleSelected(!!t),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>i("div",{class:"w-12"},"No"),cell:({row:a})=>{const t=a.index+1+(y.users.current_page-1)*y.users.per_page;return i("div",{class:"font-medium"},t)}},{accessorKey:"name",header:({column:a})=>i(k,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Name",i(N,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>i("div",{class:"font-medium"},a.getValue("name"))},{accessorKey:"email",header:({column:a})=>i(k,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Email",i(N,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>i("div",{class:"lowercase"},a.getValue("email"))},{accessorKey:"email_verified_at",header:"Status",cell:({row:a})=>{const t=a.getValue("email_verified_at");return i(q,{variant:t?"default":"secondary",class:"gap-1 capitalize"},()=>[i(t?le:re,{class:"h-3 w-3"}),t?"Verified":"Unverified"])}},{accessorKey:"role",header:"Role",cell:({row:a})=>{const t=a.getValue("role");return i(q,{variant:t==="superadmin"?"default":"secondary",class:"gap-1 capitalize"},()=>[i(t==="superadmin"?le:re,{class:"h-3 w-3"}),t==="superadmin"?"Super Admin":"Admin"])}},{accessorKey:"created_at",header:({column:a})=>i(k,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Created At",i(N,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>ue(a.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:a})=>{const t=a.original;return i(F,{user:t,onDelete:()=>de(t)})}}],D=Ce({get data(){return y.users.data},columns:G,getCoreRowModel:Be(),getSortedRowModel:Re(),getFilteredRowModel:Ae(),onSortingChange:a=>M(a,d),onColumnFiltersChange:a=>M(a,f),onColumnVisibilityChange:a=>M(a,g),onRowSelectionChange:a=>M(a,v),state:{get sorting(){return d.value},get columnFilters(){return f.value},get columnVisibility(){return g.value},get rowSelection(){return v.value}},manualSorting:!0,enableRowSelection:!0});J(d,a=>{a.length>0&&R.get($.index.url(),{search:C.value||void 0,sort_by:a[0].id,sort_order:a[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let L;return J(C,()=>{clearTimeout(L),L=setTimeout(()=>{R.get($.index.url(),{search:C.value||void 0,sort_by:d.value[0]?.id||"created_at",sort_order:d.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(a,t)=>(n(),b(U,null,[s(e(c),null,{default:l(({user:r,onDelete:p})=>[s(e(W),null,{default:l(()=>[s(e(X),{"as-child":""},{default:l(()=>[s(e(k),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[t[4]||(t[4]=u("span",{class:"sr-only"},"Open menu",-1)),s(e(xe),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(Y),{align:"end"},{default:l(()=>[s(e(he),null,{default:l(()=>[...t[5]||(t[5]=[_("Actions",-1)])]),_:1}),e(I)?(n(),m(e(H),{key:0,onClick:Je=>e(O)([r])},{default:l(()=>[s(e(ee),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=_(" Copy user data ",-1))]),_:1},8,["onClick"])):w("",!0),s(e(ye)),e(I)?(n(),m(e(H),{key:1,"as-child":""},{default:l(()=>[s(e(ae),{href:e($).edit.url(r.id)},{default:l(()=>[s(e(Se),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=_(" Edit user ",-1))]),_:1},8,["href"])]),_:2},1024)):w("",!0),e(I)?(n(),m(e(H),{key:2,onClick:p,class:"text-destructive"},{default:l(()=>[s(e(te),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=_(" Delete user ",-1))]),_:1},8,["onClick"])):w("",!0)]),_:2},1024)]),_:2},1024)]),_:1}),s(ve,{breadcrumbs:K},{default:l(()=>[s(e(De),{title:"User Management"}),u("div",He,[u("div",Ne,[t[10]||(t[10]=u("div",null,[u("h1",{class:"text-3xl font-bold tracking-tight"},"Users"),u("p",{class:"text-muted-foreground"}," Manage user accounts and permissions ")],-1)),u("div",ze,[e(I)?(n(),m(e(ae),{key:0,href:e($).create.url()},{default:l(()=>[s(e(k),null,{default:l(()=>[s(e($e),{class:"h-4 w-4"}),t[9]||(t[9]=_(" Add User ",-1))]),_:1})]),_:1},8,["href"])):w("",!0)])]),S.value>0?(n(),b("div",Ke,[u("p",Oe,P(S.value)+" user(s) selected ",1),u("div",Ge,[s(e(k),{variant:"outline",size:"sm",onClick:ge},{default:l(()=>[s(e(ee),{class:"h-4 w-4"}),t[11]||(t[11]=_(" Copy Data ",-1))]),_:1}),s(e(k),{variant:"destructive",size:"sm",onClick:pe},{default:l(()=>[s(e(te),{class:"h-4 w-4"}),t[12]||(t[12]=_(" Delete Selected ",-1))]),_:1})])])):w("",!0),u("div",Le,[u("div",qe,[s(e(Ve),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s(e(Te),{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=r=>C.value=r),placeholder:"Filter emails...",class:"pl-9"},null,8,["modelValue"])]),s(e(W),null,{default:l(()=>[s(e(X),{"as-child":""},{default:l(()=>[s(e(k),{variant:"outline",class:"ml-auto"},{default:l(()=>[t[13]||(t[13]=_(" Columns ",-1)),s(e(Ue),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),s(e(Y),{align:"end"},{default:l(()=>[(n(!0),b(U,null,A(e(D).getAllColumns().filter(r=>r.getCanHide()),r=>(n(),m(e(ke),{key:r.id,class:"capitalize","model-value":r.getIsVisible(),"onUpdate:modelValue":p=>{r.toggleVisibility(!!p)}},{default:l(()=>[_(P(r.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),u("div",Qe,[s(e(je),null,{default:l(()=>[s(e(Ie),null,{default:l(()=>[(n(!0),b(U,null,A(e(D).getHeaderGroups(),r=>(n(),m(e(z),{key:r.id},{default:l(()=>[(n(!0),b(U,null,A(r.headers,p=>(n(),m(e(Me),{key:p.id},{default:l(()=>[p.isPlaceholder?w("",!0):(n(),m(e(se),{key:0,render:p.column.columnDef.header,props:p.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),s(e(Pe),null,{default:l(()=>[e(D).getRowModel().rows?.length?(n(!0),b(U,{key:0},A(e(D).getRowModel().rows,r=>(n(),m(e(z),{key:r.id,"data-state":r.getIsSelected()?"selected":void 0},{default:l(()=>[(n(!0),b(U,null,A(r.getVisibleCells(),p=>(n(),m(e(ne),{key:p.id},{default:l(()=>[s(e(se),{render:p.column.columnDef.cell,props:p.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(n(),m(e(z),{key:1},{default:l(()=>[s(e(ne),{colspan:G.length,class:"h-24 text-center"},{default:l(()=>[...t[14]||(t[14]=[_(" No users found. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),u("div",We,[u("div",Xe,[S.value>0?(n(),b("span",Ye,P(e(D).getFilteredSelectedRowModel().rows.length)+" dari "+P(e(D).getFilteredRowModel().rows.length)+" baris dipilih. ",1)):w("",!0)]),u("div",Ze,[o.users.last_page>1?(n(),m(_e,{key:0,data:{current_page:o.users.current_page,last_page:o.users.last_page,per_page:o.users.per_page,from:(o.users.current_page-1)*o.users.per_page+1,to:Math.min(o.users.current_page*o.users.per_page,o.users.total),total:o.users.total},url:e($).index.url(),filters:{search:C.value||void 0,sort_by:d.value[0]?.id||"created_at",sort_order:d.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):w("",!0)])])]),s(E,{open:x.value.open,"onUpdate:open":t[1]||(t[1]=r=>x.value.open=r),title:"Hapus Pengguna?",description:`Apakah Anda yakin ingin menghapus pengguna ${x.value.user?.name}? Tindakan ini tidak dapat dibatalkan.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:ce},null,8,["open","description"]),s(E,{open:B.value.open,"onUpdate:open":t[2]||(t[2]=r=>B.value.open=r),title:`Hapus ${S.value} Pengguna?`,description:`Apakah Anda yakin ingin menghapus ${S.value} pengguna yang dipilih? Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data pengguna tersebut.`,"confirm-text":"Hapus Semua","cancel-text":"Batal",variant:"destructive",onConfirm:me},null,8,["open","title","description"]),s(E,{open:T.value.open,"onUpdate:open":t[3]||(t[3]=r=>T.value.open=r),title:"Salin Data Pengguna?",description:`Data dari ${S.value} pengguna yang dipilih akan disalin ke clipboard dalam format tab-separated. Anda dapat mem-paste data ini ke spreadsheet seperti Excel atau Google Sheets.`,"confirm-text":"Salin ke Clipboard","cancel-text":"Batal",onConfirm:fe},null,8,["open","description"])]),_:1})],64))}});export{ka as default};
