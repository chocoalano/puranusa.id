import{T as I,V as oe,_ as re,X as ie,Y as ue,Z as de,$ as ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-YhCYOJnL.js";import{_ as M}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-D9WQZH3x.js";import{_ as me}from"./Pagination.vue_vue_type_script_setup_true_lang-nWoduDQM.js";import{_ as fe}from"./index-CQcVzSmJ.js";import{_ as p,v as T}from"./index-D22QrCMB.js";import{_ as z,a as H}from"./CardContent.vue_vue_type_script_setup_true_lang-Bj2sOBs1.js";import{_ as K}from"./CardHeader.vue_vue_type_script_setup_true_lang-Dnz_aDai.js";import{_ as L}from"./CardTitle.vue_vue_type_script_setup_true_lang-DNuWsNXR.js";import{_ as ge,a as pe,b as _e}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DuRk8pxL.js";import{_ as ve}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-DRjT8lNZ.js";import{_ as be}from"./Input.vue_vue_type_script_setup_true_lang-sYWCYV49.js";import{_ as xe,a as he,b as ye,c as ke,d as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-CBkKfeqw.js";import{_ as we,a as Se,b as j,c as Ce,d as Re,e as q}from"./TableHeader.vue_vue_type_script_setup_true_lang-C4NscKfn.js";import{d as $e,r as m,p as E,q as De,D as J,j as x,c as _,g as r,w as l,b as a,e as i,u as t,$ as Be,v as S,t as W,s as d,W as Ve,cR as Ie,J as C,au as Te,aq as X,Y as Me,cS as Fe,a8 as je,F as $,x as D,y as Y,n as o,an as G,cw as Ue,aM as Ae,ap as Pe,z as Ne,aG as ze,A as He,B as Ke}from"./vendor-DTOvI-mL.js";import"./index-DaR_mHDg.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-BMNk4ekC.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Dl-lb8Nw.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DLa7QEbp.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DpA8K8_j.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CBH8nRlZ.js";const Le={class:"rounded-xl p-4 space-y-6 py-6"},qe={class:"flex items-center justify-between"},Ee={class:"grid gap-4 md:grid-cols-2"},Je={class:"text-2xl font-bold"},We={class:"text-xs text-muted-foreground"},Xe={class:"text-2xl font-bold"},Ye={class:"text-xs text-muted-foreground"},Ge={key:0,class:"flex items-center justify-between rounded-lg border bg-muted/50 p-4"},Oe={class:"text-sm font-medium"},Ze={class:"flex items-center gap-4"},Qe={class:"relative flex-1"},et={class:"rounded-md border"},yt=$e({__name:"Index",props:{bonuses:{},statistics:{},filters:{}},setup(h){const f=h,O=[{title:"Bonus Regular",href:I.url()}],y=m(f.filters.search||""),c=m(f.filters.status?.toString()||"all"),v=m([{id:f.filters.sort_by,desc:f.filters.sort_order==="desc"}]),U=m([]),A=m({}),R=m({}),k=m({open:!1,bonus:null}),g=m({open:!1,bonus:null}),B=m({open:!1}),Z=E(()=>Object.keys(R.value).map(e=>f.bonuses.data[parseInt(e)]).filter(Boolean)),w=E(()=>Z.value.filter(e=>e.status===0)),b=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),Q=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ee=e=>{k.value={open:!0,bonus:e}},te=()=>{k.value.bonus&&x.delete(ie.url(k.value.bonus.id),{preserveScroll:!0,onSuccess:()=>{k.value={open:!1,bonus:null}}})},se=e=>{g.value={open:!0,bonus:e}},ae=()=>{g.value.bonus&&x.post(ue.url(g.value.bonus.id),{},{preserveScroll:!0,onSuccess:()=>{g.value={open:!1,bonus:null},R.value={}}})},le=()=>{w.value.length&&(B.value.open=!0)},ne=()=>{const e=w.value.map(s=>s.id);x.post(de.url(),{bonus_ids:e},{preserveScroll:!0,onSuccess:()=>{R.value={},B.value.open=!1}})},P=[{id:"select",header:({table:e})=>o("input",{type:"checkbox",checked:e.getIsAllPageRowsSelected(),indeterminate:e.getIsSomePageRowsSelected(),onChange:e.getToggleAllPageRowsSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),cell:({row:e})=>o("input",{type:"checkbox",checked:e.getIsSelected(),disabled:!e.getCanSelect(),onChange:e.getToggleSelectedHandler(),class:"h-4 w-4 rounded border-gray-300"}),enableSorting:!1},{id:"index",header:()=>o("div",{class:"w-12"},"No"),cell:({row:e})=>{const s=e.index+1+(f.bonuses.current_page-1)*f.bonuses.per_page;return o("div",{class:"font-medium"},s)}},{accessorKey:"member_name",header:({column:e})=>o(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Member",o(G,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>o("div",[o("div",{class:"font-medium"},e.original.member_name),o("div",{class:"text-xs text-muted-foreground"},e.original.member_ewallet_id)])},{accessorKey:"amount",header:()=>o("div",{class:"text-right"},"Jumlah"),cell:({row:e})=>o("div",{class:"text-right"},[o("div",{class:"font-medium"},b(e.original.amount)),o("div",{class:"text-xs text-muted-foreground"},`Tax: ${b(e.original.tax_amount)}`),o("div",{class:"text-xs text-green-600"},`Netto: ${b(e.original.tax_netto)}`)])},{accessorKey:"status",header:()=>"Status",cell:({row:e})=>{const s=e.original.status;return o(fe,{variant:s===1?"default":"secondary",class:"gap-1"},()=>[o(s===1?Ue:Ae,{class:"h-3 w-3"}),e.original.status_text])}},{accessorKey:"created_at",header:({column:e})=>o(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"-ml-4"},()=>["Tanggal",o(G,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>Q(e.getValue("created_at"))},{id:"actions",header:()=>o("div",{class:"text-right"},"Actions"),cell:({row:e})=>{const s=e.original;return o("div",{class:"flex justify-end gap-2"},[o(p,{variant:"outline",size:"sm",onClick:()=>x.visit(ce.url(s.id))},()=>o(Pe,{class:"h-4 w-4"})),s.status===0?o(p,{variant:"default",size:"sm",onClick:()=>se(s)},()=>o(X,{class:"h-4 w-4"})):null,s.status===0?o(p,{variant:"outline",size:"sm",onClick:()=>ee(s)},()=>o(Ne,{class:"h-4 w-4 text-destructive"})):null])}}],V=De({get data(){return f.bonuses.data},columns:P,getCoreRowModel:Ke(),getSortedRowModel:He(),getFilteredRowModel:ze(),state:{get sorting(){return v.value},get columnFilters(){return U.value},get columnVisibility(){return A.value},get rowSelection(){return R.value}},onSortingChange:e=>T(e,v),onColumnFiltersChange:e=>T(e,U),onColumnVisibilityChange:e=>T(e,A),onRowSelectionChange:e=>T(e,R),manualSorting:!0,enableRowSelection:!0});J(v,e=>{e.length>0&&x.get(I.url(),{search:y.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:e[0].id,sort_order:e[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let N;return J([y,c],()=>{clearTimeout(N),N=setTimeout(()=>{x.get(I.url(),{search:y.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:v.value[0]?.id||"created_at",sort_order:v.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(e,s)=>(r(),_(re,{breadcrumbs:O},{default:l(()=>[a(t(Be),{title:"Bonus Regular"}),i("div",Le,[i("div",qe,[s[7]||(s[7]=i("div",null,[i("h1",{class:"text-3xl font-bold tracking-tight"},"Bonus Regular"),i("p",{class:"text-muted-foreground"},"Kelola bonus reguler member")],-1)),a(t(p),{onClick:s[0]||(s[0]=n=>t(x).visit(t(oe).url()))},{default:l(()=>[a(t(Ve),{class:"h-4 w-4"}),s[6]||(s[6]=d(" Tambah Bonus ",-1))]),_:1})]),i("div",Ee,[a(t(z),null,{default:l(()=>[a(t(K),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[a(t(L),{class:"text-sm font-medium"},{default:l(()=>[...s[8]||(s[8]=[d("Total Pending",-1)])]),_:1}),a(t(Ie),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(t(H),null,{default:l(()=>[i("div",Je,C(b(h.statistics.total_pending)),1),i("p",We,C(h.statistics.count_pending)+" bonus ",1)]),_:1})]),_:1}),a(t(z),null,{default:l(()=>[a(t(K),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[a(t(L),{class:"text-sm font-medium"},{default:l(()=>[...s[9]||(s[9]=[d("Total Released",-1)])]),_:1}),a(t(Te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(t(H),null,{default:l(()=>[i("div",Xe,C(b(h.statistics.total_released)),1),i("p",Ye,C(h.statistics.count_released)+" bonus ",1)]),_:1})]),_:1})]),w.value.length>0?(r(),S("div",Ge,[i("p",Oe,C(w.value.length)+" bonus pending dipilih ",1),a(t(p),{size:"sm",onClick:le},{default:l(()=>[a(t(X),{class:"h-4 w-4"}),s[10]||(s[10]=d(" Release Semua ",-1))]),_:1})])):W("",!0),i("div",Ze,[i("div",Qe,[a(t(Me),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a(t(be),{modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=n=>y.value=n),placeholder:"Cari member atau deskripsi...",class:"pl-9"},null,8,["modelValue"])]),a(t(xe),{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=n=>c.value=n)},{default:l(()=>[a(t(he),{class:"w-40"},{default:l(()=>[a(t(ye),{placeholder:"Semua Status"})]),_:1}),a(t(ke),null,{default:l(()=>[a(t(F),{value:"all"},{default:l(()=>[...s[11]||(s[11]=[d("Semua Status",-1)])]),_:1}),a(t(F),{value:"0"},{default:l(()=>[...s[12]||(s[12]=[d("Pending",-1)])]),_:1}),a(t(F),{value:"1"},{default:l(()=>[...s[13]||(s[13]=[d("Released",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(t(ge),null,{default:l(()=>[a(t(pe),{"as-child":""},{default:l(()=>[a(t(p),{variant:"outline",class:"ml-auto"},{default:l(()=>[a(t(Fe),{class:"h-4 w-4"}),s[14]||(s[14]=d(" Kolom ",-1)),a(t(je),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),a(t(_e),{align:"end"},{default:l(()=>[(r(!0),S($,null,D(t(V).getAllColumns().filter(n=>n.getCanHide()),n=>(r(),_(t(ve),{key:n.id,class:"capitalize",checked:n.getIsVisible(),"onUpdate:checked":u=>n.toggleVisibility(!!u)},{default:l(()=>[d(C(n.id),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1})]),i("div",et,[a(t(we),null,{default:l(()=>[a(t(Se),null,{default:l(()=>[(r(!0),S($,null,D(t(V).getHeaderGroups(),n=>(r(),_(t(j),{key:n.id},{default:l(()=>[(r(!0),S($,null,D(n.headers,u=>(r(),_(t(Ce),{key:u.id},{default:l(()=>[u.isPlaceholder?W("",!0):(r(),_(t(Y),{key:0,render:u.column.columnDef.header,props:u.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),a(t(Re),null,{default:l(()=>[t(V).getRowModel().rows?.length?(r(!0),S($,{key:0},D(t(V).getRowModel().rows,n=>(r(),_(t(j),{key:n.id,"data-state":n.getIsSelected()?"selected":void 0},{default:l(()=>[(r(!0),S($,null,D(n.getVisibleCells(),u=>(r(),_(t(q),{key:u.id},{default:l(()=>[a(t(Y),{render:u.column.columnDef.cell,props:u.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(r(),_(t(j),{key:1},{default:l(()=>[a(t(q),{colspan:P.length,class:"h-24 text-center"},{default:l(()=>[...s[15]||(s[15]=[d(" Tidak ada data bonus. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),a(me,{data:h.bonuses,url:t(I).url(),filters:{search:y.value||void 0,status:c.value!=="all"?parseInt(c.value):void 0,sort_by:v.value[0]?.id,sort_order:v.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])]),a(M,{open:k.value.open,"onUpdate:open":s[3]||(s[3]=n=>k.value.open=n),title:"Hapus Bonus?",description:"Apakah Anda yakin ingin menghapus bonus ini? Tindakan ini tidak dapat dibatalkan.","confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:te},null,8,["open"]),a(M,{open:g.value.open,"onUpdate:open":s[4]||(s[4]=n=>g.value.open=n),title:"Release Bonus?",description:`Bonus sebesar ${g.value.bonus?b(g.value.bonus.tax_netto):""} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release","cancel-text":"Batal",onConfirm:ae},null,8,["open","description"]),a(M,{open:B.value.open,"onUpdate:open":s[5]||(s[5]=n=>B.value.open=n),title:`Release ${w.value.length} Bonus?`,description:`Total ${b(w.value.reduce((n,u)=>n+u.tax_netto,0))} akan ditransfer ke ewallet member. Lanjutkan?`,"confirm-text":"Release Semua","cancel-text":"Batal",onConfirm:ne},null,8,["open","title","description"])]),_:1}))}});export{yt as default};
