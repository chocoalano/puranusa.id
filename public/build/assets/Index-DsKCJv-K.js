import{d as P,r as k,p as v,q as j,c,g as a,w as s,e as $,b as r,u as t,s as S,aK as z,t as C,v as m,F as f,x as _,y as T,n as i,z as E,j as b,A as H,B as L}from"./vendor-4-BZYpFr.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-4ba7MJZZ.js";import{_ as Q}from"./StatisticsCards.vue_vue_type_script_setup_true_lang-D8hbExTC.js";import{_ as U,a as G}from"./TablePagination.vue_vue_type_script_setup_true_lang-D7Ny-VtX.js";import{_ as J,a as W}from"./CardContent.vue_vue_type_script_setup_true_lang-CqrB5hxD.js";import{_ as X}from"./CardHeader.vue_vue_type_script_setup_true_lang-CAU7O7lt.js";import{_ as Y}from"./CardTitle.vue_vue_type_script_setup_true_lang-CXovuBmY.js";import{_ as Z}from"./index-C_d1QX2L.js";import{_ as O,a as ee,b as w,c as te,d as se,e as D}from"./TableHeader.vue_vue_type_script_setup_true_lang-BhipakAw.js";import{u as ae}from"./usePermissions-DDUSam5l.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-CQ0bN-pz.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DAlPCySi.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B92NEDT-.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DLcPllPw.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CdMXDPSC.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DgP-o0Lu.js";import"./Input.vue_vue_type_script_setup_true_lang-BCOvYMLd.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-uung8Eko.js";const re={class:"space-y-6"},le={class:"rounded-md border"},Ce=P({__name:"Index",props:{newsletters:{},statistics:{},filters:{}},setup(p){const{isSuperAdmin:V,isAdmin:A}=ae(),d=p,u=k(d.filters?.search||""),g=k([]);let y;const M=v(()=>[{label:"Total Subscriber",value:d.statistics.total_subscribers},{label:"Hari Ini",value:d.statistics.total_today},{label:"Bulan Ini",value:d.statistics.total_this_month}]),N=v(()=>[{type:"search",placeholder:"Cari email...",modelValue:u.value}]),R=()=>{clearTimeout(y),y=setTimeout(()=>{b.get("/admin/settings/newsletters",{search:u.value},{preserveState:!0,preserveScroll:!0})},300)},B=(e,l)=>{const n=l?.toString()||"";e===0&&(u.value=n,R())},I=e=>{confirm("Apakah Anda yakin ingin menghapus subscriber ini?")&&b.delete(`/admin/settings/newsletters/${e}`,{preserveScroll:!0})},F=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),x=[{id:"index",header:()=>i("div",{class:"w-12"},"No"),cell:({row:e})=>{const l=e.index+1+(d.newsletters.current_page-1)*d.newsletters.per_page;return i("div",{class:"font-medium"},l)}},{accessorKey:"email",header:"Email",cell:({row:e})=>i("div",{class:"font-medium"},e.getValue("email"))},{accessorKey:"ip_address",header:"IP Address",cell:({row:e})=>i("code",{class:"rounded bg-muted px-2 py-1 text-xs"},e.getValue("ip_address"))},{accessorKey:"created_at",header:"Tanggal Daftar",cell:({row:e})=>i("div",{class:"text-sm"},F(e.getValue("created_at")))},{id:"actions",header:()=>i("div",{class:"text-right"},"Aksi"),cell:({row:e})=>{const l=e.original,n=[];return(V||A)&&n.push(i(Z,{variant:"ghost",size:"sm",onClick:()=>I(l.id)},()=>i(E,{class:"h-4 w-4 text-destructive"}))),i("div",{class:"flex justify-end gap-2"},n)}}],h=j({data:v(()=>d.newsletters.data),columns:x,getCoreRowModel:L(),getSortedRowModel:H(),state:{get sorting(){return g.value}},onSortingChange:e=>{g.value=typeof e=="function"?e(g.value):e}}),K=e=>{b.get("/admin/settings/newsletters",{page:e,search:u.value},{preserveState:!0,preserveScroll:!0})};return(e,l)=>(a(),c(q,{title:"Newsletter Subscribers"},{default:s(()=>[$("div",re,[r(Q,{stats:M.value,columns:3},null,8,["stats"]),r(t(J),null,{default:s(()=>[r(t(X),null,{default:s(()=>[r(t(Y),{class:"flex items-center gap-2"},{default:s(()=>[r(t(z),{class:"h-5 w-5"}),l[0]||(l[0]=S(" Newsletter Subscribers ",-1))]),_:1})]),_:1}),r(t(W),{class:"space-y-4"},{default:s(()=>[r(U,{filters:N.value,"on-update":B},null,8,["filters"]),$("div",le,[r(t(O),null,{default:s(()=>[r(t(ee),null,{default:s(()=>[(a(!0),m(f,null,_(t(h).getHeaderGroups(),n=>(a(),c(t(w),{key:n.id},{default:s(()=>[(a(!0),m(f,null,_(n.headers,o=>(a(),c(t(te),{key:o.id},{default:s(()=>[o.isPlaceholder?C("",!0):(a(),c(t(T),{key:0,render:o.column.columnDef.header,props:o.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),r(t(se),null,{default:s(()=>[t(h).getRowModel().rows?.length?(a(!0),m(f,{key:0},_(t(h).getRowModel().rows,n=>(a(),c(t(w),{key:n.id},{default:s(()=>[(a(!0),m(f,null,_(n.getVisibleCells(),o=>(a(),c(t(D),{key:o.id},{default:s(()=>[r(t(T),{render:o.column.columnDef.cell,props:o.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(a(),c(t(w),{key:1},{default:s(()=>[r(t(D),{colspan:x.length,class:"h-24 text-center"},{default:s(()=>[...l[1]||(l[1]=[S(" Tidak ada data subscriber. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),p.newsletters.last_page>1?(a(),c(G,{key:0,data:p.newsletters,"on-page-change":K,"item-label":"subscriber"},null,8,["data"])):C("",!0)]),_:1})]),_:1})])]),_:1}))}});export{Ce as default};
