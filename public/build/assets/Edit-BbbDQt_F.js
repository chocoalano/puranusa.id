import{i as _,_ as C,u as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-CAMiCJvC.js";import{u as $,a as B,_ as F}from"./useShippingLocation-DFMC5j1o.js";import{_ as m}from"./index-BYj0gYCc.js";import{d as G,o as M,Q as n,E as N,v as V,g as j,b as s,u as e,a1 as D,w as o,e as l,a4 as b,s as u,G as K,al as L,K as T,F as A}from"./vendor-ppbe-N6l.js";import"./index-CSEUMRIG.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-DiRTNO4J.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-BAAtcDkZ.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DA3JUaxj.js";import"./index-BUE9bFsX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CKDVFyjr.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-B3c6JmTR.js";import"./CardContent.vue_vue_type_script_setup_true_lang-vqvbNoPF.js";import"./CardDescription.vue_vue_type_script_setup_true_lang-DlqFqAdi.js";import"./CardHeader.vue_vue_type_script_setup_true_lang-_r3YWix0.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CuQE-qUU.js";import"./Input.vue_vue_type_script_setup_true_lang-DNj-uKug.js";import"./Label.vue_vue_type_script_setup_true_lang-DqlcMzBV.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CzK-upws.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CBeaEOLc.js";const O={class:"space-y-6 rounded-xl p-4 py-6"},Q={class:"flex items-center justify-between"},lt=G({__name:"Edit",props:{customer:{}},setup(d){const p=d,{form:r,toPayload:h}=$("edit",{...p.customer}),{provinces:v,cities:y,loadingProvinces:w,loadingCities:k,fetchProvinces:x,fetchCities:c,resetCities:f}=B(),E=a=>{const t=Object.values(a).filter(i=>typeof i=="string"&&i.length>0);if(t.length===0){n.error("Gagal memperbarui data pelanggan. Silakan periksa kembali input form.");return}n.error(t[0]),t.length>1&&n.warning(`Terdapat ${t.length} kesalahan pada form.`)},g=(a,t)=>a instanceof Error&&a.message.trim()!==""?a.message:t;M(async()=>{try{await x(),r.province_id&&await c(r.province_id)}catch(a){n.error(g(a,"Gagal memuat data wilayah pelanggan."))}}),N(()=>r.province_id,async(a,t)=>{if(!a){f(),r.city_id=null;return}a!==t&&(r.city_id=null);try{await c(a)}catch(i){n.error(g(i,"Gagal memuat daftar kota/kabupaten.")),f()}});const S=()=>{r.transform(a=>h(a)).put(P.url(p.customer.id),{preserveScroll:!0,onSuccess:()=>{n.success("Data pelanggan berhasil diperbarui.")},onError:a=>{E(a)}})};return(a,t)=>(j(),V(A,null,[s(e(D),{title:`Edit ${d.customer.name}`},null,8,["title"]),s(C,null,{default:o(()=>[l("div",O,[l("div",Q,[t[2]||(t[2]=l("div",null,[l("h1",{class:"text-3xl font-bold"},"Edit Pelanggan"),l("p",{class:"mt-2 text-muted-foreground"}," Perbarui data identitas, alamat, rekening, dan catatan pelanggan secara terstruktur. ")],-1)),s(e(b),{href:e(_).url()},{default:o(()=>[s(e(m),{variant:"outline"},{default:o(()=>[s(e(K),{class:"mr-2 h-4 w-4"}),t[1]||(t[1]=u(" Kembali ",-1))]),_:1})]),_:1},8,["href"])]),s(F,{form:e(r),"onUpdate:form":t[0]||(t[0]=i=>L(r)?r.value=i:null),mode:"edit",provinces:e(v),cities:e(y),"loading-provinces":e(w),"loading-cities":e(k),onSubmit:S},{actions:o(({processing:i})=>[s(e(b),{href:e(_).url()},{default:o(()=>[s(e(m),{type:"button",variant:"outline"},{default:o(()=>[...t[3]||(t[3]=[u(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),s(e(m),{type:"submit",disabled:i},{default:o(()=>[u(T(i?"Menyimpan...":"Simpan Perubahan"),1)]),_:2},1032,["disabled"])]),_:1},8,["form","provinces","cities","loading-provinces","loading-cities"])])]),_:1})],64))}});export{lt as default};
