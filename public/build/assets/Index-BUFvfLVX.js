import{U as D,_ as pe}from"./AppLayout.vue_vue_type_script_setup_true_lang-Hu_mZ1eB.js";import{_ as F}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-Cl2-SULB.js";import{_ as me}from"./Pagination.vue_vue_type_script_setup_true_lang-D5lnraLN.js";import{_ as ge}from"./index-BonpZqDt.js";import{_ as y,v as j}from"./index-D9Hie8NE.js";import{_ as O}from"./Checkbox.vue_vue_type_script_setup_true_lang-C7XCvPtL.js";import{_ as q,a as Q,b as X,d as fe,c as E,e as ve}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BLeUwnH4.js";import{_ as _e}from"./DropdownMenuCheckboxItem.vue_vue_type_script_setup_true_lang-DlsQO5tE.js";import{r as _,Q as $,j as R,d as he,d3 as ye,p as Y,q as be,E as Z,v as b,g as o,b as s,w as l,u as e,e as i,ai as ke,s as v,d4 as J,a3 as W,cd as we,z as ee,a0 as Ce,t as I,Y as xe,K as M,Z as Se,a9 as De,F as V,x as U,c as k,y as ae,n as u,an as H,as as $e,aR as Ve,aL as Ue,A as Re,B as Ae}from"./vendor-flWeloHs.js";import{_ as Be}from"./Input.vue_vue_type_script_setup_true_lang-BI8FpPnw.js";import{_ as Te,a as je,b as N,c as Ie,d as Me,e as te}from"./TableHeader.vue_vue_type_script_setup_true_lang-Dhjk0EnN.js";import"./index-CMWG4mbA.js";import"./AvatarFallback.vue_vue_type_script_setup_true_lang-D5yDigSh.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-Dv6VzhWI.js";import"./index-DqFeuJ-n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BC4ik9Oa.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-BsQpZQb0.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-CL8LVL2o.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CnNjP2es.js";function Pe(){const r=_(!1);return{processing:r,deleteUser:async d=>new Promise((g,m)=>{r.value=!0,R.delete(`/manage/users/${d}`,{preserveScroll:!0,onSuccess:()=>{r.value=!1,$.success("Berhasil",{description:"Pengguna berhasil dihapus"}),g()},onError:()=>{r.value=!1,$.error("Gagal",{description:"Terjadi kesalahan saat menghapus pengguna"}),m()}})}),bulkDelete:async d=>{r.value=!0;let g=0,m=0;for(const f of d)try{await new Promise((c,P)=>{R.delete(`/manage/users/${f}`,{preserveScroll:!0,onSuccess:()=>{g++,c()},onError:()=>{m++,P()}})})}catch{}r.value=!1,g>0&&($.success("Berhasil",{description:`${g} pengguna berhasil dihapus`}),R.reload({only:["users"]})),m>0&&$.error("Gagal",{description:`${m} pengguna gagal dihapus`})},copyToClipboard:async d=>{const g=c=>c?new Date(c).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",m=d.map(c=>({Name:c.name,Email:c.email,Status:c.email_verified_at?"Verified":"Unverified",Created:g(c.created_at)})),f=[Object.keys(m[0]).join("	"),...m.map(c=>Object.values(c).join("	"))].join(`
`);try{await navigator.clipboard.writeText(f),$.success("Berhasil",{description:`Data ${d.length} pengguna berhasil disalin ke clipboard`})}catch{$.error("Gagal",{description:"Gagal menyalin data ke clipboard"})}}}}const Fe={class:"rounded-xl p-4 space-y-6 py-6"},Ee={class:"flex items-center justify-between"},He={class:"flex gap-2"},Ne={key:0,class:"flex items-center justify-between rounded-lg border bg-muted/50 p-4"},Le={class:"text-sm font-medium"},ze={class:"flex gap-2"},Ge={class:"flex items-center justify-between gap-4"},Ke={class:"relative flex-1 max-w-sm"},Oe={class:"rounded-md border"},qe={class:"flex items-center justify-end space-x-2 py-4"},Qe={class:"flex-1 text-sm text-muted-foreground"},Xe={key:0},Ye={class:"space-x-2"},_a=he({__name:"Index",props:{users:{},filters:{}},setup(r){const h=r,L=[{title:"User Management",href:D.index.url()}],w=_(h.filters.search||""),d=_([{id:h.filters.sort_by,desc:h.filters.sort_order==="desc"}]),g=_([]),m=_({}),f=_({}),[c,P]=ye(),{deleteUser:se,bulkDelete:le,copyToClipboard:z}=Pe(),C=_({open:!1,user:null}),A=_({open:!1}),B=_({open:!1}),T=Y(()=>Object.keys(f.value).map(a=>h.users.data[parseInt(a)]).filter(Boolean)),x=Y(()=>Object.keys(f.value).length),ne=a=>a?new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",re=a=>{C.value={open:!0,user:a}},oe=async()=>{C.value.user&&(await se(C.value.user.id),f.value={},C.value={open:!1,user:null})},ie=()=>{T.value.length&&(A.value.open=!0)},ue=async()=>{const a=T.value.map(t=>t.id);await le(a),f.value={},A.value.open=!1},de=()=>{T.value.length&&(B.value.open=!0)},ce=async()=>{await z(T.value),B.value.open=!1},G=[{id:"select",header:({table:a})=>u(O,{modelValue:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:modelValue":t=>a.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all"}),cell:({row:a})=>u(O,{modelValue:a.getIsSelected(),"onUpdate:modelValue":t=>a.toggleSelected(!!t),ariaLabel:"Select row"}),enableSorting:!1,enableHiding:!1},{id:"index",header:()=>u("div",{class:"w-12"},"No"),cell:({row:a})=>{const t=a.index+1+(h.users.current_page-1)*h.users.per_page;return u("div",{class:"font-medium"},t)}},{accessorKey:"name",header:({column:a})=>u(y,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Name",u(H,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>u("div",{class:"font-medium"},a.getValue("name"))},{accessorKey:"email",header:({column:a})=>u(y,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Email",u(H,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>u("div",{class:"lowercase"},a.getValue("email"))},{accessorKey:"email_verified_at",header:"Status",cell:({row:a})=>{const t=a.getValue("email_verified_at");return u(ge,{variant:t?"default":"secondary",class:"gap-1 capitalize"},()=>[u(t?$e:Ve,{class:"h-3 w-3"}),t?"Verified":"Unverified"])}},{accessorKey:"created_at",header:({column:a})=>u(y,{variant:"ghost",onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),class:"-ml-4"},()=>["Created At",u(H,{class:"ml-2 h-4 w-4"})]),cell:({row:a})=>ne(a.getValue("created_at"))},{id:"actions",enableHiding:!1,cell:({row:a})=>{const t=a.original;return u(P,{user:t,onDelete:()=>re(t)})}}],S=be({get data(){return h.users.data},columns:G,getCoreRowModel:Ae(),getSortedRowModel:Re(),getFilteredRowModel:Ue(),onSortingChange:a=>j(a,d),onColumnFiltersChange:a=>j(a,g),onColumnVisibilityChange:a=>j(a,m),onRowSelectionChange:a=>j(a,f),state:{get sorting(){return d.value},get columnFilters(){return g.value},get columnVisibility(){return m.value},get rowSelection(){return f.value}},manualSorting:!0,enableRowSelection:!0});Z(d,a=>{a.length>0&&R.get(D.index.url(),{search:w.value||void 0,sort_by:a[0].id,sort_order:a[0].desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},{deep:!0});let K;return Z(w,()=>{clearTimeout(K),K=setTimeout(()=>{R.get(D.index.url(),{search:w.value||void 0,sort_by:d.value[0]?.id||"created_at",sort_order:d.value[0]?.desc?"desc":"asc"},{preserveState:!0,preserveScroll:!0})},300)}),(a,t)=>(o(),b(V,null,[s(e(c),null,{default:l(({user:n,onDelete:p})=>[s(e(q),null,{default:l(()=>[s(e(Q),{"as-child":""},{default:l(()=>[s(e(y),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[t[4]||(t[4]=i("span",{class:"sr-only"},"Open menu",-1)),s(e(ke),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(X),{align:"end"},{default:l(()=>[s(e(fe),null,{default:l(()=>[...t[5]||(t[5]=[v("Actions",-1)])]),_:1}),s(e(E),{onClick:Ze=>e(z)([n])},{default:l(()=>[s(e(J),{class:"mr-2 h-4 w-4"}),t[6]||(t[6]=v(" Copy user data ",-1))]),_:1},8,["onClick"]),s(e(ve)),s(e(E),{"as-child":""},{default:l(()=>[s(e(W),{href:e(D).edit.url(n.id)},{default:l(()=>[s(e(we),{class:"mr-2 h-4 w-4"}),t[7]||(t[7]=v(" Edit user ",-1))]),_:1},8,["href"])]),_:2},1024),s(e(E),{onClick:p,class:"text-destructive"},{default:l(()=>[s(e(ee),{class:"mr-2 h-4 w-4"}),t[8]||(t[8]=v(" Delete user ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1}),s(pe,{breadcrumbs:L},{default:l(()=>[s(e(Ce),{title:"User Management"}),i("div",Fe,[i("div",Ee,[t[10]||(t[10]=i("div",null,[i("h1",{class:"text-3xl font-bold tracking-tight"},"Users"),i("p",{class:"text-muted-foreground"}," Manage user accounts and permissions ")],-1)),i("div",He,[s(e(W),{href:e(D).create.url()},{default:l(()=>[s(e(y),null,{default:l(()=>[s(e(xe),{class:"h-4 w-4"}),t[9]||(t[9]=v(" Add User ",-1))]),_:1})]),_:1},8,["href"])])]),x.value>0?(o(),b("div",Ne,[i("p",Le,M(x.value)+" user(s) selected ",1),i("div",ze,[s(e(y),{variant:"outline",size:"sm",onClick:de},{default:l(()=>[s(e(J),{class:"h-4 w-4"}),t[11]||(t[11]=v(" Copy Data ",-1))]),_:1}),s(e(y),{variant:"destructive",size:"sm",onClick:ie},{default:l(()=>[s(e(ee),{class:"h-4 w-4"}),t[12]||(t[12]=v(" Delete Selected ",-1))]),_:1})])])):I("",!0),i("div",Ge,[i("div",Ke,[s(e(Se),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s(e(Be),{modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=n=>w.value=n),placeholder:"Filter emails...",class:"pl-9"},null,8,["modelValue"])]),s(e(q),null,{default:l(()=>[s(e(Q),{"as-child":""},{default:l(()=>[s(e(y),{variant:"outline",class:"ml-auto"},{default:l(()=>[t[13]||(t[13]=v(" Columns ",-1)),s(e(De),{class:"ml-2 h-4 w-4"})]),_:1})]),_:1}),s(e(X),{align:"end"},{default:l(()=>[(o(!0),b(V,null,U(e(S).getAllColumns().filter(n=>n.getCanHide()),n=>(o(),k(e(_e),{key:n.id,class:"capitalize","model-value":n.getIsVisible(),"onUpdate:modelValue":p=>{n.toggleVisibility(!!p)}},{default:l(()=>[v(M(n.id),1)]),_:2},1032,["model-value","onUpdate:modelValue"]))),128))]),_:1})]),_:1})]),i("div",Oe,[s(e(Te),null,{default:l(()=>[s(e(je),null,{default:l(()=>[(o(!0),b(V,null,U(e(S).getHeaderGroups(),n=>(o(),k(e(N),{key:n.id},{default:l(()=>[(o(!0),b(V,null,U(n.headers,p=>(o(),k(e(Ie),{key:p.id},{default:l(()=>[p.isPlaceholder?I("",!0):(o(),k(e(ae),{key:0,render:p.column.columnDef.header,props:p.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),s(e(Me),null,{default:l(()=>[e(S).getRowModel().rows?.length?(o(!0),b(V,{key:0},U(e(S).getRowModel().rows,n=>(o(),k(e(N),{key:n.id,"data-state":n.getIsSelected()?"selected":void 0},{default:l(()=>[(o(!0),b(V,null,U(n.getVisibleCells(),p=>(o(),k(e(te),{key:p.id},{default:l(()=>[s(e(ae),{render:p.column.columnDef.cell,props:p.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(o(),k(e(N),{key:1},{default:l(()=>[s(e(te),{colspan:G.length,class:"h-24 text-center"},{default:l(()=>[...t[14]||(t[14]=[v(" No users found. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})]),i("div",qe,[i("div",Qe,[x.value>0?(o(),b("span",Xe,M(e(S).getFilteredSelectedRowModel().rows.length)+" dari "+M(e(S).getFilteredRowModel().rows.length)+" baris dipilih. ",1)):I("",!0)]),i("div",Ye,[r.users.last_page>1?(o(),k(me,{key:0,data:{current_page:r.users.current_page,last_page:r.users.last_page,per_page:r.users.per_page,from:(r.users.current_page-1)*r.users.per_page+1,to:Math.min(r.users.current_page*r.users.per_page,r.users.total),total:r.users.total},url:e(D).index.url(),filters:{search:w.value||void 0,sort_by:d.value[0]?.id||"created_at",sort_order:d.value[0]?.desc?"desc":"asc"}},null,8,["data","url","filters"])):I("",!0)])])]),s(F,{open:C.value.open,"onUpdate:open":t[1]||(t[1]=n=>C.value.open=n),title:"Hapus Pengguna?",description:`Apakah Anda yakin ingin menghapus pengguna ${C.value.user?.name}? Tindakan ini tidak dapat dibatalkan.`,"confirm-text":"Hapus","cancel-text":"Batal",variant:"destructive",onConfirm:oe},null,8,["open","description"]),s(F,{open:A.value.open,"onUpdate:open":t[2]||(t[2]=n=>A.value.open=n),title:`Hapus ${x.value} Pengguna?`,description:`Apakah Anda yakin ingin menghapus ${x.value} pengguna yang dipilih? Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data pengguna tersebut.`,"confirm-text":"Hapus Semua","cancel-text":"Batal",variant:"destructive",onConfirm:ue},null,8,["open","title","description"]),s(F,{open:B.value.open,"onUpdate:open":t[3]||(t[3]=n=>B.value.open=n),title:"Salin Data Pengguna?",description:`Data dari ${x.value} pengguna yang dipilih akan disalin ke clipboard dalam format tab-separated. Anda dapat mem-paste data ini ke spreadsheet seperti Excel atau Google Sheets.`,"confirm-text":"Salin ke Clipboard","cancel-text":"Batal",onConfirm:ce},null,8,["open","description"])]),_:1})],64))}});export{_a as default};
